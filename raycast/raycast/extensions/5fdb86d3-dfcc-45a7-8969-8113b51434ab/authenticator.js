"use strict";var gc=Object.create;var rr=Object.defineProperty;var yc=Object.getOwnPropertyDescriptor;var bc=Object.getOwnPropertyNames;var wc=Object.getPrototypeOf,Ec=Object.prototype.hasOwnProperty;var F=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Sc=(t,e)=>{for(var r in e)rr(t,r,{get:e[r],enumerable:!0})},qn=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of bc(e))!Ec.call(t,o)&&o!==r&&rr(t,o,{get:()=>e[o],enumerable:!(n=yc(e,o))||n.enumerable});return t};var Z=(t,e,r)=>(r=t!=null?gc(wc(t)):{},qn(e||!t||!t.__esModule?rr(r,"default",{value:t,enumerable:!0}):r,t)),xc=t=>qn(rr({},"__esModule",{value:!0}),t);var go=F((md,mo)=>{mo.exports=po;po.sync=Zc;var fo=require("fs");function Kc(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&t.substr(-o.length).toLowerCase()===o)return!0}return!1}function ho(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:Kc(e,r)}function po(t,e,r){fo.stat(t,function(n,o){r(n,n?!1:ho(o,t,e))})}function Zc(t,e){return ho(fo.statSync(t),t,e)}});var So=F((gd,Eo)=>{Eo.exports=bo;bo.sync=Xc;var yo=require("fs");function bo(t,e,r){yo.stat(t,function(n,o){r(n,n?!1:wo(o,e))})}function Xc(t,e){return wo(yo.statSync(t),e)}function wo(t,e){return t.isFile()&&Yc(t,e)}function Yc(t,e){var r=t.mode,n=t.uid,o=t.gid,s=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),l=parseInt("001",8),d=a|c,y=r&l||r&c&&o===i||r&a&&n===s||r&d&&s===0;return y}});var vo=F((bd,xo)=>{var yd=require("fs"),cr;process.platform==="win32"||global.TESTING_WINDOWS?cr=go():cr=So();xo.exports=Wr;Wr.sync=qc;function Wr(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,o){Wr(t,e||{},function(s,i){s?o(s):n(i)})})}cr(t,e||{},function(n,o){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,o=!1),r(n,o)})}function qc(t,e){try{return cr.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var Lo=F((wd,ko)=>{var yt=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Io=require("path"),Jc=yt?";":":",To=vo(),Ao=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),Co=(t,e)=>{let r=e.colon||Jc,n=t.match(/\//)||yt&&t.match(/\\/)?[""]:[...yt?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],o=yt?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=yt?o.split(r):[""];return yt&&t.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:n,pathExt:s,pathExtExe:o}},Po=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:o,pathExtExe:s}=Co(t,e),i=[],a=l=>new Promise((d,y)=>{if(l===n.length)return e.all&&i.length?d(i):y(Ao(t));let x=n[l],v=/^".*"$/.test(x)?x.slice(1,-1):x,I=Io.join(v,t),A=!v&&/^\.[\\\/]/.test(t)?t.slice(0,2)+I:I;d(c(A,l,0))}),c=(l,d,y)=>new Promise((x,v)=>{if(y===o.length)return x(a(d+1));let I=o[y];To(l+I,{pathExt:s},(A,b)=>{if(!A&&b)if(e.all)i.push(l+I);else return x(l+I);return x(c(l,d,y+1))})});return r?a(0).then(l=>r(null,l),r):a(0)},Qc=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:o}=Co(t,e),s=[];for(let i=0;i<r.length;i++){let a=r[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,l=Io.join(c,t),d=!c&&/^\.[\\\/]/.test(t)?t.slice(0,2)+l:l;for(let y=0;y<n.length;y++){let x=d+n[y];try{if(To.sync(x,{pathExt:o}))if(e.all)s.push(x);else return x}catch{}}}if(e.all&&s.length)return s;if(e.nothrow)return null;throw Ao(t)};ko.exports=Po;Po.sync=Qc});var $o=F((Ed,jr)=>{"use strict";var Ro=(t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};jr.exports=Ro;jr.exports.default=Ro});var Do=F((Sd,No)=>{"use strict";var Oo=require("path"),el=Lo(),tl=$o();function _o(t,e){let r=t.options.env||process.env,n=process.cwd(),o=t.options.cwd!=null,s=o&&process.chdir!==void 0&&!process.chdir.disabled;if(s)try{process.chdir(t.options.cwd)}catch{}let i;try{i=el.sync(t.command,{path:r[tl({env:r})],pathExt:e?Oo.delimiter:void 0})}catch{}finally{s&&process.chdir(n)}return i&&(i=Oo.resolve(o?t.options.cwd:"",i)),i}function rl(t){return _o(t)||_o(t,!0)}No.exports=rl});var Uo=F((xd,Zr)=>{"use strict";var Kr=/([()\][%!^"`<>&|;, *?])/g;function nl(t){return t=t.replace(Kr,"^$1"),t}function ol(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(Kr,"^$1"),e&&(t=t.replace(Kr,"^$1")),t}Zr.exports.command=nl;Zr.exports.argument=ol});var Vo=F((vd,Fo)=>{"use strict";Fo.exports=/^#!(.*)/});var Bo=F((Id,Mo)=>{"use strict";var sl=Vo();Mo.exports=(t="")=>{let e=t.match(sl);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),o=r.split("/").pop();return o==="env"?n:n?`${o} ${n}`:o}});var Go=F((Td,zo)=>{"use strict";var Xr=require("fs"),il=Bo();function al(t){let r=Buffer.alloc(150),n;try{n=Xr.openSync(t,"r"),Xr.readSync(n,r,0,150,0),Xr.closeSync(n)}catch{}return il(r.toString())}zo.exports=al});var Ko=F((Ad,jo)=>{"use strict";var cl=require("path"),Ho=Do(),Wo=Uo(),ll=Go(),ul=process.platform==="win32",fl=/\.(?:com|exe)$/i,dl=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function hl(t){t.file=Ho(t);let e=t.file&&ll(t.file);return e?(t.args.unshift(t.file),t.command=e,Ho(t)):t.file}function pl(t){if(!ul)return t;let e=hl(t),r=!fl.test(e);if(t.options.forceShell||r){let n=dl.test(e);t.command=cl.normalize(t.command),t.command=Wo.command(t.command),t.args=t.args.map(s=>Wo.argument(s,n));let o=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${o}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function ml(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:pl(n)}jo.exports=ml});var Yo=F((Cd,Xo)=>{"use strict";var Yr=process.platform==="win32";function qr(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function gl(t,e){if(!Yr)return;let r=t.emit;t.emit=function(n,o){if(n==="exit"){let s=Zo(o,e);if(s)return r.call(t,"error",s)}return r.apply(t,arguments)}}function Zo(t,e){return Yr&&t===1&&!e.file?qr(e.original,"spawn"):null}function yl(t,e){return Yr&&t===1&&!e.file?qr(e.original,"spawnSync"):null}Xo.exports={hookChildProcess:gl,verifyENOENT:Zo,verifyENOENTSync:yl,notFoundError:qr}});var Qo=F((Pd,bt)=>{"use strict";var qo=require("child_process"),Jr=Ko(),Qr=Yo();function Jo(t,e,r){let n=Jr(t,e,r),o=qo.spawn(n.command,n.args,n.options);return Qr.hookChildProcess(o,n),o}function bl(t,e,r){let n=Jr(t,e,r),o=qo.spawnSync(n.command,n.args,n.options);return o.error=o.error||Qr.verifyENOENTSync(o.status,n),o}bt.exports=Jo;bt.exports.spawn=Jo;bt.exports.sync=bl;bt.exports._parse=Jr;bt.exports._enoent=Qr});var ds=F((Kd,dr)=>{dr.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&dr.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&dr.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var ys=F((Zd,xt)=>{var G=global.process,rt=function(t){return t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function"};rt(G)?(hs=require("assert"),Et=ds(),ps=/^win/i.test(G.platform),Dt=require("events"),typeof Dt!="function"&&(Dt=Dt.EventEmitter),G.__signal_exit_emitter__?J=G.__signal_exit_emitter__:(J=G.__signal_exit_emitter__=new Dt,J.count=0,J.emitted={}),J.infinite||(J.setMaxListeners(1/0),J.infinite=!0),xt.exports=function(t,e){if(!rt(global.process))return function(){};hs.equal(typeof t,"function","a callback must be provided for exit handler"),St===!1&&on();var r="exit";e&&e.alwaysLast&&(r="afterexit");var n=function(){J.removeListener(r,t),J.listeners("exit").length===0&&J.listeners("afterexit").length===0&&hr()};return J.on(r,t),n},hr=function(){!St||!rt(global.process)||(St=!1,Et.forEach(function(e){try{G.removeListener(e,pr[e])}catch{}}),G.emit=mr,G.reallyExit=sn,J.count-=1)},xt.exports.unload=hr,nt=function(e,r,n){J.emitted[e]||(J.emitted[e]=!0,J.emit(e,r,n))},pr={},Et.forEach(function(t){pr[t]=function(){if(rt(global.process)){var r=G.listeners(t);r.length===J.count&&(hr(),nt("exit",null,t),nt("afterexit",null,t),ps&&t==="SIGHUP"&&(t="SIGINT"),G.kill(G.pid,t))}}}),xt.exports.signals=function(){return Et},St=!1,on=function(){St||!rt(global.process)||(St=!0,J.count+=1,Et=Et.filter(function(e){try{return G.on(e,pr[e]),!0}catch{return!1}}),G.emit=gs,G.reallyExit=ms)},xt.exports.load=on,sn=G.reallyExit,ms=function(e){rt(global.process)&&(G.exitCode=e||0,nt("exit",G.exitCode,null),nt("afterexit",G.exitCode,null),sn.call(G,G.exitCode))},mr=G.emit,gs=function(e,r){if(e==="exit"&&rt(global.process)){r!==void 0&&(G.exitCode=r);var n=mr.apply(this,arguments);return nt("exit",G.exitCode,null),nt("afterexit",G.exitCode,null),n}else return mr.apply(this,arguments)}):xt.exports=function(){return function(){}};var hs,Et,ps,Dt,J,hr,nt,pr,St,on,sn,ms,mr,gs});var Cs=F((qd,As)=>{"use strict";var{PassThrough:zl}=require("stream");As.exports=t=>{t={...t};let{array:e}=t,{encoding:r}=t,n=r==="buffer",o=!1;e?o=!(r||n):r=r||"utf8",n&&(r=null);let s=new zl({objectMode:o});r&&s.setEncoding(r);let i=0,a=[];return s.on("data",c=>{a.push(c),o?i=a.length:i+=c.length}),s.getBufferedValue=()=>e?a:n?Buffer.concat(a,i):a.join(""),s.getBufferedLength=()=>i,s}});var Ps=F((Jd,Ut)=>{"use strict";var{constants:Gl}=require("buffer"),Hl=require("stream"),{promisify:Wl}=require("util"),jl=Cs(),Kl=Wl(Hl.pipeline),gr=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function an(t,e){if(!t)throw new Error("Expected a stream");e={maxBuffer:1/0,...e};let{maxBuffer:r}=e,n=jl(e);return await new Promise((o,s)=>{let i=a=>{a&&n.getBufferedLength()<=Gl.MAX_LENGTH&&(a.bufferedData=n.getBufferedValue()),s(a)};(async()=>{try{await Kl(t,n),o()}catch(a){i(a)}})(),n.on("data",()=>{n.getBufferedLength()>r&&i(new gr)})}),n.getBufferedValue()}Ut.exports=an;Ut.exports.buffer=(t,e)=>an(t,{...e,encoding:"buffer"});Ut.exports.array=(t,e)=>an(t,{...e,array:!0});Ut.exports.MaxBufferError=gr});var Ls=F((Qd,ks)=>{"use strict";var{PassThrough:Zl}=require("stream");ks.exports=function(){var t=[],e=new Zl({objectMode:!0});return e.setMaxListeners(0),e.add=r,e.isEmpty=n,e.on("unpipe",o),Array.prototype.slice.call(arguments).forEach(r),e;function r(s){return Array.isArray(s)?(s.forEach(r),this):(t.push(s),s.once("end",o.bind(null,s)),s.once("error",e.emit.bind(e,"error")),s.pipe(e,{end:!1}),this)}function n(){return t.length==0}function o(s){t=t.filter(function(i){return i!==s}),!t.length&&e.readable&&e.end()}}});var ri=F(($h,ti)=>{var fe=require("fs"),iu=require("util"),It=require("path"),xn=require("events"),qs=require("zlib"),ei=require("stream"),p={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSIGFIRST:80,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,MAXFILECOMMENT:65535,ENDL64HDR:20,ENDL64SIG:117853008,ENDL64SIGFIRST:80,ENDL64OFS:8,END64HDR:56,END64SIG:101075792,END64SIGFIRST:80,END64SUB:24,END64TOT:32,END64SIZ:40,END64OFF:48,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FLG_ENTRY_ENC:1,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535},Me=function(t){let e,r,n,o,s,i,c=this,l=t.storeEntries!==!1?{}:null,d=t.file,y=t.nameEncoding?new TextDecoder(t.nameEncoding):null;x();function x(){t.fd?(e=t.fd,v()):fe.open(d,"r",(f,m)=>{if(f)return c.emit("error",f);e=m,v()})}function v(){fe.fstat(e,(f,m)=>{if(f)return c.emit("error",f);r=m.size,n=t.chunkSize||Math.round(r/1e3),n=Math.max(Math.min(n,Math.min(128*1024,r)),Math.min(1024,r)),A()})}function I(f,m){if(f||!m)return c.emit("error",f||new Error("Archive read error"));let h=o.lastPos,g=h-o.win.position,$=o.win.buffer,C=o.minPos;for(;--h>=C&&--g>=0;)if($.length-g>=4&&$[g]===o.firstByte&&$.readUInt32LE(g)===o.sig){o.lastBufferPosition=g,o.lastBytesRead=m,o.complete();return}if(h===C)return c.emit("error",new Error("Bad archive"));if(o.lastPos=h+1,o.chunkSize*=2,h<=C)return c.emit("error",new Error("Bad archive"));let z=Math.min(o.chunkSize,h-C);o.win.expandLeft(z,I)}function A(){let f=Math.min(p.ENDHDR+p.MAXFILECOMMENT,r);o={win:new xr(e),totalReadLength:f,minPos:r-f,lastPos:r,chunkSize:Math.min(1024,n),firstByte:p.ENDSIGFIRST,sig:p.ENDSIG,complete:b},o.win.read(r-o.chunkSize,o.chunkSize,I)}function b(){let f=o.win.buffer,m=o.lastBufferPosition;try{s=new gn,s.read(f.slice(m,m+p.ENDHDR)),s.headerOffset=o.win.position+m,s.commentLength?c.comment=f.slice(m+p.ENDHDR,m+p.ENDHDR+s.commentLength).toString():c.comment=null,c.entriesCount=s.volumeEntries,c.centralDirectory=s,s.volumeEntries===p.EF_ZIP64_OR_16&&s.totalEntries===p.EF_ZIP64_OR_16||s.size===p.EF_ZIP64_OR_32||s.offset===p.EF_ZIP64_OR_32?E():(o={},U())}catch(h){c.emit("error",h)}}function E(){let f=p.ENDL64HDR;o.lastBufferPosition>f?(o.lastBufferPosition-=f,P()):(o={win:o.win,totalReadLength:f,minPos:o.win.position-f,lastPos:o.win.position,chunkSize:o.chunkSize,firstByte:p.ENDL64SIGFIRST,sig:p.ENDL64SIG,complete:P},o.win.read(o.lastPos-o.chunkSize,o.chunkSize,I))}function P(){let f=o.win.buffer,m=new yn;m.read(f.slice(o.lastBufferPosition,o.lastBufferPosition+p.ENDL64HDR));let h=r-m.headerOffset;o={win:o.win,totalReadLength:h,minPos:m.headerOffset,lastPos:o.lastPos,chunkSize:o.chunkSize,firstByte:p.END64SIGFIRST,sig:p.END64SIG,complete:R},o.win.read(r-o.chunkSize,o.chunkSize,I)}function R(){let f=o.win.buffer,m=new bn;m.read(f.slice(o.lastBufferPosition,o.lastBufferPosition+p.END64HDR)),c.centralDirectory.volumeEntries=m.volumeEntries,c.centralDirectory.totalEntries=m.totalEntries,c.centralDirectory.size=m.size,c.centralDirectory.offset=m.offset,c.entriesCount=m.volumeEntries,o={},U()}function U(){o={win:new xr(e),pos:s.offset,chunkSize:n,entriesLeft:s.volumeEntries},o.win.read(o.pos,Math.min(n,r-o.pos),D)}function D(f,m){if(f||!m)return c.emit("error",f||new Error("Entries read error"));let h=o.pos-o.win.position,g=o.entry,$=o.win.buffer,C=$.length;try{for(;o.entriesLeft>0;){g||(g=new wn,g.readHeader($,h),g.headerOffset=o.win.position+h,o.entry=g,o.pos+=p.CENHDR,h+=p.CENHDR);let z=g.fnameLen+g.extraLen+g.comLen,W=z+(o.entriesLeft>1?p.CENHDR:0);if(C-h<W){o.win.moveRight(n,D,h),o.move=!0;return}g.read($,h,y),t.skipEntryNameValidation||g.validateName(),l&&(l[g.name]=g),c.emit("entry",g),o.entry=g=null,o.entriesLeft--,o.pos+=z,h+=z}c.emit("ready")}catch(z){c.emit("error",z)}}function H(){if(!l)throw new Error("storeEntries disabled")}Object.defineProperty(this,"ready",{get(){return!1}}),this.entry=function(f){return H(),l[f]},this.entries=function(){return H(),l},this.stream=function(f,m){return this.openEntry(f,(h,g)=>{if(h)return m(h);let $=pe(g),C=new En(e,$,g.compressedSize);if(g.method!==p.STORED)if(g.method===p.DEFLATED)C=C.pipe(qs.createInflateRaw());else return m(new Error("Unknown compression method: "+g.method));Re(g)&&(C=C.pipe(new Sn(C,g.crc,g.size))),m(null,C)},!1)},this.entryDataSync=function(f){let m=null;if(this.openEntry(f,(g,$)=>{m=g,f=$},!0),m)throw m;let h=Buffer.alloc(f.compressedSize);if(new Fe(e,h,0,f.compressedSize,pe(f),g=>{m=g}).read(!0),m)throw m;if(f.method!==p.STORED)if(f.method===p.DEFLATED||f.method===p.ENHANCED_DEFLATED)h=qs.inflateRawSync(h);else throw new Error("Unknown compression method: "+f.method);if(h.length!==f.size)throw new Error("Invalid size");return Re(f)&&new vr(f.crc,f.size).data(h),h},this.openEntry=function(f,m,h){if(typeof f=="string"&&(H(),f=l[f],!f))return m(new Error("Entry not found"));if(!f.isFile)return m(new Error("Entry is not file"));if(!e)return m(new Error("Archive closed"));let g=Buffer.alloc(p.LOCHDR);new Fe(e,g,0,g.length,f.offset,$=>{if($)return m($);let C;try{f.readDataHeader(g),f.encrypted&&(C=new Error("Entry encrypted"))}catch(z){C=z}m(C,f)}).read(h)};function pe(f){return f.offset+p.LOCHDR+f.fnameLen+f.extraLen}function Re(f){return(f.flags&8)!==8}function $e(f,m,h){c.stream(f,(g,$)=>{if(g)h(g);else{let C,z;$.on("error",W=>{z=W,C&&($.unpipe(C),C.close(()=>{h(W)}))}),fe.open(m,"w",(W,ie)=>{if(W)return h(W);if(z){fe.close(e,()=>{h(z)});return}C=fe.createWriteStream(m,{fd:ie}),C.on("finish",()=>{c.emit("extract",f,m),z||h()}),$.pipe(C)})}})}function Ze(f,m,h){if(!m.length)return h();let g=m.shift();g=It.join(f,It.join(...g)),fe.mkdir(g,{recursive:!0},$=>{if($&&$.code!=="EEXIST")return h($);Ze(f,m,h)})}function re(f,m,h,g,$){if(!h.length)return g(null,$);let C=h.shift(),z=It.join(f,C.name.replace(m,""));$e(C,z,W=>{if(W)return g(W,$);re(f,m,h,g,$+1)})}this.extract=function(f,m,h){let g=f||"";if(typeof f=="string"&&(f=this.entry(f),f?g=f.name:g.length&&g[g.length-1]!=="/"&&(g+="/")),!f||f.isDirectory){let $=[],C=[],z={};for(let W in l)if(Object.prototype.hasOwnProperty.call(l,W)&&W.lastIndexOf(g,0)===0){let ie=W.replace(g,""),Oe=l[W];if(Oe.isFile&&($.push(Oe),ie=It.dirname(ie)),ie&&!z[ie]&&ie!=="."){z[ie]=!0;let u=ie.split("/").filter(w=>w);for(u.length&&C.push(u);u.length>1;){u=u.slice(0,u.length-1);let w=u.join("/");if(z[w]||w===".")break;z[w]=!0,C.push(u)}}}C.sort((W,ie)=>W.length-ie.length),C.length?Ze(m,C,W=>{W?h(W):re(m,g,$,h,0)}):re(m,g,$,h,0)}else fe.stat(m,($,C)=>{C&&C.isDirectory()?$e(f,It.join(m,It.basename(f.name)),h):$e(f,m,h)})},this.close=function(f){i||!e?(i=!0,f&&f()):(i=!0,fe.close(e,m=>{e=null,f&&f(m)}))};let q=xn.EventEmitter.prototype.emit;this.emit=function(...f){if(!i)return q.call(this,...f)}};Me.setFs=function(t){fe=t};Me.debugLog=(...t)=>{Me.debug&&console.log(...t)};iu.inherits(Me,xn.EventEmitter);var Ue=Symbol("zip");Me.async=class extends xn.EventEmitter{constructor(e){super();let r=new Me(e);r.on("entry",n=>this.emit("entry",n)),r.on("extract",(n,o)=>this.emit("extract",n,o)),this[Ue]=new Promise((n,o)=>{r.on("ready",()=>{r.removeListener("error",o),n(r)}),r.on("error",o)})}get entriesCount(){return this[Ue].then(e=>e.entriesCount)}get comment(){return this[Ue].then(e=>e.comment)}async entry(e){return(await this[Ue]).entry(e)}async entries(){return(await this[Ue]).entries()}async stream(e){let r=await this[Ue];return new Promise((n,o)=>{r.stream(e,(s,i)=>{s?o(s):n(i)})})}async entryData(e){let r=await this.stream(e);return new Promise((n,o)=>{let s=[];r.on("data",i=>s.push(i)),r.on("end",()=>{n(Buffer.concat(s))}),r.on("error",i=>{r.removeAllListeners("end"),o(i)})})}async extract(e,r){let n=await this[Ue];return new Promise((o,s)=>{n.extract(e,r,(i,a)=>{i?s(i):o(a)})})}async close(){let e=await this[Ue];return new Promise((r,n)=>{e.close(o=>{o?n(o):r()})})}};var gn=class{read(e){if(e.length!==p.ENDHDR||e.readUInt32LE(0)!==p.ENDSIG)throw new Error("Invalid central directory");this.volumeEntries=e.readUInt16LE(p.ENDSUB),this.totalEntries=e.readUInt16LE(p.ENDTOT),this.size=e.readUInt32LE(p.ENDSIZ),this.offset=e.readUInt32LE(p.ENDOFF),this.commentLength=e.readUInt16LE(p.ENDCOM)}},yn=class{read(e){if(e.length!==p.ENDL64HDR||e.readUInt32LE(0)!==p.ENDL64SIG)throw new Error("Invalid zip64 central directory locator");this.headerOffset=Ve(e,p.ENDSUB)}},bn=class{read(e){if(e.length!==p.END64HDR||e.readUInt32LE(0)!==p.END64SIG)throw new Error("Invalid central directory");this.volumeEntries=Ve(e,p.END64SUB),this.totalEntries=Ve(e,p.END64TOT),this.size=Ve(e,p.END64SIZ),this.offset=Ve(e,p.END64OFF)}},wn=class{readHeader(e,r){if(e.length<r+p.CENHDR||e.readUInt32LE(r)!==p.CENSIG)throw new Error("Invalid entry header");this.verMade=e.readUInt16LE(r+p.CENVEM),this.version=e.readUInt16LE(r+p.CENVER),this.flags=e.readUInt16LE(r+p.CENFLG),this.method=e.readUInt16LE(r+p.CENHOW);let n=e.readUInt16LE(r+p.CENTIM),o=e.readUInt16LE(r+p.CENTIM+2);this.time=Js(n,o),this.crc=e.readUInt32LE(r+p.CENCRC),this.compressedSize=e.readUInt32LE(r+p.CENSIZ),this.size=e.readUInt32LE(r+p.CENLEN),this.fnameLen=e.readUInt16LE(r+p.CENNAM),this.extraLen=e.readUInt16LE(r+p.CENEXT),this.comLen=e.readUInt16LE(r+p.CENCOM),this.diskStart=e.readUInt16LE(r+p.CENDSK),this.inattr=e.readUInt16LE(r+p.CENATT),this.attr=e.readUInt32LE(r+p.CENATX),this.offset=e.readUInt32LE(r+p.CENOFF)}readDataHeader(e){if(e.readUInt32LE(0)!==p.LOCSIG)throw new Error("Invalid local header");this.version=e.readUInt16LE(p.LOCVER),this.flags=e.readUInt16LE(p.LOCFLG),this.method=e.readUInt16LE(p.LOCHOW);let r=e.readUInt16LE(p.LOCTIM),n=e.readUInt16LE(p.LOCTIM+2);this.time=Js(r,n),this.crc=e.readUInt32LE(p.LOCCRC)||this.crc;let o=e.readUInt32LE(p.LOCSIZ);o&&o!==p.EF_ZIP64_OR_32&&(this.compressedSize=o);let s=e.readUInt32LE(p.LOCLEN);s&&s!==p.EF_ZIP64_OR_32&&(this.size=s),this.fnameLen=e.readUInt16LE(p.LOCNAM),this.extraLen=e.readUInt16LE(p.LOCEXT)}read(e,r,n){let o=e.slice(r,r+=this.fnameLen);this.name=n?n.decode(new Uint8Array(o)):o.toString("utf8");let s=e[r-1];this.isDirectory=s===47||s===92,this.extraLen&&(this.readExtra(e,r),r+=this.extraLen),this.comment=this.comLen?e.slice(r,r+this.comLen).toString():null}validateName(){if(/\\|^\w+:|^\/|(^|\/)\.\.(\/|$)/.test(this.name))throw new Error("Malicious entry: "+this.name)}readExtra(e,r){let n,o,s=r+this.extraLen;for(;r<s;)n=e.readUInt16LE(r),r+=2,o=e.readUInt16LE(r),r+=2,p.ID_ZIP64===n&&this.parseZip64Extra(e,r,o),r+=o}parseZip64Extra(e,r,n){n>=8&&this.size===p.EF_ZIP64_OR_32&&(this.size=Ve(e,r),r+=8,n-=8),n>=8&&this.compressedSize===p.EF_ZIP64_OR_32&&(this.compressedSize=Ve(e,r),r+=8,n-=8),n>=8&&this.offset===p.EF_ZIP64_OR_32&&(this.offset=Ve(e,r),r+=8,n-=8),n>=4&&this.diskStart===p.EF_ZIP64_OR_16&&(this.diskStart=e.readUInt32LE(r))}get encrypted(){return(this.flags&p.FLG_ENTRY_ENC)===p.FLG_ENTRY_ENC}get isFile(){return!this.isDirectory}},Fe=class{constructor(e,r,n,o,s,i){this.fd=e,this.buffer=r,this.offset=n,this.length=o,this.position=s,this.callback=i,this.bytesRead=0,this.waiting=!1}read(e){Me.debugLog("read",this.position,this.bytesRead,this.length,this.offset),this.waiting=!0;let r;if(e){let n=0;try{n=fe.readSync(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead)}catch(o){r=o}this.readCallback(e,r,r?n:null)}else fe.read(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead,this.readCallback.bind(this,e))}readCallback(e,r,n){if(typeof n=="number"&&(this.bytesRead+=n),r||!n||this.bytesRead===this.length)return this.waiting=!1,this.callback(r,this.bytesRead);this.read(e)}},xr=class{constructor(e){this.position=0,this.buffer=Buffer.alloc(0),this.fd=e,this.fsOp=null}checkOp(){if(this.fsOp&&this.fsOp.waiting)throw new Error("Operation in progress")}read(e,r,n){this.checkOp(),this.buffer.length<r&&(this.buffer=Buffer.alloc(r)),this.position=e,this.fsOp=new Fe(this.fd,this.buffer,0,r,this.position,n).read()}expandLeft(e,r){this.checkOp(),this.buffer=Buffer.concat([Buffer.alloc(e),this.buffer]),this.position-=e,this.position<0&&(this.position=0),this.fsOp=new Fe(this.fd,this.buffer,0,e,this.position,r).read()}expandRight(e,r){this.checkOp();let n=this.buffer.length;this.buffer=Buffer.concat([this.buffer,Buffer.alloc(e)]),this.fsOp=new Fe(this.fd,this.buffer,n,e,this.position+n,r).read()}moveRight(e,r,n){this.checkOp(),n?this.buffer.copy(this.buffer,0,n):n=0,this.position+=n,this.fsOp=new Fe(this.fd,this.buffer,this.buffer.length-n,n,this.position+this.buffer.length-n,r).read()}},En=class extends ei.Readable{constructor(e,r,n){super(),this.fd=e,this.offset=r,this.length=n,this.pos=0,this.readCallback=this.readCallback.bind(this)}_read(e){let r=Buffer.alloc(Math.min(e,this.length-this.pos));r.length?fe.read(this.fd,r,0,r.length,this.offset+this.pos,this.readCallback):this.push(null)}readCallback(e,r,n){this.pos+=r,e?(this.emit("error",e),this.push(null)):r?(r!==n.length&&(n=n.slice(0,r)),this.push(n)):this.push(null)}},Sn=class extends ei.Transform{constructor(e,r,n){super(),this.verify=new vr(r,n),e.on("error",o=>{this.emit("error",o)})}_transform(e,r,n){let o;try{this.verify.data(e)}catch(s){o=s}n(o,e)}},vr=class t{constructor(e,r){this.crc=e,this.size=r,this.state={crc:-1,size:0}}data(e){let r=t.getCrcTable(),n=this.state.crc,o=0,s=e.length;for(;--s>=0;)n=r[(n^e[o++])&255]^n>>>8;if(this.state.crc=n,this.state.size+=e.length,this.state.size>=this.size){let i=Buffer.alloc(4);if(i.writeInt32LE(~this.state.crc&4294967295,0),n=i.readUInt32LE(0),n!==this.crc)throw new Error("Invalid CRC");if(this.state.size!==this.size)throw new Error("Invalid size")}}static getCrcTable(){let e=t.crcTable;if(!e){t.crcTable=e=[];let r=Buffer.alloc(4);for(let n=0;n<256;n++){let o=n;for(let s=8;--s>=0;)(o&1)!==0?o=3988292384^o>>>1:o=o>>>1;o<0&&(r.writeInt32LE(o,0),o=r.readUInt32LE(0)),e[n]=o}}return e}};function Js(t,e){let r=Qs(t,16),n=Qs(e,16),o={h:parseInt(r.slice(0,5).join(""),2),m:parseInt(r.slice(5,11).join(""),2),s:parseInt(r.slice(11,16).join(""),2)*2,Y:parseInt(n.slice(0,7).join(""),2)+1980,M:parseInt(n.slice(7,11).join(""),2),D:parseInt(n.slice(11,16).join(""),2)},s=[o.Y,o.M,o.D].join("-")+" "+[o.h,o.m,o.s].join(":")+" GMT+0";return new Date(s).getTime()}function Qs(t,e){let r=(t>>>0).toString(2);for(;r.length<e;)r="0"+r;return r.split("")}function Ve(t,e){return t.readUInt32LE(e+4)*4294967296+t.readUInt32LE(e)}ti.exports=Me});var ba=F((Ug,ya)=>{ya.exports={Other:0,CR:1,LF:2,Control:4,Extend:8,ZWJ:16,Regional_Indicator:32,Prepend:64,SpacingMark:128,L:256,V:512,T:1024,LV:2048,LVT:4096,Extended_Pictographic:8192,InCB_Linker:16384,InCB_Consonant:32768,InCB_Extend:65536}});var wa=F((Fg,Ku)=>{Ku.exports={data:"ABAOAAAAAADQjQAAAd4HIfjtnG2oFUUYxx/1nHu29OolvKRSZIIQghSSEFJwwj4YWdzoFcoQyriBHwz8YHDBiSKDLG9YKSEiUX4IFQ0FCaRLoFmUb9mLBqJ+EDOIsAgpjf7b7nCnOTO7M7szu8frPPBjZufleZ6ZeWZm73pwYALRk2ApGAQMvC6UlU2HwUbwDthk0P5DsC2jfifYC0bAQXAE/AhOgXNCu1/A7+ASoAZRD5gMekE/mAFmge1gN9jbSPrOSdPPkM4DX4AvwVFwApwBZ8EFcBH8Bf4GE5pEUXP0uQ/5ac2k/UyktzWT/ncgPYj0rmZip91M6hc1R/U/hPzj4BnwPBgECwT7cb8VKFsZJflVyK9O9cW8gvwb6fM6pO+l+c1It4Lt4Hah/R7k94H94BuhPGZDNMqWlK1gf4rYNovthu1c8x3G8xOYmhKXnUH6c5pf0/h/+8Uo/1Wagz+bev1X0rpGD9GkniS/FjRTvVNRdiO4BcwGc8H8tN3dabqwp1Pv/Sh7WFHOGU4pOz9vws/1qa+PCuXxGHZmjDtQAdL6n1DEgAs7NwnrvCQj5gKBQCAQCAQCgUAgEOgGnsPfrlOE7zlvG3y/WI4+K4W/eYciotVgCGWv8u85SNeDjVHyPXAj8tORbknrtyLdAT5Jnz9Fehnp5zl/S3+F+kPQeRgcAUfBMfAtOB6FulAX6kJdqHNdtwPsAQei+u+sQCAwdjnk+d9TNk0Y/Xd1mUFFmfh+vKHhxycbRnoTaDLR0t582mg3oGg7LJWN4JmmoD1YNSUp24b0NJjWR3QnGAT3TcT7Pzh7HdGt1xNF4xKeFvIiu9D25ER1nczqVMeMSUS7kX8M6bvgMKBeMx2BQCAQGJv8gXuhEd8nLaJ/cB+2cCdPaiW/E2ojvyi9oyOkN6B8Df5mmZbW34x0QLjDZ7eS707i/Rr/ZmRua/R3ZPORv6eV1C2MU/R/MP1O9gCeH2mN9n0K+Wdb+rt7EHUrhPpVreS7GH9mQt1ryL+VoWt9Rl3MEuhdJr2vvI8+H4CPwQuo25XqeLHAe81ewf4I8gckf77G80up3uM5voqcRNuX0e800vMW/XwyBH7rEl9EZiC2n6jQ3masyxzY/EHxnXjeVfptIP797rAAkxjO4KNGZ/trjTJz/33O33rTpXPpVBf+1u4cfLqg8Wuxo9+Dnk/1XzQc/6W03RWhrD+dSzI4x+K/eS914Xnnisvp2MY7OrP2ldAToe86MFnQ0X+VnqU2xOfnrCh5f3Oha0GUpPciXQQGrqY5hK9LBX+nK/aebaweS8+AZSXnIa9/v4MzTh7b2jH6O/rlJdfiZBeMoUFmjBfy4wz7mBCkPgnz7y6Oq4x/l+sWXeO4lKrsdJvUvYZF111MdfmxLm0NpmI7591853Tj+VJVDGaNoZ3TRtahautDRL/qkm6KlW6Wa2EeXI3N5Ry0SX+e26xJ27K9K5iijNJyjvwsnllZ4mKeZbuy72I5F5VvNr6o+hcVbredoVc3/y7vN/keke0ywS6T6tqOfOE2mQKS8rJ/3A8mpHWfZVl7qq0oV0lbQ9m9bOszt+lb5LWsU8TxN8j9+LnOPnL3Pc73tz4X31fy7mVdDObZcnHfdev3VNV86ebRtF1VUsSui7U0OQ/rEvE8Jsp+j1H5Lbfnecrpa+Nf1XEi2mZUz/qIe4b7oJtDXi8/m85bN69HJOXr2i9Z+0PVVuW36n5x6V8Z/Yw640s+t5nQlpGfOPAdX2XPI5d+iP6wDJ8YFdvfRc/bOkR31jKpXHx2eb7J91kd7yaMOseb9w6Vp7PO9YyFUWeMM6pvfC7mhBXoI78z1SnyfDPLvqoyRp1nmNieZeAqRlUxV+Ssz3vvdSWm/paJ87ruuipsyTGmssfI3X4zWSMVTFNOlD1PNjbK+OeKsmI6b/J4mdTWp+TZ8jkfRXXEwgz0lPXZx9z7PruqOhdNYlqMZR2qeHe1N33OQdYYVeWyiG3l/rKeKteS2/UhXDdP885CMaWcPqbzaBJTOt1ViqnPjOqJmSzxcbfWtQ6iMNLPv6tx5om8fxh1niUu/GA5mMalq3lQnQ+25PmtspnlDxdRrwupaw/7WCvb9VLpynrWlbkURp17zrcPjNT7rSopsr9cnX95+861PRN/bM8Y1/YZmd0//Fmnp0oxvRvk5yJ2TNqwArpdiY+Y4Kk8b1nzWGSOGZnFF29nK1ynHAuiraK6XUudPlRh2+ZM1d3xJnp9S9H3Op2OKu4Xn7qrfn9gVO+Za3oe6vrq7vWq3z24Py6Fkf59Qjd2VzZ0dnXC62x89iGi7xwuumebc8ZUZFum81BlvKoka+19+cLIPGZU7fizT3GlP29+xfEwKa864+oUk3OCkXp9maJtFeLaJqNisctTG9HFRh13XZaoxmd6T7sWRuZz5Ssus3zgIseI2F7WVbWYzFsVsWZzT5veHWVE1qWaj7w4cyWma6TyMW8cTJP37bvchqQ6Gx+YAlkfL/exPqIt0b5r4brz5lPVzqfo9GfZLRrTNmMx1cfIz5z5Pkd9ntfyvilCnv6y/tr2q+ouM/WhbPyX2UNFdPqSqs6pLLuucWXLZAw24/UlOt9dzqELn1z5Zrtv8uz6EF82ZlaEK2FU7vtpXcIsydJRhbCa+e8/D60bUcbXTMMzfRK24nKssvgYr+x71lh8iO/1tBl/LPGlIseAT6q2J8m/"}});var Ea=F((Vg,Zu)=>{Zu.exports={data:"AAACAAAAAACAOAAAAbYBSf7t2S1IBEEYBuDVDZ7FYrQMNsFiu3hgEYOI0SCXRIUrB8JhEZtgs5gEg1GMFk02m82oGI02m+9xezCOczv/uwv3fvAwc/PzfXOzcdqzWdaBDdiGPdiHdjE+DS3RNDuCfsn8idQ/g3OH3BdwKf0e96/gumTfYcncLdzBPTzAo+RZ+f0Cr/AG7/AJX4738x1wtz9FO5PX/50n6UXMNdfg/0lERERERERERERERETpdedHBvDRql4nq0cXtW9af98qdRby0Vvp8K4W0V+C5Xw0t4J2bfjeBp3cnEu1brnnCTYNa7eKdz91XP7WO9Lb4GqRb7cY6xbtAdqeVOsY/QGcevw/tb6OT85YhvfKYEx9CMuxKsKnrs+eJtVInVvHJ0eVYVvTZk2siFVLOCjb61PTZX3MdVWEyP7fjzpmMxdzTyq2Ebue6x61nXRGnzndWpf1an7dXmGYE4Y1ptqqKsK1nu26Ju0ty+maV2Rpvk+qnDZjKUIobUiesdAQE/jmCTmHmsskpFZsVYbtmXRcaoSGUPomunW2derQhDPFjtT1Q/eb8vnm990fq35oHVt11bU9m89c7DNI8Qs="}});var Sa=F((Mg,Xu)=>{Xu.exports={data:"AAgOAAAAAABQfgAAAWMGnPntmm2IVUUYx+dyb2ezXXtBiSCLsKDIiKIIoYINciGwQHrRL2Ufii0qMsv7QVBuQkXhkmW5gksQRhRFSBslbkllHyy3L2XllkXrB3uhF0tQ0Kj+xzN3d3buzJx5PeesOw/8mDNvz/PMnOc8s/fs6asTcgu4A9wF+mjdV9kEa8FqsE5j/DPgeUX/JvASeBW8Bd4GO8CHYDcz7nPwFRgD4+An8Cf4AxwBx0G9QcjrYBt4p5HN/YDqGEF9F7gW3AC6wU1gCVgK5oDlYA8YBXvBGOgHD4FzwSo6fg24EDwBxsEB8Cu1N4ByI1gA/gbfo+0wyuO0vgW8DK5i+tN5tVOyMmUWrs9k6nNxPY/WL0B5Mb2+HOU14HrwY2Ny/CLUbwa3gzsZPT7ZGECnDvdiPQ+ARyhpWxPlWnr9JLfeAdS/43S8qNiTIdq3FeUb9HolOEj7h9H2LtgJPgHr0TZKx31Jy30C/T+g7aDCbpPiuj/fStrTNfQGioWIHr9z+z8iiAEfdg4zdo7Gex6JRCKRSCQSiUQikYrzL367HmLq8zV+yyYJIbOTzva5aJtH2y9CuYBebwdX4PoYyv107ELUe5PsPWBavzHJ3tMtFuhluTWnPxKJRCKRSCQy/TjQCKt/XX3y/+o6HPJs35XNszPO0WQf+FnQfsnpU+vLUN8MdgNyRtZ2Ncp7wBDYDn4D47MIOes0QpaADeDUWsYe5pql3k3IZd3iPp4H6bjnUI6Cf8B1PYQ0wWCPno5IJBKJnJx83eN2fi7NeYd0jKsvr+A7p3749KzkXd2Ap+9R7qfrflhz/ava45m2I7Rcw+lI3/WtAO+Bx5PsG6+nk+xbv7Q/fWe4gc7ZRPu3oNzK6Hktmfy2r036vc82On44yb4ZHKFzPkL5aZJ9f9hH7Y8y+nbheq9irWOpf0z/L8nUWPmL6TuK6/8Uuhpd6r3sRv8cbszZXZm981HOB5fS/itzdIlYyMzpTa85HYtRv422LTPQ/yjd+/SZudvCr1DcV5Iv6W+HFRXaB988Rte2ugJrHKTPW4vx5akK+MWzvoI++Sb9zvKFriy/m8wbwpxXQL/gDNs5Tb+zTPfiza6sHEa5A3w8jWLgM/j6BePvoOBcM33+v6Hj9zvuQ978lR5ihl/bedM0DvN4vwI+NOvy7/SbCkze51WVRfXaCaJEmdlSm+H4lKLsVE3Kvoe2950tZdcnu5T1rISQKuaHovZNZw26/aKxvn0tS6oUG1WWmbAPvtbGjzPU2WvgV4uoEc7PkQ77MhHoYu1K7YvOVhv7uuJ7/QpdLcKtX2ZPthc1A/tEcK/zbAW+/0rbnqRVAlPuk0gC5b5cv1Q+BbIp8kGnX2VjQmT7bLm/Hfp1RfZ3kAdpGZI3h2iMnZCC47ftj+351WJ06PTLxk6I7OxxWH8rd4RCRHHuKC1DbOaIdJyQAn4vuPpqS8d5HVJUfy+p2lXjihIbuya/L2wowkae3TJEZFfmjywnBshRSl9s9Je1v7z9kL7bPE9Fi+xMlf09Z3Ne2KxNFu8qf2x02ojMD9McrpOLivTX9j6F9l/HfmgbotKnfp9nJCHqffFho0hcxWRNhHTarUI8h94PGx28Pp2xrrZ8SehcFToPhvabvbZ5JkXx4etZd4lZfn0+pIz8oMoRunpsbPgUUZ4NaYu1qcr9vC+2MWsa8yHOPlOxfU7L9Fnkg0t+0dGdZ9O38PGr6nPxwzRWXUX0/JmSN09kU+WPyD8f4jM+ioo7lW1femzuv0iXqi5r8yGq/fBts+gca/M8+orLvOc0RJ7P88c0J/m2L/OFbzfVa5LrXc4WH2NsbJrulcsafa+T99lFVwgpwr7JMy47U3T0FiFF56uQuss4j3gfbOb68sUlB6vOjaLPtrbdkLp9nZmqffcpqnurk4NU+oq8rzIx2Xddv8tel+peydar+htBpIufH0J4O2XFCCu2z0GZayjyDMzLS6Z+yGK1Sjmk7RNbtq91zrXQfumeOb58MdGTtxdlngmyc09nTlmxqfMcmvij67OJXV3R3dOQsZznh6qfkOL80M3BuvtW1B7yY2R+FLG/MsnzVXd+aF9VuUk1xzWudPwy1edzz1x8t9UfyndbHTY2yxTdHOCa92zj3CR+Te6fjzX5Ftf9M/E1VC4yzVehROa77/h09cmXb6Zxm2c3pPjSH9bn/wE="}});var $a=F((Bg,Ra)=>{var Fn=0,Ta=-3;function Jt(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function Yu(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new Jt,this.dtree=new Jt}var Aa=new Jt,Ca=new Jt,Vn=new Uint8Array(30),Mn=new Uint16Array(30),Pa=new Uint8Array(30),ka=new Uint16Array(30),qu=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xa=new Jt,ve=new Uint8Array(320);function La(t,e,r,n){var o,s;for(o=0;o<r;++o)t[o]=0;for(o=0;o<30-r;++o)t[o+r]=o/r|0;for(s=n,o=0;o<30;++o)e[o]=s,s+=1<<t[o]}function Ju(t,e){var r;for(r=0;r<7;++r)t.table[r]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,r=0;r<24;++r)t.trans[r]=256+r;for(r=0;r<144;++r)t.trans[24+r]=r;for(r=0;r<8;++r)t.trans[168+r]=280+r;for(r=0;r<112;++r)t.trans[176+r]=144+r;for(r=0;r<5;++r)e.table[r]=0;for(e.table[5]=32,r=0;r<32;++r)e.trans[r]=r}var va=new Uint16Array(16);function Dn(t,e,r,n){var o,s;for(o=0;o<16;++o)t.table[o]=0;for(o=0;o<n;++o)t.table[e[r+o]]++;for(t.table[0]=0,s=0,o=0;o<16;++o)va[o]=s,s+=t.table[o];for(o=0;o<n;++o)e[r+o]&&(t.trans[va[e[r+o]]++]=o)}function Qu(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=t.tag&1;return t.tag>>>=1,e}function Ie(t,e,r){if(!e)return r;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,n+r}function Un(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var r=0,n=0,o=0,s=t.tag;do n=2*n+(s&1),s>>>=1,++o,r+=e.table[o],n-=e.table[o];while(n>=0);return t.tag=s,t.bitcount-=o,e.trans[r+n]}function ef(t,e,r){var n,o,s,i,a,c;for(n=Ie(t,5,257),o=Ie(t,5,1),s=Ie(t,4,4),i=0;i<19;++i)ve[i]=0;for(i=0;i<s;++i){var l=Ie(t,3,0);ve[qu[i]]=l}for(Dn(xa,ve,0,19),a=0;a<n+o;){var d=Un(t,xa);switch(d){case 16:var y=ve[a-1];for(c=Ie(t,2,3);c;--c)ve[a++]=y;break;case 17:for(c=Ie(t,3,3);c;--c)ve[a++]=0;break;case 18:for(c=Ie(t,7,11);c;--c)ve[a++]=0;break;default:ve[a++]=d;break}}Dn(e,ve,0,n),Dn(r,ve,n,o)}function Ia(t,e,r){for(;;){var n=Un(t,e);if(n===256)return Fn;if(n<256)t.dest[t.destLen++]=n;else{var o,s,i,a;for(n-=257,o=Ie(t,Vn[n],Mn[n]),s=Un(t,r),i=t.destLen-Ie(t,Pa[s],ka[s]),a=i;a<i+o;++a)t.dest[t.destLen++]=t.dest[a]}}}function tf(t){for(var e,r,n;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if(e=t.source[t.sourceIndex+1],e=256*e+t.source[t.sourceIndex],r=t.source[t.sourceIndex+3],r=256*r+t.source[t.sourceIndex+2],e!==(~r&65535))return Ta;for(t.sourceIndex+=4,n=e;n;--n)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,Fn}function rf(t,e){var r=new Yu(t,e),n,o,s;do{switch(n=Qu(r),o=Ie(r,2,0),o){case 0:s=tf(r);break;case 1:s=Ia(r,Aa,Ca);break;case 2:ef(r,r.ltree,r.dtree),s=Ia(r,r.ltree,r.dtree);break;default:s=Ta}if(s!==Fn)throw new Error("Data error")}while(!n);return r.destLen<r.dest.length?typeof r.dest.slice=="function"?r.dest.slice(0,r.destLen):r.dest.subarray(0,r.destLen):r.dest}Ju(Aa,Ca);La(Vn,Mn,4,3);La(Pa,ka,2,1);Vn[28]=0;Mn[28]=258;Ra.exports=rf});var Na=F((zg,_a)=>{var nf=new Uint8Array(new Uint32Array([305419896]).buffer)[0]===18,Oa=(t,e,r)=>{let n=t[e];t[e]=t[r],t[r]=n},of=t=>{let e=t.length;for(let r=0;r<e;r+=4)Oa(t,r,r+3),Oa(t,r+1,r+2)},sf=t=>{nf&&of(t)};_a.exports={swap32LE:sf}});var Va=F((Gg,Fa)=>{var Da=$a(),{swap32LE:af}=Na(),Gn=11,ft=5,cf=Gn-ft,lf=65536>>Gn,uf=1<<cf,ff=uf-1,_r=2,df=1<<ft,Bn=df-1,Ua=65536>>ft,hf=1024>>ft,pf=Ua+hf,mf=pf,gf=32,yf=mf+gf,bf=1<<_r,zn=class{constructor(e){let r=typeof e.readUInt32BE=="function"&&typeof e.slice=="function";if(r||e instanceof Uint8Array){let n;if(r)this.highStart=e.readUInt32LE(0),this.errorValue=e.readUInt32LE(4),n=e.readUInt32LE(8),e=e.slice(12);else{let o=new DataView(e.buffer);this.highStart=o.getUint32(0,!0),this.errorValue=o.getUint32(4,!0),n=o.getUint32(8,!0),e=e.subarray(12)}e=Da(e,new Uint8Array(n)),e=Da(e,new Uint8Array(n)),af(e),this.data=new Uint32Array(e.buffer)}else({data:this.data,highStart:this.highStart,errorValue:this.errorValue}=e)}get(e){let r;return e<0||e>1114111?this.errorValue:e<55296||e>56319&&e<=65535?(r=(this.data[e>>ft]<<_r)+(e&Bn),this.data[r]):e<=65535?(r=(this.data[Ua+(e-55296>>ft)]<<_r)+(e&Bn),this.data[r]):e<this.highStart?(r=this.data[yf-lf+(e>>Gn)],r=this.data[r+(e>>ft&ff)],r=(r<<_r)+(e&Bn),this.data[r]):this.data[this.data.length-bf]}};Fa.exports=zn});var Ma=F((Hn,Wn)=>{(function(t,e){typeof Hn=="object"&&typeof Wn<"u"?Wn.exports=e():typeof define=="function"&&define.amd?define(e):(function(){var r=t.Base64,n=e();n.noConflict=function(){return t.Base64=r,n},t.Meteor&&(Base64=n),t.Base64=n})()})(typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:Hn,function(){"use strict";var t="3.7.7",e=t,r=typeof Buffer=="function",n=typeof TextDecoder=="function"?new TextDecoder:void 0,o=typeof TextEncoder=="function"?new TextEncoder:void 0,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=Array.prototype.slice.call(s),a=(function(u){var w={};return u.forEach(function(ee,ue){return w[ee]=ue}),w})(i),c=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,l=String.fromCharCode.bind(String),d=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(u){return new Uint8Array(Array.prototype.slice.call(u,0))},y=function(u){return u.replace(/=/g,"").replace(/[+\/]/g,function(w){return w=="+"?"-":"_"})},x=function(u){return u.replace(/[^A-Za-z0-9\+\/]/g,"")},v=function(u){for(var w,ee,ue,Xe,Te="",zr=u.length%3,tr=0;tr<u.length;){if((ee=u.charCodeAt(tr++))>255||(ue=u.charCodeAt(tr++))>255||(Xe=u.charCodeAt(tr++))>255)throw new TypeError("invalid character found");w=ee<<16|ue<<8|Xe,Te+=i[w>>18&63]+i[w>>12&63]+i[w>>6&63]+i[w&63]}return zr?Te.slice(0,zr-3)+"===".substring(zr):Te},I=typeof btoa=="function"?function(u){return btoa(u)}:r?function(u){return Buffer.from(u,"binary").toString("base64")}:v,A=r?function(u){return Buffer.from(u).toString("base64")}:function(u){for(var w=4096,ee=[],ue=0,Xe=u.length;ue<Xe;ue+=w)ee.push(l.apply(null,u.subarray(ue,ue+w)));return I(ee.join(""))},b=function(u,w){return w===void 0&&(w=!1),w?y(A(u)):A(u)},E=function(u){if(u.length<2){var w=u.charCodeAt(0);return w<128?u:w<2048?l(192|w>>>6)+l(128|w&63):l(224|w>>>12&15)+l(128|w>>>6&63)+l(128|w&63)}else{var w=65536+(u.charCodeAt(0)-55296)*1024+(u.charCodeAt(1)-56320);return l(240|w>>>18&7)+l(128|w>>>12&63)+l(128|w>>>6&63)+l(128|w&63)}},P=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,R=function(u){return u.replace(P,E)},U=r?function(u){return Buffer.from(u,"utf8").toString("base64")}:o?function(u){return A(o.encode(u))}:function(u){return I(R(u))},D=function(u,w){return w===void 0&&(w=!1),w?y(U(u)):U(u)},H=function(u){return D(u,!0)},pe=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Re=function(u){switch(u.length){case 4:var w=(7&u.charCodeAt(0))<<18|(63&u.charCodeAt(1))<<12|(63&u.charCodeAt(2))<<6|63&u.charCodeAt(3),ee=w-65536;return l((ee>>>10)+55296)+l((ee&1023)+56320);case 3:return l((15&u.charCodeAt(0))<<12|(63&u.charCodeAt(1))<<6|63&u.charCodeAt(2));default:return l((31&u.charCodeAt(0))<<6|63&u.charCodeAt(1))}},$e=function(u){return u.replace(pe,Re)},Ze=function(u){if(u=u.replace(/\s+/g,""),!c.test(u))throw new TypeError("malformed base64.");u+="==".slice(2-(u.length&3));for(var w,ee="",ue,Xe,Te=0;Te<u.length;)w=a[u.charAt(Te++)]<<18|a[u.charAt(Te++)]<<12|(ue=a[u.charAt(Te++)])<<6|(Xe=a[u.charAt(Te++)]),ee+=ue===64?l(w>>16&255):Xe===64?l(w>>16&255,w>>8&255):l(w>>16&255,w>>8&255,w&255);return ee},re=typeof atob=="function"?function(u){return atob(x(u))}:r?function(u){return Buffer.from(u,"base64").toString("binary")}:Ze,q=r?function(u){return d(Buffer.from(u,"base64"))}:function(u){return d(re(u).split("").map(function(w){return w.charCodeAt(0)}))},f=function(u){return q(h(u))},m=r?function(u){return Buffer.from(u,"base64").toString("utf8")}:n?function(u){return n.decode(q(u))}:function(u){return $e(re(u))},h=function(u){return x(u.replace(/[-_]/g,function(w){return w=="-"?"+":"/"}))},g=function(u){return m(h(u))},$=function(u){if(typeof u!="string")return!1;var w=u.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(w)||!/[^\s0-9a-zA-Z\-_]/.test(w)},C=function(u){return{value:u,enumerable:!1,writable:!0,configurable:!0}},z=function(){var u=function(w,ee){return Object.defineProperty(String.prototype,w,C(ee))};u("fromBase64",function(){return g(this)}),u("toBase64",function(w){return D(this,w)}),u("toBase64URI",function(){return D(this,!0)}),u("toBase64URL",function(){return D(this,!0)}),u("toUint8Array",function(){return f(this)})},W=function(){var u=function(w,ee){return Object.defineProperty(Uint8Array.prototype,w,C(ee))};u("toBase64",function(w){return b(this,w)}),u("toBase64URI",function(){return b(this,!0)}),u("toBase64URL",function(){return b(this,!0)})},ie=function(){z(),W()},Oe={version:t,VERSION:e,atob:re,atobPolyfill:Ze,btoa:I,btoaPolyfill:v,fromBase64:g,toBase64:D,encode:D,encodeURI:H,encodeURL:H,utob:R,btou:$e,decode:g,isValid:$,fromUint8Array:b,toUint8Array:f,extendString:z,extendUint8Array:W,extendBuiltins:ie};return Oe.Base64={},Object.keys(Oe).forEach(function(u){return Oe.Base64[u]=Oe[u]}),Oe})});var za=F((Hg,Ba)=>{var T=ba(),wf=wa().data,Ef=Ea().data,Sf=Sa().data,jn=Va(),Kn=Ma().Base64,xf=new jn(Kn.toUint8Array(wf)),vf=new jn(Kn.toUint8Array(Ef)),If=new jn(Kn.toUint8Array(Sf));function _(t,e){return(t&e)!==0}function Tf(t,e,r){let n=e.length;for(let o=r;o+1<n;o++){let s=e[o+0],i=e[o+1];switch(t.gb9c){case 0:_(s,T.InCB_Consonant)&&(t.gb9c=1);break;case 1:_(s,T.InCB_Extend)?t.gb9c=1:_(s,T.InCB_Linker)?t.gb9c=2:t.gb9c=_(s,T.InCB_Consonant)?1:0;break;case 2:_(s,T.InCB_Extend|T.InCB_Linker)?t.gb9c=2:t.gb9c=_(s,T.InCB_Consonant)?1:0;break}switch(t.gb11){case 0:_(s,T.Extended_Pictographic)&&(t.gb11=1);break;case 1:_(s,T.Extend)?t.gb11=1:_(s,T.ZWJ)?t.gb11=2:t.gb11=_(s,T.Extended_Pictographic)?1:0;break;case 2:t.gb11=_(s,T.Extended_Pictographic)?1:0;break}switch(t.gb12){case 0:_(s,T.Regional_Indicator)?t.gb12=1:t.gb12=-1;break;case 1:_(s,T.Regional_Indicator)?t.gb12=0:t.gb12=-1;break}switch(t.gb13){case 0:_(s,T.Regional_Indicator)||(t.gb13=1);break;case 1:_(s,T.Regional_Indicator)?t.gb13=2:t.gb13=1;break;case 2:t.gb13=1;break}if(!(_(s,T.CR)&&_(i,T.LF))){if(_(s,T.Control|T.CR|T.LF)||_(i,T.Control|T.CR|T.LF))return o+1-r;if(!(_(s,T.L)&&_(i,T.L|T.V|T.LV|T.LVT))&&!(_(s,T.LV|T.V)&&_(i,T.V|T.T))&&!(_(s,T.LVT|T.T)&&_(i,T.T))&&!_(i,T.Extend|T.ZWJ)&&!_(i,T.SpacingMark)&&!_(s,T.Prepend)&&!(_(i,T.InCB_Consonant)&&t.gb9c===2)&&!(_(i,T.Extended_Pictographic)&&t.gb11===2)&&!(_(i,T.Regional_Indicator)&&t.gb12===1)&&!(_(i,T.Regional_Indicator)&&t.gb13===2))return o+1-r}}return n-r}Ba.exports=function(e){let r=[],n=[0],o=[];for(let i=0;i<e.length;){let a=e.codePointAt(i);o.push(xf.get(a)|vf.get(a)|If.get(a)),i+=a>65535?2:1,n.push(i)}let s={gb9c:0,gb11:0,gb12:0,gb13:0};for(let i=0;i<o.length;){let a=Tf(s,o,i),c=n[i],l=n[i+a];r.push(e.slice(c,l)),i+=a}return r}});var od={};Sc(od,{default:()=>nd});module.exports=xc(od);var Ae=Z(require("node:crypto"),1);var vc=t=>{let e=new ArrayBuffer(8),r=new Uint8Array(e),n=t;for(let o=7;o>=0&&n!==0;o--)r[o]=n&255,n-=r[o],n/=256;return r},be=(()=>{if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"__GLOBALTHIS__",{get(){return this},configurable:!0});try{if(typeof __GLOBALTHIS__<"u")return __GLOBALTHIS__}finally{delete Object.prototype.__GLOBALTHIS__}if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global})(),to=t=>{switch(!0){case/^(?:SHA-?1|SSL3-SHA1)$/i.test(t):return"SHA1";case/^SHA(?:2?-)?224$/i.test(t):return"SHA224";case/^SHA(?:2?-)?256$/i.test(t):return"SHA256";case/^SHA(?:2?-)?384$/i.test(t):return"SHA384";case/^SHA(?:2?-)?512$/i.test(t):return"SHA512";case/^SHA3-224$/i.test(t):return"SHA3-224";case/^SHA3-256$/i.test(t):return"SHA3-256";case/^SHA3-384$/i.test(t):return"SHA3-384";case/^SHA3-512$/i.test(t):return"SHA3-512";default:throw new TypeError(`Unknown hash algorithm: ${t}`)}},Ic=(t,e,r)=>{if(Ae?.createHmac){let n=Ae.createHmac(t,be.Buffer.from(e));return n.update(be.Buffer.from(r)),n.digest()}else throw new Error("Missing HMAC function")},Gr="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",Tc=t=>{t=t.replace(/ /g,"");let e=t.length;for(;t[e-1]==="=";)--e;t=(e<t.length?t.substring(0,e):t).toUpperCase();let r=new ArrayBuffer(t.length*5/8|0),n=new Uint8Array(r),o=0,s=0,i=0;for(let a=0;a<t.length;a++){let c=Gr.indexOf(t[a]);if(c===-1)throw new TypeError(`Invalid character found: ${t[a]}`);s=s<<5|c,o+=5,o>=8&&(o-=8,n[i++]=s>>>o)}return n},Ac=t=>{let e=0,r=0,n="";for(let o=0;o<t.length;o++)for(r=r<<8|t[o],e+=8;e>=5;)n+=Gr[r>>>e-5&31],e-=5;return e>0&&(n+=Gr[r<<5-e&31]),n},Cc=t=>{t=t.replace(/ /g,"");let e=new ArrayBuffer(t.length/2),r=new Uint8Array(e);for(let n=0;n<t.length;n+=2)r[n/2]=parseInt(t.substring(n,n+2),16);return r},Pc=t=>{let e="";for(let r=0;r<t.length;r++){let n=t[r].toString(16);n.length===1&&(e+="0"),e+=n}return e.toUpperCase()},kc=t=>{let e=new ArrayBuffer(t.length),r=new Uint8Array(e);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n)&255;return r},Lc=t=>{let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},Jn=be.TextEncoder?new be.TextEncoder:null,Qn=be.TextDecoder?new be.TextDecoder:null,Rc=t=>{if(!Jn)throw new Error("Encoding API not available");return Jn.encode(t)},$c=t=>{if(!Qn)throw new Error("Encoding API not available");return Qn.decode(t)},Oc=t=>{if(Ae?.randomBytes)return Ae.randomBytes(t);if(be.crypto?.getRandomValues)return be.crypto.getRandomValues(new Uint8Array(t));throw new Error("Cryptography API not available")},ht=class t{static fromLatin1(e){return new t({buffer:kc(e).buffer})}static fromUTF8(e){return new t({buffer:Rc(e).buffer})}static fromBase32(e){return new t({buffer:Tc(e).buffer})}static fromHex(e){return new t({buffer:Cc(e).buffer})}get buffer(){return this.bytes.buffer}get latin1(){return Object.defineProperty(this,"latin1",{enumerable:!0,writable:!1,configurable:!1,value:Lc(this.bytes)}),this.latin1}get utf8(){return Object.defineProperty(this,"utf8",{enumerable:!0,writable:!1,configurable:!1,value:$c(this.bytes)}),this.utf8}get base32(){return Object.defineProperty(this,"base32",{enumerable:!0,writable:!1,configurable:!1,value:Ac(this.bytes)}),this.base32}get hex(){return Object.defineProperty(this,"hex",{enumerable:!0,writable:!1,configurable:!1,value:Pc(this.bytes)}),this.hex}constructor({buffer:e,size:r=20}={}){this.bytes=typeof e>"u"?Oc(r):new Uint8Array(e),Object.defineProperty(this,"bytes",{enumerable:!0,writable:!1,configurable:!1,value:this.bytes})}},_c=(t,e)=>{if(Ae?.timingSafeEqual)return Ae.timingSafeEqual(be.Buffer.from(t),be.Buffer.from(e));{if(t.length!==e.length)throw new TypeError("Input strings must have the same length");let r=-1,n=0;for(;++r<t.length;)n|=t.charCodeAt(r)^e.charCodeAt(r);return n===0}},pt=class t{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,counter:0,window:1}}static generate({secret:e,algorithm:r=t.defaults.algorithm,digits:n=t.defaults.digits,counter:o=t.defaults.counter}){let s=Ic(r,e.bytes,vc(o)),i=s[s.byteLength-1]&15;return(((s[i]&127)<<24|(s[i+1]&255)<<16|(s[i+2]&255)<<8|s[i+3]&255)%10**n).toString().padStart(n,"0")}generate({counter:e=this.counter++}={}){return t.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:e})}static validate({token:e,secret:r,algorithm:n,digits:o=t.defaults.digits,counter:s=t.defaults.counter,window:i=t.defaults.window}){if(e.length!==o)return null;let a=null,c=l=>{let d=t.generate({secret:r,algorithm:n,digits:o,counter:l});_c(e,d)&&(a=l-s)};c(s);for(let l=1;l<=i&&a===null&&(c(s-l),!(a!==null||(c(s+l),a!==null)));++l);return a}validate({token:e,counter:r=this.counter,window:n}){return t.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:r,window:n})}toString(){let e=encodeURIComponent;return`otpauth://hotp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&counter=${e(this.counter)}`}constructor({issuer:e=t.defaults.issuer,label:r=t.defaults.label,issuerInLabel:n=t.defaults.issuerInLabel,secret:o=new ht,algorithm:s=t.defaults.algorithm,digits:i=t.defaults.digits,counter:a=t.defaults.counter}={}){this.issuer=e,this.label=r,this.issuerInLabel=n,this.secret=typeof o=="string"?ht.fromBase32(o):o,this.algorithm=to(s),this.digits=i,this.counter=a}},Ye=class t{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,period:30,window:1}}static counter({period:e=t.defaults.period,timestamp:r=Date.now()}={}){return Math.floor(r/1e3/e)}counter({timestamp:e=Date.now()}={}){return t.counter({period:this.period,timestamp:e})}static remaining({period:e=t.defaults.period,timestamp:r=Date.now()}={}){return e*1e3-r%(e*1e3)}remaining({timestamp:e=Date.now()}={}){return t.remaining({period:this.period,timestamp:e})}static generate({secret:e,algorithm:r,digits:n,period:o=t.defaults.period,timestamp:s=Date.now()}){return pt.generate({secret:e,algorithm:r,digits:n,counter:t.counter({period:o,timestamp:s})})}generate({timestamp:e=Date.now()}={}){return t.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:e})}static validate({token:e,secret:r,algorithm:n,digits:o,period:s=t.defaults.period,timestamp:i=Date.now(),window:a}){return pt.validate({token:e,secret:r,algorithm:n,digits:o,counter:t.counter({period:s,timestamp:i}),window:a})}validate({token:e,timestamp:r,window:n}){return t.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:r,window:n})}toString(){let e=encodeURIComponent;return`otpauth://totp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&period=${e(this.period)}`}constructor({issuer:e=t.defaults.issuer,label:r=t.defaults.label,issuerInLabel:n=t.defaults.issuerInLabel,secret:o=new ht,algorithm:s=t.defaults.algorithm,digits:i=t.defaults.digits,period:a=t.defaults.period}={}){this.issuer=e,this.label=r,this.issuerInLabel=n,this.secret=typeof o=="string"?ht.fromBase32(o):o,this.algorithm=to(s),this.digits=i,this.period=a}},Nc=/^otpauth:\/\/([ht]otp)\/(.+)\?([A-Z0-9.~_-]+=[^?&]*(?:&[A-Z0-9.~_-]+=[^?&]*)*)$/i,Dc=/^[2-7A-Z]+=*$/i,Uc=/^SHA(?:1|224|256|384|512|3-224|3-256|3-384|3-512)$/i,Fc=/^[+-]?\d+$/,eo=/^\+?[1-9]\d*$/,nr=class{static parse(e){let r;try{r=e.match(Nc)}catch{}if(!Array.isArray(r))throw new URIError("Invalid URI format");let n=r[1].toLowerCase(),o=r[2].split(/(?::|%3A) *(.+)/i,2).map(decodeURIComponent),s=r[3].split("&").reduce((c,l)=>{let d=l.split(/=(.*)/,2).map(decodeURIComponent),y=d[0].toLowerCase(),x=d[1],v=c;return v[y]=x,v},{}),i,a={};if(n==="hotp")if(i=pt,typeof s.counter<"u"&&Fc.test(s.counter))a.counter=parseInt(s.counter,10);else throw new TypeError("Missing or invalid 'counter' parameter");else if(n==="totp"){if(i=Ye,typeof s.period<"u")if(eo.test(s.period))a.period=parseInt(s.period,10);else throw new TypeError("Invalid 'period' parameter")}else throw new TypeError("Unknown OTP type");if(typeof s.issuer<"u"&&(a.issuer=s.issuer),o.length===2?(a.label=o[1],typeof a.issuer>"u"||a.issuer===""?a.issuer=o[0]:o[0]===""&&(a.issuerInLabel=!1)):(a.label=o[0],typeof a.issuer<"u"&&a.issuer!==""&&(a.issuerInLabel=!1)),typeof s.secret<"u"&&Dc.test(s.secret))a.secret=s.secret;else throw new TypeError("Missing or invalid 'secret' parameter");if(typeof s.algorithm<"u")if(Uc.test(s.algorithm))a.algorithm=s.algorithm;else throw new TypeError("Invalid 'algorithm' parameter");if(typeof s.digits<"u")if(eo.test(s.digits))a.digits=parseInt(s.digits,10);else throw new TypeError("Invalid 'digits' parameter");return new i(a)}static stringify(e){if(e instanceof pt||e instanceof Ye)return e.toString();throw new TypeError("Invalid 'HOTP/TOTP' object")}};var Ke=require("react"),L=require("@raycast/api");var V=Z(require("react")),M=require("@raycast/api");var ro=Object.prototype.hasOwnProperty;function or(t,e){var r,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&or(t[n],e[n]););return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(ro.call(t,r)&&++n&&!ro.call(e,r)||!(r in e)||!or(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}var qe=Z(require("node:fs")),sr=Z(require("node:path"));var so=require("react/jsx-runtime");function Mc(t){let e=(0,V.useRef)(t),r=(0,V.useRef)(0);return or(t,e.current)||(e.current=t,r.current+=1),(0,V.useMemo)(()=>e.current,[r.current])}function me(t){let e=(0,V.useRef)(t);return e.current=t,e}function Bc(t,e){let r=t instanceof Error?t.message:String(t);return(0,M.showToast)({style:M.Toast.Style.Failure,title:e?.title??"Something went wrong",message:e?.message??r,primaryAction:e?.primaryAction??no(t),secondaryAction:e?.primaryAction?no(t):void 0})}var no=t=>{let e=!0,r="[Extension Name]...",n="";try{let i=JSON.parse((0,qe.readFileSync)((0,sr.join)(M.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,n=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(e=!1)}catch{}let o=M.environment.isDevelopment||e,s=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:o?"Copy Logs":"Report Error",onAction(i){i.hide(),o?M.Clipboard.copy(s):(0,M.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function ir(t,e,r){let n=(0,V.useRef)(0),[o,s]=(0,V.useState)({isLoading:!0}),i=me(t),a=me(r?.abortable),c=me(e||[]),l=me(r?.onError),d=me(r?.onData),y=me(r?.onWillExecute),x=me(r?.failureToastOptions),v=me(o.data),I=(0,V.useRef)(null),A=(0,V.useRef)({page:0}),b=(0,V.useRef)(!1),E=(0,V.useRef)(!0),P=(0,V.useRef)(50),R=(0,V.useCallback)(()=>(a.current&&(a.current.current?.abort(),a.current.current=new AbortController),++n.current),[a]),U=(0,V.useCallback)((...re)=>{let q=R();y.current?.(re),s(h=>({...h,isLoading:!0}));let f=zc(i.current)(...re);function m(h){return h.name=="AbortError"||q===n.current&&(l.current?l.current(h):M.environment.launchType!==M.LaunchType.Background&&Bc(h,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(g){g.hide(),I.current?.(...c.current||[])}},...x.current}),s({error:h,isLoading:!1})),h}return typeof f=="function"?(b.current=!0,f(A.current).then(({data:h,hasMore:g,cursor:$})=>(q===n.current&&(A.current&&(A.current.cursor=$,A.current.lastItem=h?.[h.length-1]),d.current&&d.current(h,A.current),g&&(P.current=h.length),E.current=g,s(C=>A.current.page===0?{data:h,isLoading:!1}:{data:(C.data||[])?.concat(h),isLoading:!1})),h),h=>(E.current=!1,m(h)))):(b.current=!1,f.then(h=>(q===n.current&&(d.current&&d.current(h),s({data:h,isLoading:!1})),h),m))},[d,l,c,i,s,I,y,A,x,R]);I.current=U;let D=(0,V.useCallback)(()=>{A.current={page:0};let re=c.current||[];return U(...re)},[U,c]),H=(0,V.useCallback)(async(re,q)=>{let f;try{if(q?.optimisticUpdate){R(),typeof q?.rollbackOnError!="function"&&q?.rollbackOnError!==!1&&(f=structuredClone(v.current?.value));let m=q.optimisticUpdate;s(h=>({...h,data:m(h.data)}))}return await re}catch(m){if(typeof q?.rollbackOnError=="function"){let h=q.rollbackOnError;s(g=>({...g,data:h(g.data)}))}else q?.optimisticUpdate&&q?.rollbackOnError!==!1&&s(h=>({...h,data:f}));throw m}finally{q?.shouldRevalidateAfter!==!1&&(M.environment.launchType===M.LaunchType.Background||M.environment.commandMode==="menu-bar"?await D():D())}},[D,v,s,R]),pe=(0,V.useCallback)(()=>{A.current.page+=1;let re=c.current||[];U(...re)},[A,c,U]);(0,V.useEffect)(()=>{A.current={page:0},r?.execute!==!1?U(...e||[]):R()},[Mc([e,r?.execute,U]),a,A]),(0,V.useEffect)(()=>()=>{R()},[R]);let Re=r?.execute!==!1?o.isLoading:!1,$e={...o,isLoading:Re},Ze=b.current?{pageSize:P.current,hasMore:E.current,onLoadMore:pe}:void 0;return{...$e,revalidate:D,mutate:H,pagination:Ze}}function zc(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function Gc(t,e){let r=this[t];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:e}function Hc(t,e){return typeof e=="string"&&e.startsWith("__raycast_cached_date__")?new Date(e.replace("__raycast_cached_date__","")):typeof e=="string"&&e.startsWith("__raycast_cached_buffer__")?Buffer.from(e.replace("__raycast_cached_buffer__",""),"base64"):e}var Wc=Symbol("cache without namespace"),oo=new Map;function io(t,e,r){let n=r?.cacheNamespace||Wc,o=oo.get(n)||oo.set(n,new M.Cache({namespace:r?.cacheNamespace})).get(n);if(!o)throw new Error("Missing cache");let s=me(t),i=me(e),a=(0,V.useSyncExternalStore)(o.subscribe,()=>{try{return o.get(s.current)}catch(y){console.error("Could not get Cache data:",y);return}}),c=(0,V.useMemo)(()=>{if(typeof a<"u"){if(a==="undefined")return;try{return JSON.parse(a,Hc)}catch(y){return console.warn("The cached data is corrupted",y),i.current}}else return i.current},[a,i]),l=me(c),d=(0,V.useCallback)(y=>{let x=typeof y=="function"?y(l.current):y;if(typeof x>"u")o.set(s.current,"undefined");else{let v=JSON.stringify(x,Gc);o.set(s.current,v)}return x},[o,s,l]);return[c,d]}var Ot=require("@raycast/api"),ma=require("react");var ge=require("@raycast/api");var zi=require("@raycast/api");var ar=require("react"),ao=(0,ar.createContext)(null),_t=()=>{let t=(0,ar.useContext)(ao);if(t==null)throw new Error("useSelectVaultItem must be used within a VaultItemContext.Provider");return t},co=ao;var kt=require("@raycast/api");var _e=require("@raycast/api"),Je=require("react/jsx-runtime"),jc=t=>{let{description:e,onConfirm:r}=t;function n(o){r(o.password)}return(0,Je.jsxs)(_e.Form,{navigationTitle:"Confirmation Required",actions:(0,Je.jsx)(_e.ActionPanel,{children:(0,Je.jsx)(_e.Action.SubmitForm,{title:"Confirm",onSubmit:n})}),children:[(0,Je.jsx)(_e.Form.Description,{title:"Confirmation Required for",text:e}),(0,Je.jsx)(_e.Form.PasswordField,{autoFocus:!0,id:"password",title:"Master Password"})]})},lo=jc;var Pt=require("@raycast/api"),ze=require("react");var O=require("@raycast/api"),Wt=require("react");var mt=require("@raycast/api");var we={VISA:"Visa",MASTERCARD:"Mastercard",AMEX:"Amex",DISCOVER:"Discover",DINERS_CLUB:"Diners Club",JCB:"JCB",MAESTRO:"Maestro",UNION_PAY:"UnionPay",RU_PAY:"RuPay",OTHER:"Other"};var uo="https://bitwarden.com",Qe="HIDDEN-VALUE",B={PASSWORD_OPTIONS:"bw-generate-password-options",PASSWORD_ONE_TIME_WARNING:"bw-generate-password-warning-accepted",SESSION_TOKEN:"sessionToken",REPROMPT_HASH:"sessionRepromptHash",SERVER_URL:"cliServer",LAST_ACTIVITY_TIME:"lastActivityTime",VAULT_LOCK_REASON:"vaultLockReason",VAULT_FAVORITE_ORDER:"vaultFavoriteOrder",VAULT_LAST_STATUS:"lastVaultStatus"},et={TIMEOUT:"Vault timed out due to inactivity",MANUAL:"Manually locked by the user",SYSTEM_LOCK:"Screen was locked",SYSTEM_SLEEP:"System went to sleep",CLI_UPDATED:"Bitwarden has been updated. Please login again."};var tt={ALL:"all",NO_FOLDER:"no-folder"},ae={IV:"iv",VAULT:"vault",CURRENT_FOLDER_ID:"currentFolderId",SEND_TYPE_FILTER:"sendTypeFilter",CLI_VERSION:"cliVersion"},gt={1:mt.Icon.Globe,3:mt.Icon.CreditCard,4:mt.Icon.Person,2:mt.Icon.Document,5:mt.Icon.Key};var lt=require("react");var j=require("@raycast/api");var Vs=require("node:buffer"),Ms=Z(require("node:path"),1),hn=Z(require("node:child_process"),1),Ft=Z(require("node:process"),1),Bs=Z(Qo(),1);function en(t){let e=typeof t=="string"?`
`:10,r=typeof t=="string"?"\r":13;return t[t.length-1]===e&&(t=t.slice(0,-1)),t[t.length-1]===r&&(t=t.slice(0,-1)),t}var Nt=Z(require("node:process"),1),wt=Z(require("node:path"),1),es=Z(require("node:url"),1);function lr(t={}){let{env:e=process.env,platform:r=process.platform}=t;return r!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}function wl(t={}){let{cwd:e=Nt.default.cwd(),path:r=Nt.default.env[lr()],execPath:n=Nt.default.execPath}=t,o,s=e instanceof URL?es.default.fileURLToPath(e):e,i=wt.default.resolve(s),a=[];for(;o!==i;)a.push(wt.default.join(i,"node_modules/.bin")),o=i,i=wt.default.resolve(i,"..");return a.push(wt.default.resolve(s,n,"..")),[...a,r].join(wt.default.delimiter)}function ts({env:t=Nt.default.env,...e}={}){t={...t};let r=lr({env:t});return e.path=t[r],t[r]=wl(e),t}var El=(t,e,r,n)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let o=Object.getOwnPropertyDescriptor(t,r),s=Object.getOwnPropertyDescriptor(e,r);!Sl(o,s)&&n||Object.defineProperty(t,r,s)},Sl=function(t,e){return t===void 0||t.configurable||t.writable===e.writable&&t.enumerable===e.enumerable&&t.configurable===e.configurable&&(t.writable||t.value===e.value)},xl=(t,e)=>{let r=Object.getPrototypeOf(e);r!==Object.getPrototypeOf(t)&&Object.setPrototypeOf(t,r)},vl=(t,e)=>`/* Wrapped ${t}*/
${e}`,Il=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Tl=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Al=(t,e,r)=>{let n=r===""?"":`with ${r.trim()}() `,o=vl.bind(null,n,e.toString());Object.defineProperty(o,"name",Tl),Object.defineProperty(t,"toString",{...Il,value:o})};function tn(t,e,{ignoreNonConfigurable:r=!1}={}){let{name:n}=t;for(let o of Reflect.ownKeys(e))El(t,e,o,r);return xl(t,e),Al(t,e,n),t}var ur=new WeakMap,rs=(t,e={})=>{if(typeof t!="function")throw new TypeError("Expected a function");let r,n=0,o=t.displayName||t.name||"<anonymous>",s=function(...i){if(ur.set(s,++n),n===1)r=t.apply(this,i),t=null;else if(e.throw===!0)throw new Error(`Function \`${o}\` can only be called once`);return r};return tn(s,t),ur.set(s,n),s};rs.callCount=t=>{if(!ur.has(t))throw new Error(`The given function \`${t.name}\` is not wrapped by the \`onetime\` package`);return ur.get(t)};var ns=rs;var ls=require("node:os");var os=function(){let t=is-ss+1;return Array.from({length:t},Cl)},Cl=function(t,e){return{name:`SIGRT${e+1}`,number:ss+e,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},ss=34,is=64;var cs=require("node:os");var as=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var rn=function(){let t=os();return[...as,...t].map(Pl)},Pl=function({name:t,number:e,description:r,action:n,forced:o=!1,standard:s}){let{signals:{[t]:i}}=cs.constants,a=i!==void 0;return{name:t,number:a?i:e,description:r,supported:a,action:n,forced:o,standard:s}};var kl=function(){let t=rn();return Object.fromEntries(t.map(Ll))},Ll=function({name:t,number:e,description:r,supported:n,action:o,forced:s,standard:i}){return[t,{name:t,number:e,description:r,supported:n,action:o,forced:s,standard:i}]},us=kl(),Rl=function(){let t=rn(),e=65,r=Array.from({length:e},(n,o)=>$l(o,t));return Object.assign({},...r)},$l=function(t,e){let r=Ol(t,e);if(r===void 0)return{};let{name:n,description:o,supported:s,action:i,forced:a,standard:c}=r;return{[t]:{name:n,number:t,description:o,supported:s,action:i,forced:a,standard:c}}},Ol=function(t,e){let r=e.find(({name:n})=>ls.constants.signals[n]===t);return r!==void 0?r:e.find(n=>n.number===t)},zd=Rl();var _l=({timedOut:t,timeout:e,errorCode:r,signal:n,signalDescription:o,exitCode:s,isCanceled:i})=>t?`timed out after ${e} milliseconds`:i?"was canceled":r!==void 0?`failed with ${r}`:n!==void 0?`was killed with ${n} (${o})`:s!==void 0?`failed with exit code ${s}`:"failed",nn=({stdout:t,stderr:e,all:r,error:n,signal:o,exitCode:s,command:i,escapedCommand:a,timedOut:c,isCanceled:l,killed:d,parsed:{options:{timeout:y}}})=>{s=s===null?void 0:s,o=o===null?void 0:o;let x=o===void 0?void 0:us[o].description,v=n&&n.code,A=`Command ${_l({timedOut:c,timeout:y,errorCode:v,signal:o,signalDescription:x,exitCode:s,isCanceled:l})}: ${i}`,b=Object.prototype.toString.call(n)==="[object Error]",E=b?`${A}
${n.message}`:A,P=[E,e,t].filter(Boolean).join(`
`);return b?(n.originalMessage=n.message,n.message=P):n=new Error(P),n.shortMessage=E,n.command=i,n.escapedCommand=a,n.exitCode=s,n.signal=o,n.signalDescription=x,n.stdout=t,n.stderr=e,r!==void 0&&(n.all=r),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!c,n.isCanceled=l,n.killed=d&&!c,n};var fr=["stdin","stdout","stderr"],Nl=t=>fr.some(e=>t[e]!==void 0),fs=t=>{if(!t)return;let{stdio:e}=t;if(e===void 0)return fr.map(n=>t[n]);if(Nl(t))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${fr.map(n=>`\`${n}\``).join(", ")}`);if(typeof e=="string")return e;if(!Array.isArray(e))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof e}\``);let r=Math.max(e.length,fr.length);return Array.from({length:r},(n,o)=>e[o])};var bs=Z(require("node:os"),1),ws=Z(ys(),1),Dl=1e3*5,Es=(t,e="SIGTERM",r={})=>{let n=t(e);return Ul(t,e,r,n),n},Ul=(t,e,r,n)=>{if(!Fl(e,r,n))return;let o=Ml(r),s=setTimeout(()=>{t("SIGKILL")},o);s.unref&&s.unref()},Fl=(t,{forceKillAfterTimeout:e},r)=>Vl(t)&&e!==!1&&r,Vl=t=>t===bs.default.constants.signals.SIGTERM||typeof t=="string"&&t.toUpperCase()==="SIGTERM",Ml=({forceKillAfterTimeout:t=!0})=>{if(t===!0)return Dl;if(!Number.isFinite(t)||t<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${t}\` (${typeof t})`);return t},Ss=(t,e)=>{t.kill()&&(e.isCanceled=!0)},Bl=(t,e,r)=>{t.kill(e),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:e}))},xs=(t,{timeout:e,killSignal:r="SIGTERM"},n)=>{if(e===0||e===void 0)return n;let o,s=new Promise((a,c)=>{o=setTimeout(()=>{Bl(t,r,c)},e)}),i=n.finally(()=>{clearTimeout(o)});return Promise.race([s,i])},vs=({timeout:t})=>{if(t!==void 0&&(!Number.isFinite(t)||t<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${t}\` (${typeof t})`)},Is=async(t,{cleanup:e,detached:r},n)=>{if(!e||r)return n;let o=(0,ws.default)(()=>{t.kill()});return n.finally(()=>{o()})};function Ts(t){return t!==null&&typeof t=="object"&&typeof t.pipe=="function"}var un=Z(Ps(),1),Rs=Z(Ls(),1),$s=(t,e)=>{e!==void 0&&(Ts(e)?e.pipe(t.stdin):t.stdin.end(e))},Os=(t,{all:e})=>{if(!e||!t.stdout&&!t.stderr)return;let r=(0,Rs.default)();return t.stdout&&r.add(t.stdout),t.stderr&&r.add(t.stderr),r},cn=async(t,e)=>{if(!(!t||e===void 0)){t.destroy();try{return await e}catch(r){return r.bufferedData}}},ln=(t,{encoding:e,buffer:r,maxBuffer:n})=>{if(!(!t||!r))return e?(0,un.default)(t,{encoding:e,maxBuffer:n}):un.default.buffer(t,{maxBuffer:n})},_s=async({stdout:t,stderr:e,all:r},{encoding:n,buffer:o,maxBuffer:s},i)=>{let a=ln(t,{encoding:n,buffer:o,maxBuffer:s}),c=ln(e,{encoding:n,buffer:o,maxBuffer:s}),l=ln(r,{encoding:n,buffer:o,maxBuffer:s*2});try{return await Promise.all([i,a,c,l])}catch(d){return Promise.all([{error:d,signal:d.signal,timedOut:d.timedOut},cn(t,a),cn(e,c),cn(r,l)])}};var Xl=(async()=>{})().constructor.prototype,Yl=["then","catch","finally"].map(t=>[t,Reflect.getOwnPropertyDescriptor(Xl,t)]),fn=(t,e)=>{for(let[r,n]of Yl){let o=typeof e=="function"?(...s)=>Reflect.apply(n.value,e(),s):n.value.bind(e);Reflect.defineProperty(t,r,{...n,value:o})}return t},Ns=t=>new Promise((e,r)=>{t.on("exit",(n,o)=>{e({exitCode:n,signal:o})}),t.on("error",n=>{r(n)}),t.stdin&&t.stdin.on("error",n=>{r(n)})});var Ds=(t,e=[])=>Array.isArray(e)?[t,...e]:[t],ql=/^[\w.-]+$/,Jl=/"/g,Ql=t=>typeof t!="string"||ql.test(t)?t:`"${t.replace(Jl,'\\"')}"`,Us=(t,e)=>Ds(t,e).join(" "),Fs=(t,e)=>Ds(t,e).map(r=>Ql(r)).join(" ");var eu=1e3*1e3*100,tu=({env:t,extendEnv:e,preferLocal:r,localDir:n,execPath:o})=>{let s=e?{...Ft.default.env,...t}:t;return r?ts({env:s,cwd:n,execPath:o}):s},ru=(t,e,r={})=>{let n=Bs.default._parse(t,e,r);return t=n.command,e=n.args,r=n.options,r={maxBuffer:eu,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||Ft.default.cwd(),execPath:Ft.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...r},r.env=tu(r),r.stdio=fs(r),Ft.default.platform==="win32"&&Ms.default.basename(t,".exe")==="cmd"&&e.unshift("/q"),{file:t,args:e,options:r,parsed:n}},dn=(t,e,r)=>typeof e!="string"&&!Vs.Buffer.isBuffer(e)?r===void 0?void 0:"":t.stripFinalNewline?en(e):e;function zs(t,e,r){let n=ru(t,e,r),o=Us(t,e),s=Fs(t,e);vs(n.options);let i;try{i=hn.default.spawn(n.file,n.args,n.options)}catch(v){let I=new hn.default.ChildProcess,A=Promise.reject(nn({error:v,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return fn(I,A)}let a=Ns(i),c=xs(i,n.options,a),l=Is(i,n.options,c),d={isCanceled:!1};i.kill=Es.bind(null,i.kill.bind(i)),i.cancel=Ss.bind(null,i,d);let x=ns(async()=>{let[{error:v,exitCode:I,signal:A,timedOut:b},E,P,R]=await _s(i,n.options,l),U=dn(n.options,E),D=dn(n.options,P),H=dn(n.options,R);if(v||I!==0||A!==null){let pe=nn({error:v,exitCode:I,signal:A,stdout:U,stderr:D,all:H,command:o,escapedCommand:s,parsed:n,timedOut:b,isCanceled:d.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:i.killed});if(!n.options.reject)return pe;throw pe}return{command:o,escapedCommand:s,exitCode:0,stdout:U,stderr:D,all:H,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return $s(i,n.options.input),i.all=Os(i,n.options),fn(i,x)}var le=require("fs");var nu=require("@raycast/api"),Hs=require("crypto");var Gs="foobarbazzybaz";function Ws(t){return Object.entries(t).flatMap(([e,r])=>r?[`--${e}`,r]:[])}function pn(t){return new Promise((e,r)=>{(0,Hs.pbkdf2)(t,Gs,1e5,64,"sha512",(n,o)=>{if(n!=null){r(n);return}e(o.toString("hex"))})})}var Vt=require("@raycast/api");var ou={IMMEDIATELY:"0",ONE_MINUTE:"60000",FIVE_MINUTES:"300000",FIFTEEN_MINUTES:"900000",THIRTY_MINUTES:"1800000",ONE_HOUR:"3600000",FOUR_HOURS:"14400000",EIGHT_HOURS:"28800000",ONE_DAY:"86400000",NEVER:"-1",SYSTEM_LOCK:"-2",SYSTEM_SLEEP:"-3"},ne=Object.entries(ou).reduce((t,[e,r])=>(t[e]=parseInt(r),t),{});var js={[ne.IMMEDIATELY]:"Immediately",[ne.ONE_MINUTE]:"1 Minute",[ne.FIVE_MINUTES]:"5 Minutes",[ne.FIFTEEN_MINUTES]:"15 Minutes",[ne.THIRTY_MINUTES]:"30 Minutes",[ne.ONE_HOUR]:"1 Hour",[ne.FOUR_HOURS]:"4 Hours",[ne.EIGHT_HOURS]:"8 Hours",[ne.ONE_DAY]:"1 Day"},Ks={cardholderName:"Cardholder name",brand:"Brand",number:"Number",expMonth:"Expiration month",expYear:"Expiration year",code:"Security code (CVV)"};var Zs={1:"Login",3:"Card",4:"Identity",2:"Secure Note",5:"SSH Key"};function yr(){let{serverUrl:t}=(0,Vt.getPreferenceValues)();return!t||t==="bitwarden.com"||t==="https://bitwarden.com"?void 0:t}var su={search:"transientCopySearch","generate-password":"transientCopyGeneratePassword","generate-password-quick":"transientCopyGeneratePasswordQuick"};function Xs(t){let e=su[Vt.environment.commandName],r=(0,Vt.getPreferenceValues)()[e];return r==="never"?!1:r==="always"?!0:r==="passwords"?t==="password":!0}function Ys(t){return js[t]}var Ee=class extends Error{constructor(e,r){super(e),this.stack=r}},vt=class extends Ee{constructor(e,r){super(e,r)}};var Ne=class extends vt{constructor(e,r){super(e??"Bitwarden CLI not found",r),this.name="InstalledCLINotFoundError",this.stack=r}},ot=class extends Ee{constructor(e,r){super(e??"Failed to load vault items",r),this.name="FailedToLoadVaultItemsError"}},br=class extends vt{constructor(e,r){super(e??"Vault is locked",r),this.name="VaultIsLockedError"}},Mt=class extends Ee{constructor(e,r){super(e??"Not logged in",r),this.name="NotLoggedInError"}},st=class extends vt{constructor(e,r){super(e??"Failed do download Bitwarden CLI",r),this.name="EnsureCliBinError"}},wr=class extends Ee{constructor(e,r){super(e??"Premium status is required to use this feature",r),this.name="PremiumFeatureError"}},Bt=class extends Ee{constructor(e,r){super(e??"This Send has a is protected by a password",r),this.name="SendNeedsPasswordError"}},zt=class extends Ee{constructor(e,r){super(e??"The password you entered is invalid",r),this.name="SendInvalidPasswordError"}};function it(t,e){try{return t()}catch{return e}}function mn(t){if(t instanceof vt)return t.message}var Sr=t=>{if(t){if(typeof t=="string")return t;if(t instanceof Error){let{message:e,name:r}=t;return t.stack?t.stack:`${r}: ${e}`}return String(t)}};function Er(t){return[t,null]}function De(t){return[null,t]}function Gt(t){if(typeof t=="function")try{return Er(t())}catch(e){return De(e)}return t.then(e=>Er(e)).catch(e=>De(e))}var ct=require("path"),Ct=require("fs/promises");var Ce=require("fs"),Ir=require("fs/promises"),ni=require("path"),oi=Z(ri());function Tr(t){return new Promise((e,r)=>{let n=setInterval(()=>{if(!(0,Ce.existsSync)(t))return;(0,Ce.statSync)(t).isFile()&&(clearInterval(n),e())},300);setTimeout(()=>{clearInterval(n),r(new Error(`File ${t} not found.`))},5e3)})}async function si(t,e){let r=new oi.default.async({file:t});(0,Ce.existsSync)(e)||(0,Ce.mkdirSync)(e,{recursive:!0}),await r.extract(null,e),await r.close()}async function ii(t,e){let r=!1;try{let n=await(0,Ir.readdir)(e);for await(let o of n)o.startsWith(t)&&await it(async()=>{await(0,Ir.unlink)((0,ni.join)(e,o)),r=!0})}catch{return!1}return r}function ai(...t){for(let e of t)it(()=>(0,Ce.unlinkSync)(e))}var At=require("fs"),di=Z(require("http")),hi=Z(require("https"));var vn=require("@raycast/api");var ci=require("@raycast/api"),au={logs:new Map,set:(t,e)=>{Tt.logs.set(new Date,{message:t,error:e})},clear:()=>Tt.logs.clear(),toString:()=>{let t="";return Tt.logs.forEach((e,r)=>{t.length>0&&(t+=`

`),t+=`[${r.toISOString()}] ${e.message}`,e.error&&(t+=`: ${Sr(e.error)}`)}),t}},Tt=Object.freeze(au),S=(t,e,r)=>{let{captureToRaycast:n=!1}=r??{},o=Array.isArray(t)?t.filter(Boolean).join(" "):t||"Captured exception";Tt.set(o,e),vn.environment.isDevelopment?console.error(o,e):n&&(0,ci.captureException)(e)},li=(...t)=>{vn.environment.isDevelopment&&console.debug(...t)};var ui=require("fs"),fi=require("crypto");function In(t){try{return(0,fi.createHash)("sha256").update((0,ui.readFileSync)(t)).digest("hex")}catch{return null}}function Tn(t,e,r){let{onProgress:n,sha256:o}=r??{};return new Promise((s,i)=>{let a=new URL(t),c=a.protocol==="https:"?hi.default:di.default,l=0,d=c.get(a.href,y=>{if(y.statusCode&&y.statusCode>=300&&y.statusCode<400){d.destroy(),y.destroy();let E=y.headers.location;if(!E){i(new Error("Redirect response without location header"));return}if(++l>=10){i(new Error("Too many redirects"));return}Tn(E,e,r).then(s).catch(i);return}if(y.statusCode!==200){i(new Error(`Response status ${y.statusCode}: ${y.statusMessage}`));return}let x=parseInt(y.headers["content-length"]||"0",10);if(x===0){i(new Error("Invalid file size"));return}let v=(0,At.createWriteStream)(e,{autoClose:!0}),I=0,A=()=>{d.destroy(),y.destroy(),v.close()},b=E=>{A(),i(E)};y.on("data",E=>{I+=E.length;let P=Math.floor(I/x*100);n?.(P)}),v.on("finish",async()=>{try{await Tr(e),o&&await cu(e,o),s()}catch(E){i(E)}finally{A()}}),v.on("error",E=>{S(`File stream error while downloading ${t}`,E),(0,At.unlink)(e,()=>b(E))}),y.on("error",E=>{S(`Response error while downloading ${t}`,E),(0,At.unlink)(e,()=>b(E))}),d.on("error",E=>{S(`Request error while downloading ${t}`,E),(0,At.unlink)(e,()=>b(E))}),y.pipe(v)})})}function cu(t,e){return new Promise((r,n)=>{let o=In(t);if(!o)return n(new Error(`Could not generate hash for file ${t}.`));if(o===e)return r();let s=setInterval(()=>{In(t)===e&&(clearInterval(s),r())},1e3);setTimeout(()=>{clearInterval(s),n(new Error(`Hash did not match, expected ${e.substring(0,7)}, got ${o.substring(0,7)}.`))},5e3)})}function pi(t,e){return{...t,...e,file:e.file?{...t.file,...e.file}:t.file,text:e.text?{...t.text,...e.text}:t.text}}var mi=require("@raycast/api"),oe=new mi.Cache({namespace:"bw-cache"});var X=process.platform==="darwin"?"macos":"windows";var{supportPath:at}=j.environment,lu="4",Ar=(()=>{let t=(0,ct.join)(at,`bw-bin-download-error-${lu}.log`);return{logError:e=>it(()=>(0,le.writeFileSync)(t,e?.message??"Unexpected error")),clearError:()=>it(()=>(0,le.unlinkSync)(t)),hasError:()=>it(()=>(0,le.existsSync)(t),!1)}})(),ce={version:"2025.2.0",get sha256(){return X==="windows"?"33a131017ac9c99d721e430a86e929383314d3f91c9f2fbf413d872565654c18":"fade51012a46011c016a2e5aee2f2e534c1ed078e49d1178a69e2889d2812a96"},downloadPage:"https://github.com/bitwarden/clients/releases",path:{get downloadedBin(){return(0,ct.join)(at,ce.binFilenameVersioned)},get installedBin(){return X==="windows"?"C:\\ProgramData\\chocolatey\\bin\\bw.exe":process.arch==="arm64"?"/opt/homebrew/bin/bw":"/usr/local/bin/bw"},get bin(){return Ar.hasError()?this.installedBin:this.downloadedBin}},get binFilename(){return X==="windows"?"bw.exe":"bw"},get binFilenameVersioned(){let t=`bw-${this.version}`;return X==="windows"?`${t}.exe`:`${t}`},get downloadUrl(){let t="";return X==="macos"&&(t=process.arch==="arm64"?"-arm64":""),`${this.downloadPage}/download/cli-v${this.version}/bw-${X}${t}-${this.version}.zip`}},Cr=class{constructor(e){this.actionListeners=new Map;this.preferences=(0,j.getPreferenceValues)();this.wasCliUpdated=!1;this.showToast=async e=>{if(this.toastInstance){let r={message:this.toastInstance.message,title:this.toastInstance.title,primaryAction:this.toastInstance.primaryAction,secondaryAction:this.toastInstance.secondaryAction};return e.style&&(this.toastInstance.style=e.style),this.toastInstance.message=e.message,this.toastInstance.title=e.title,this.toastInstance.primaryAction=e.primaryAction,this.toastInstance.secondaryAction=e.secondaryAction,await this.toastInstance.show(),Object.assign(this.toastInstance,{restore:async()=>{await this.showToast(r)}})}else{let r=await(0,j.showToast)(e);return Object.assign(r,{restore:()=>r.hide()})}};let{cliPath:r,clientId:n,clientSecret:o,serverCertsPath:s}=this.preferences,i=yr();this.toastInstance=e,this.cliPath=r||ce.path.bin,this.env={BITWARDENCLI_APPDATA_DIR:at,BW_CLIENTSECRET:o.trim(),BW_CLIENTID:n.trim(),PATH:(0,ct.dirname)(process.execPath),...i&&s?{NODE_EXTRA_CA_CERTS:s}:{}},this.initPromise=(async()=>{await this.ensureCliBinary(),this.retrieveAndCacheCliVersion(),await this.checkServerUrl(i)})()}async ensureCliBinary(){if(this.checkCliBinIsReady(this.cliPath))return;if(this.cliPath===this.preferences.cliPath||this.cliPath===ce.path.installedBin)throw new Ne(`Bitwarden CLI not found at ${this.cliPath}`);Ar.hasError()&&Ar.clearError();let e=await ii("bw-",at),r=await this.showToast({title:`${e?"Updating":"Initializing"} Bitwarden CLI`,style:j.Toast.Style.Animated,primaryAction:{title:"Open Download Page",onAction:()=>(0,j.open)(ce.downloadPage)}}),o=(0,ct.join)(at,"bw.zip");try{try{r.message="Downloading...",await Tn(ce.downloadUrl,o,{onProgress:s=>r.message=`Downloading ${s}%`,sha256:ce.sha256})}catch(s){throw r.title="Failed to download Bitwarden CLI",s}try{r.message="Extracting...",await si(o,at);let s=(0,ct.join)(at,ce.binFilename);await(0,Ct.rename)(s,this.cliPath).catch(()=>null),await Tr(this.cliPath),await(0,Ct.chmod)(this.cliPath,"755"),await(0,Ct.rm)(o,{force:!0}),oe.set(ae.CLI_VERSION,ce.version),this.wasCliUpdated=!0}catch(s){throw r.title="Failed to extract Bitwarden CLI",s}await r.hide()}catch(s){throw r.message=s instanceof st?s.message:"Please try again",r.style=j.Toast.Style.Failure,ai(o,this.cliPath),j.environment.isDevelopment||Ar.logError(s),s instanceof Error?new st(s.message,s.stack):s}finally{await r.restore()}}async retrieveAndCacheCliVersion(){try{let{error:e,result:r}=await this.getVersion();e||oe.set(ae.CLI_VERSION,r)}catch(e){S("Failed to retrieve and cache cli version",e,{captureToRaycast:!0})}}checkCliBinIsReady(e){try{return(0,le.existsSync)(this.cliPath)?((0,le.accessSync)(e,le.constants.X_OK),!0):!1}catch{return(0,le.chmodSync)(e,"755"),!0}}setSessionToken(e){this.env={...this.env,BW_SESSION:e}}clearSessionToken(){delete this.env.BW_SESSION}withSession(e){return this.tempSessionToken=e,this}async initialize(){return await this.initPromise,this}async checkServerUrl(e){let r=await j.LocalStorage.getItem(B.SERVER_URL);if(!e||r===e)return;let n=await this.showToast({style:j.Toast.Style.Animated,title:"Switching server...",message:"Bitwarden server preference changed"});try{try{await this.logout()}catch{}await this.exec(["config","server",e||uo],{resetVaultTimeout:!1}),await j.LocalStorage.setItem(B.SERVER_URL,e),n.style=j.Toast.Style.Success,n.title="Success",n.message="Bitwarden server changed"}catch(o){n.style=j.Toast.Style.Failure,n.title="Failed to switch server",o instanceof Error?n.message=o.message:n.message="Unknown error occurred"}finally{await n.restore()}}async exec(e,r){let{abortController:n,input:o="",resetVaultTimeout:s}=r??{},i=this.env;this.tempSessionToken&&(i={...i,BW_SESSION:this.tempSessionToken},this.tempSessionToken=void 0);let a=await zs(this.cliPath,e,{input:o,env:i,signal:n?.signal});if(this.isPromptWaitingForMasterPassword(a))throw await this.lock(),new br;return s&&await j.LocalStorage.setItem(B.LAST_ACTIVITY_TIME,new Date().toISOString()),a}async getVersion(){try{let{stdout:e}=await this.exec(["--version"],{resetVaultTimeout:!1});return{result:e}}catch(e){S("Failed to get cli version",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async login(){try{return await this.exec(["login","--apikey"],{resetVaultTimeout:!0}),await this.saveLastVaultStatus("login","unlocked"),await this.callActionListeners("login"),{result:void 0}}catch(e){S("Failed to login",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async logout(e){let{reason:r,immediate:n=!1}=e??{};try{return n&&await this.handlePostLogout(r),await this.exec(["logout"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("logout","unauthenticated"),n||await this.handlePostLogout(r),{result:void 0}}catch(o){S("Failed to logout",o);let{error:s}=await this.handleCommonErrors(o);if(!s)throw o;return{error:s}}}async lock(e){let{reason:r,checkVaultStatus:n=!1,immediate:o=!1}=e??{};try{if(o&&await this.callActionListeners("lock",r),n){let{error:s,result:i}=await this.status();if(s)throw s;if(i.status==="unauthenticated")return{error:new Mt("Not logged in")}}return await this.exec(["lock"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("lock","locked"),o||await this.callActionListeners("lock",r),{result:void 0}}catch(s){S("Failed to lock vault",s);let{error:i}=await this.handleCommonErrors(s);if(!i)throw s;return{error:i}}}async unlock(e){try{let{stdout:r}=await this.exec(["unlock",e,"--raw"],{resetVaultTimeout:!0});return this.setSessionToken(r),await this.saveLastVaultStatus("unlock","unlocked"),await this.callActionListeners("unlock",e,r),{result:r}}catch(r){S("Failed to unlock vault",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async sync(){try{return await this.exec(["sync"],{resetVaultTimeout:!0}),{result:void 0}}catch(e){S("Failed to sync vault",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async getItem(e){try{let{stdout:r}=await this.exec(["get","item",e],{resetVaultTimeout:!0});return{result:JSON.parse(r)}}catch(r){S("Failed to get item",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async listItems(){try{let{stdout:e}=await this.exec(["list","items"],{resetVaultTimeout:!0});return{result:JSON.parse(e).filter(n=>!!n.name)}}catch(e){S("Failed to list items",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createLoginItem(e){try{let{error:r,result:n}=await this.getTemplate("item");if(r)throw r;let{error:o,result:s}=await this.getTemplate("item.login");if(o)throw o;n.name=e.name,n.type=1,n.folderId=e.folderId||null,n.login=s,n.notes=null,s.username=e.username||null,s.password=e.password,s.totp=null,s.fido2Credentials=void 0,e.uri&&(s.uris=[{match:null,uri:e.uri}]);let{result:i,error:a}=await this.encode(JSON.stringify(n));if(a)throw a;let{stdout:c}=await this.exec(["create","item",i],{resetVaultTimeout:!0});return{result:JSON.parse(c)}}catch(r){S("Failed to create login item",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async listFolders(){try{let{stdout:e}=await this.exec(["list","folders"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){S("Failed to list folder",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createFolder(e){try{let{error:r,result:n}=await this.getTemplate("folder");if(r)throw r;n.name=e;let{result:o,error:s}=await this.encode(JSON.stringify(n));if(s)throw s;return await this.exec(["create","folder",o],{resetVaultTimeout:!0}),{result:void 0}}catch(r){S("Failed to create folder",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async getTotp(e){try{let{stdout:r}=await this.exec(["get","totp",e],{resetVaultTimeout:!0});return{result:r}}catch(r){S("Failed to get TOTP",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async status(){try{let{stdout:e}=await this.exec(["status"],{resetVaultTimeout:!1});return{result:JSON.parse(e)}}catch(e){S("Failed to get status",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async checkLockStatus(){try{return await this.exec(["unlock","--check"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("checkLockStatus","unlocked"),"unlocked"}catch(e){return S("Failed to check lock status",e),e.stderr==="Vault is locked."?(await this.saveLastVaultStatus("checkLockStatus","locked"),"locked"):(await this.saveLastVaultStatus("checkLockStatus","unauthenticated"),"unauthenticated")}}async getTemplate(e){try{let{stdout:r}=await this.exec(["get","template",e],{resetVaultTimeout:!0});return{result:JSON.parse(r)}}catch(r){S("Failed to get template",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async encode(e){try{let{stdout:r}=await this.exec(["encode"],{input:e,resetVaultTimeout:!1});return{result:r}}catch(r){S("Failed to encode",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async generatePassword(e,r){let n=e?Ws(e):[],{stdout:o}=await this.exec(["generate",...n],{abortController:r,resetVaultTimeout:!1});return o}async listSends(){try{let{stdout:e}=await this.exec(["send","list"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){S("Failed to list sends",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createSend(e){try{let{error:r,result:n}=await this.getTemplate(e.type===0?"send.text":"send.file");if(r)throw r;let o=pi(n,e),{result:s,error:i}=await this.encode(JSON.stringify(o));if(i)throw i;let{stdout:a}=await this.exec(["send","create",s],{resetVaultTimeout:!0});return{result:JSON.parse(a)}}catch(r){S("Failed to create send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async editSend(e){try{let{result:r,error:n}=await this.encode(JSON.stringify(e));if(n)throw n;let{stdout:o}=await this.exec(["send","edit",r],{resetVaultTimeout:!0});return{result:JSON.parse(o)}}catch(r){S("Failed to delete send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async deleteSend(e){try{return await this.exec(["send","delete",e],{resetVaultTimeout:!0}),{result:void 0}}catch(r){S("Failed to delete send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async removeSendPassword(e){try{return await this.exec(["send","remove-password",e],{resetVaultTimeout:!0}),{result:void 0}}catch(r){S("Failed to remove send password",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async receiveSendInfo(e,r){try{let{stdout:n,stderr:o}=await this.exec(["send","receive",e,"--obj"],{resetVaultTimeout:!0,input:r?.password});return!n&&/Invalid password/i.test(o)?{error:new zt}:!n&&/Send password/i.test(o)?{error:new Bt}:{result:JSON.parse(n)}}catch(n){let o=n.stderr;if(/Invalid password/gi.test(o))return{error:new zt};if(/Send password/gi.test(o))return{error:new Bt};S("Failed to receive send obj",n);let{error:s}=await this.handleCommonErrors(n);if(!s)throw n;return{error:s}}}async receiveSend(e,r){try{let{savePath:n,password:o}=r??{},s=["send","receive",e];n&&s.push("--output",n);let{stdout:i}=await this.exec(s,{resetVaultTimeout:!0,input:o});return{result:i}}catch(n){S("Failed to receive send",n);let{error:o}=await this.handleCommonErrors(n);if(!o)throw n;return{error:o}}}async saveLastVaultStatus(e,r){await j.LocalStorage.setItem(B.VAULT_LAST_STATUS,r)}async getLastSavedVaultStatus(){let e=await j.LocalStorage.getItem(B.VAULT_LAST_STATUS);return e||(await this.status()).result?.status}isPromptWaitingForMasterPassword(e){return!!(e.stderr&&e.stderr.includes("Master password"))}async handlePostLogout(e){this.clearSessionToken(),await this.callActionListeners("logout",e)}async handleCommonErrors(e){let r=e.stderr;return r?/not logged in/i.test(r)?(await this.handlePostLogout(),{error:new Mt("Not logged in")}):/Premium status/i.test(r)?{error:new wr}:{}:{}}setActionListener(e,r){let n=this.actionListeners.get(e);return n&&n.size>0?n.add(r):this.actionListeners.set(e,new Set([r])),this}removeActionListener(e,r){let n=this.actionListeners.get(e);return n&&n.size>0&&n.delete(r),this}async callActionListeners(e,...r){let n=this.actionListeners.get(e);if(n&&n.size>0)for(let o of n)try{await o?.(...r)}catch(s){S(`Error calling bitwarden action listener for ${e}`,s)}}};var gi=require("@raycast/api"),bi=require("react/jsx-runtime"),yi=()=>(0,bi.jsx)(gi.Form,{isLoading:!0});var Pr=require("react");function uu(t,e){let r=(0,Pr.useRef)(!1);(0,Pr.useEffect)(()=>{r.current||e!==void 0&&!e||(r.current=!0,t())},[e])}var Se=uu;var kr=require("react/jsx-runtime"),wi=(0,lt.createContext)(null),Ei=({children:t,loadingFallback:e=(0,kr.jsx)(yi,{})})=>{let[r,n]=(0,lt.useState)(),[o,s]=(0,lt.useState)();Se(()=>{new Cr().initialize().then(n).catch(i)});function i(a){if(a instanceof Ne)s(a);else throw a}return o?(0,kr.jsx)(Ht,{error:o}):r?(0,kr.jsx)(wi.Provider,{value:r,children:t}):e},de=()=>{let t=(0,lt.useContext)(wi);if(t==null)throw new Error("useBitwarden must be used within a BitwardenProvider");return t};function Si(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function xi(t,e){try{let r=t,n;return r?.stderr?n=r.stderr:t instanceof Error?n=`${t.name}: ${t.message}`:Si(t)?n=JSON.stringify(t):n=`${t}`,n?e?.omitSensitiveValue?fu(n,e.omitSensitiveValue):n:""}catch{return""}}function fu(t,e){return t.replace(new RegExp(e,"i"),"[REDACTED]")}var xe=require("@raycast/api"),Lr=require("react");function du(){let t=de(),[e,r]=(0,Lr.useState)(null);(0,Lr.useEffect)(()=>{t.status().then(({error:i,result:a})=>{i||r(a)}).catch(()=>{})},[]);let n=!!yr(),o="...",s="...";if(e){let{status:i,userEmail:a,serverUrl:c}=e;o=i=="unauthenticated"?"\u274C Logged out":`\u{1F512} Locked (${a})`,c?s=c||"":(!c&&n||c&&!n)&&(0,xe.confirmAlert)({icon:xe.Icon.ExclamationMark,title:"Restart Required",message:"Bitwarden server URL preference has been changed since the extension was opened.",primaryAction:{title:"Close Extension"},dismissAction:{title:"Close Raycast",style:xe.Alert.ActionStyle.Cancel}}).then(l=>{l?(0,xe.popToRoot)():(0,xe.closeMainWindow)()})}return{userMessage:o,serverMessage:s,shouldShowServer:n}}var vi=du;var Rr=require("@raycast/api");function Ii(t,e){let{data:r,revalidate:n,isLoading:o}=ir(()=>Rr.LocalStorage.getItem(t));return[r??e,{isLoading:o,set:async a=>{await Rr.LocalStorage.setItem(t,a),await n()},remove:async()=>{await Rr.LocalStorage.removeItem(t),await n()}}]}var K=require("react/jsx-runtime"),hu=({pendingAction:t=Promise.resolve()})=>{let e=de(),{userMessage:r,serverMessage:n,shouldShowServer:o}=vi(),[s,i]=(0,Wt.useState)(!1),[a,c]=(0,Wt.useState)(void 0),[l,d]=(0,Wt.useState)(!1),[y,x]=(0,Wt.useState)(""),[v,{remove:I}]=Ii(B.VAULT_LOCK_REASON);async function A(){if(y.length===0)return;let R=await(0,O.showToast)(O.Toast.Style.Animated,"Unlocking Vault...","Please wait");try{i(!0),c(void 0),await t;let{error:U,result:D}=await e.status();if(U)throw U;if(D.status==="unauthenticated")try{let{error:H}=await e.login();if(H)throw H}catch(H){let{displayableError:pe=`Please check your ${o?"Server URL, ":""}API Key and Secret.`,treatedError:Re}=Ti(H,y);await(0,O.showToast)(O.Toast.Style.Failure,"Failed to log in",pe),c(Re),S("Failed to log in",H);return}await e.unlock(y),await I(),await R.hide()}catch(U){let{displayableError:D="Please check your credentials",treatedError:H}=Ti(U,y);await(0,O.showToast)(O.Toast.Style.Failure,"Failed to unlock vault",D),c(H),S("Failed to unlock vault",U)}finally{i(!1)}}let b=async()=>{a&&(await O.Clipboard.copy(a),await(0,O.showToast)(O.Toast.Style.Success,"Error copied to clipboard"))},E=O.Form.PasswordField,P="password";return l&&(E=O.Form.TextField,P="plainPassword"),(0,K.jsxs)(O.Form,{actions:(0,K.jsxs)(O.ActionPanel,{children:[!s&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(O.Action.SubmitForm,{icon:O.Icon.LockUnlocked,title:"Unlock",onSubmit:A}),(0,K.jsx)(O.Action,{icon:l?O.Icon.EyeDisabled:O.Icon.Eye,title:l?"Hide Password":"Show Password",onAction:()=>d(R=>!R),shortcut:{macOS:{key:"e",modifiers:["opt"]},windows:{key:"e",modifiers:["alt"]}}})]}),!!a&&(0,K.jsx)(O.Action,{onAction:b,title:"Copy Last Error",icon:O.Icon.Bug,style:O.Action.Style.Destructive}),(0,K.jsx)(jt,{})]}),children:[o&&(0,K.jsx)(O.Form.Description,{title:"Server URL",text:n}),(0,K.jsx)(O.Form.Description,{title:"Vault Status",text:r}),(0,K.jsx)(E,{id:P,title:"Master Password",value:y,onChange:x,ref:R=>R?.focus()}),(0,K.jsx)(O.Form.Description,{title:"",text:`Press ${X==="macos"?"\u2325":"Alt"}+E to ${l?"hide":"show"} password`}),!!v&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(O.Form.Description,{title:"\u2139\uFE0F",text:v}),(0,K.jsx)(pu,{})]})]})};function pu(){let t=(0,O.getPreferenceValues)().repromptIgnoreDuration,e=Ys(t);return e?(0,K.jsx)(O.Form.Description,{title:"",text:`Timeout is set to ${e}, this can be configured in the extension settings`}):null}function Ti(t,e){let r=xi(t,{omitSensitiveValue:e}),n;return/Invalid master password/i.test(r)?n="Invalid master password":/Invalid API Key/i.test(r)&&(n="Invalid Client ID or Secret"),{displayableError:n,treatedError:r}}var Ai=hu;var Ci=require("@raycast/api"),ki=require("react/jsx-runtime"),Pi=()=>(0,ki.jsx)(Ci.List,{searchBarPlaceholder:"Search vault",isLoading:!0});var Li=require("react"),mu={token:void 0,passwordHash:void 0,isLoading:!0,isLocked:!1,isAuthenticated:!1},Ri=()=>(0,Li.useReducer)((t,e)=>{switch(e.type){case"loadState":{let{type:r,...n}=e;return{...t,...n}}case"lock":return{...t,token:void 0,passwordHash:void 0,isLoading:!1,isLocked:!0};case"unlock":return{...t,token:e.token,passwordHash:e.passwordHash,isLocked:!1,isAuthenticated:!0};case"logout":return{...t,token:void 0,passwordHash:void 0,isLocked:!0,isAuthenticated:!1,isLoading:!1};case"vaultTimeout":return{...t,isLocked:!0};case"finishLoadingSavedState":{if(!t.token||!t.passwordHash)throw new Error("Missing required fields: token, passwordHash");let r=!!t.token;return{...t,isLoading:!1,isLocked:!r,isAuthenticated:r}}case"failLoadingSavedState":return{...t,isLoading:!1,isLocked:!0};default:return t}},mu);var he=require("@raycast/api");var $i=require("child_process"),Oi=require("util");var gu=(0,Oi.promisify)($i.exec),Kt={getSavedSession:()=>Promise.all([he.LocalStorage.getItem(B.SESSION_TOKEN),he.LocalStorage.getItem(B.REPROMPT_HASH),he.LocalStorage.getItem(B.LAST_ACTIVITY_TIME),he.LocalStorage.getItem(B.VAULT_LAST_STATUS)]),clearSession:async()=>{await Promise.all([he.LocalStorage.removeItem(B.SESSION_TOKEN),he.LocalStorage.removeItem(B.REPROMPT_HASH)])},saveSession:async(t,e)=>{await Promise.all([he.LocalStorage.setItem(B.SESSION_TOKEN,t),he.LocalStorage.setItem(B.REPROMPT_HASH,e)])},logoutClearSession:async()=>{await Promise.all([he.LocalStorage.removeItem(B.SESSION_TOKEN),he.LocalStorage.removeItem(B.REPROMPT_HASH),he.LocalStorage.removeItem(B.LAST_ACTIVITY_TIME)])}},_i=t=>Ui(t,e=>Di(e,"handleUnlockResult")),Ni=t=>Ui(t,e=>Di(e,"sleep 0"));function Di(t,e){return gu(`log show --style syslog --predicate "process == 'loginwindow'" --info --last ${t}h | grep "${e}" | tail -n 1`)}async function Ui(t,e){let r=await Fi(e);return r?new Date(r).getTime()>t.getTime():!0}var yu=2,bu=5;async function Fi(t,e=1,r=0){try{if(r>bu){li("Max retry attempts reached to get last screen lock time");return}let{stdout:n,stderr:o}=await t(e),[s,i]=n?.split(" ")??[];if(o||!s||!i)return Fi(t,e+yu,r+1);let a=new Date(`${s}T${i}`);return!a||a.toString()==="Invalid Date"?void 0:a}catch(n){S("Failed to get last screen lock time",n);return}}var $r=require("react/jsx-runtime"),Vi=(0,ze.createContext)(null);function An(t){let{children:e,loadingFallback:r=(0,$r.jsx)(Pi,{}),unlock:n}=t,o=de(),[s,i]=Ri(),a=(0,ze.useRef)(Promise.resolve());Se(c,o);async function c(){try{o.setActionListener("lock",d).setActionListener("unlock",l).setActionListener("logout",y);let[b,E,P,R]=await Kt.getSavedSession();if(!b||!E)throw new Be;if(i({type:"loadState",token:b,passwordHash:E}),o.setSessionToken(b),o.wasCliUpdated)throw new Zt(et.CLI_UPDATED);if(R==="locked")throw new Be;if(R==="unauthenticated")throw new Zt;if(P){let U=new Date(P),D=+(0,Pt.getPreferenceValues)().repromptIgnoreDuration;if(X==="macos"&&D===ne.SYSTEM_LOCK){if(await _i(U))throw new Be(et.SYSTEM_LOCK)}else if(X==="macos"&&D===ne.SYSTEM_SLEEP){if(await Ni(U))throw new Be(et.SYSTEM_SLEEP)}else if(D!==ne.NEVER){let H=Date.now()-U.getTime();if(D===ne.IMMEDIATELY||H>=D)throw new Be(et.TIMEOUT)}}i({type:"finishLoadingSavedState"})}catch(b){b instanceof Be?a.current=o.lock({reason:b.message,immediate:!0,checkVaultStatus:!0}):b instanceof Zt?a.current=o.logout({reason:b.message,immediate:!0}):(a.current=o.lock({immediate:!0}),i({type:"failLoadingSavedState"}),S("Failed to bootstrap session state",b))}}async function l(b,E){let P=await pn(b);await Kt.saveSession(E,P),await Pt.LocalStorage.removeItem(B.VAULT_LOCK_REASON),i({type:"unlock",token:E,passwordHash:P})}async function d(b){await Kt.clearSession(),b&&await Pt.LocalStorage.setItem(B.VAULT_LOCK_REASON,b),i({type:"lock"})}async function y(b){await Kt.clearSession(),oe.clear(),b&&await Pt.LocalStorage.setItem(B.VAULT_LOCK_REASON,b),i({type:"logout"})}async function x(b){return await pn(b)===s.passwordHash}let v=(0,ze.useMemo)(()=>({token:s.token,isLoading:s.isLoading,isAuthenticated:s.isAuthenticated,isLocked:s.isLocked,active:!s.isLoading&&s.isAuthenticated&&!s.isLocked,confirmMasterPassword:x}),[s,x]);if(s.isLoading)return r;let I=s.isLocked||!s.isAuthenticated,A=s.token?e:null;return(0,$r.jsx)(Vi.Provider,{value:v,children:I&&n?(0,$r.jsx)(Ai,{pendingAction:a.current}):A})}function Or(){let t=(0,ze.useContext)(Vi);if(t==null)throw new Error("useSession must be used within a SessionProvider");return t}var Be=class extends Error{constructor(e){super(e)}},Zt=class extends Error{constructor(e){super(e)}};var Bi=require("react/jsx-runtime");function wu(t,e){let{description:r="Performing an action that requires the master password"}=e??{},n=Or(),{push:o,pop:s}=(0,kt.useNavigation)();async function i(a){if(!await n.confirmMasterPassword(a)){await(0,kt.showToast)(kt.Toast.Style.Failure,"Failed to unlock vault","Check your credentials");return}s(),setTimeout(t,1)}return()=>o((0,Bi.jsx)(lo,{description:r,onConfirm:i}))}var Mi=wu;var Gi=require("react/jsx-runtime");function Eu(t){let{repromptDescription:e,onAction:r,...n}=t,{reprompt:o}=_t(),s=Mi(r,{description:e});return(0,Gi.jsx)(zi.Action,{...n,onAction:o?s:r})}var Cn=Eu;var Q=require("@raycast/api");var Hi=require("child_process"),Wi=require("util");var Pn=require("fs"),ji=require("path");var Ki=require("react/jsx-runtime"),Su=(0,Wi.promisify)(Hi.exec),{supportPath:xu}=Q.environment,vu=()=>{let{clientId:t,clientSecret:e,fetchFavicons:r,generatePasswordQuickAction:n,repromptIgnoreDuration:o,serverCertsPath:s,serverUrl:i,shouldCacheVaultItems:a,transientCopyGeneratePassword:c,transientCopyGeneratePasswordQuick:l,transientCopySearch:d,windowActionOnCopy:y}=(0,Q.getPreferenceValues)();return{has_clientId:!!t,has_clientSecret:!!e,fetchFavicons:r,generatePasswordQuickAction:n,repromptIgnoreDuration:o,has_serverCertsPath:!!s,has_serverUrl:!!i,shouldCacheVaultItems:a,transientCopyGeneratePassword:c,transientCopyGeneratePasswordQuick:l,transientCopySearch:d,windowActionOnCopy:y}},se="N/A",Ge=async(t,e=!0)=>{try{let r=t;X==="windows"?r=`powershell -Command "${t}"`:r=`PATH="$PATH:${(0,ji.dirname)(process.execPath)}" ${t}`;let{stdout:n}=await Su(r,{env:{BITWARDENCLI_APPDATA_DIR:xu}}),o=n.trim();return e?o.replace(/\n|\r/g,""):o}catch(r){return S(`Failed to execute command: ${t}`,r),se}},Iu=()=>{try{let t=(0,Q.getPreferenceValues)().cliPath;return t?{type:"custom",path:t}:ce.path.bin===ce.path.downloadedBin?{type:"downloaded",path:ce.path.downloadedBin}:{type:"installed",path:ce.path.installedBin}}catch{return{type:se,path:se}}},Tu=async()=>{try{let t="/opt/homebrew/bin/brew";if((0,Pn.existsSync)(t)||(t="/usr/local/bin/brew"),!(0,Pn.existsSync)(t))return{arch:se,version:se};let e=await Ge(`${t} config`,!1);if(e===se)return{arch:se,version:se};let r=/HOMEBREW_PREFIX: (.+)/.exec(e)?.[1]||se,n=/HOMEBREW_VERSION: (.+)/.exec(e)?.[1]||se;return{arch:r!==se?r.includes("/opt/homebrew")?"arm64":"x86_64":se,version:n}}catch{return{arch:se,version:se}}};function Au(){let t=async()=>{let e=await(0,Q.showToast)(Q.Toast.Style.Animated,"Collecting data...");try{let r=vu(),n=Iu(),[o,s,i,a]=await Promise.all([...X==="macos"?[Ge("uname -m"),Ge("sw_vers -productVersion"),Ge("sw_vers -buildVersion")]:[Ge("(Get-CimInstance Win32_OperatingSystem).OSArchitecture"),Ge("(Get-CimInstance Win32_OperatingSystem).Caption"),Ge("(Get-CimInstance Win32_OperatingSystem).Version")],Ge(`${n.path} --version`)]),c={raycast:{version:Q.environment.raycastVersion},system:{arch:o,version:s,buildVersion:i},node:{arch:process.arch,version:process.version},cli:{type:n.type,version:a},preferences:r};if(X==="macos"){let l=await Tu();c.homebrew={arch:l.arch,version:l.version}}await Q.Clipboard.copy(JSON.stringify(c,null,2)),e.style=Q.Toast.Style.Success,e.title="Data copied to clipboard"}catch(r){e.style=Q.Toast.Style.Failure,e.title="Failed to collect bug report data",S("Failed to collect bug report data",r)}};return(0,Ki.jsx)(Q.Action,{title:"Collect Bug Report Data",icon:Q.Icon.Bug,onAction:t})}var Xt=Au;var Zi=require("@raycast/api"),Xi=require("react/jsx-runtime"),kn="https://github.com/raycast/extensions/issues/new?assignees=&labels=extension%2Cbug&template=extension_bug_report.yml&title=%5BBitwarden%5D+...";function Cu(){return(0,Xi.jsx)(Zi.Action.OpenInBrowser,{title:"Open Bug Report",url:kn})}var Yt=Cu;var te=require("@raycast/api");var Yi=require("react/jsx-runtime");function Pu(){return(0,Yi.jsx)(te.Action,{onAction:async()=>{let e=Tt.toString();if(e.length===0)return(0,te.showToast)(te.Toast.Style.Success,"No errors to copy");await te.Clipboard.copy(e),await(0,te.showToast)(te.Toast.Style.Success,"Errors copied to clipboard"),await(0,te.confirmAlert)({title:"Be careful with this information",message:"Please be mindful of where you share this error log, as it may contain sensitive information. Always analyze it before sharing.",primaryAction:{title:"Got it",style:te.Alert.ActionStyle.Default}})},title:"Copy Last Errors",icon:te.Icon.CopyClipboard,style:te.Action.Style.Regular})}var Ln=Pu;var Qi=require("@raycast/api");var qi=require("react");var ku=()=>{let t=oe.get(ae.CLI_VERSION);return t?parseFloat(t):-1},Ji=()=>{let[t,e]=(0,qi.useState)(ku);return Se(()=>{oe.subscribe((r,n)=>{n&&r===ae.CLI_VERSION&&e(parseFloat(n)||-1)})}),t};var Lt=require("react/jsx-runtime");function jt(){let t=Ji();return(0,Lt.jsxs)(Qi.ActionPanel.Section,{title:`Debugging & Bug Reporting (CLI v${t})`,children:[(0,Lt.jsx)(Ln,{}),(0,Lt.jsx)(Yt,{}),(0,Lt.jsx)(Xt,{})]})}var Y=require("@raycast/api");var ke=require("@raycast/api"),We=require("react");var Pe=require("react");var na=require("react/jsx-runtime"),$n=(0,Pe.createContext)(null),Lu=({children:t})=>{let e=(0,Pe.useRef)(new Map),r=s=>{s instanceof ot?e.current.forEach(i=>i(s)):e.current.forEach((i,a)=>{let c=s.find(l=>l.id===a);c&&i(c)})},n=(s,i)=>(e.current.set(s,i),()=>{e.current.delete(s)}),o=(0,Pe.useMemo)(()=>({listeners:e,publishItems:r,subscribeItem:n}),[]);return(0,na.jsx)($n.Provider,{value:o,children:t})},ea=()=>{let t=(0,Pe.useContext)($n);if(t==null)throw new Error("useVaultItemPublisher must be used within a VaultListenersProvider");return t.publishItems},ta=()=>{let t=(0,Pe.useContext)($n);if(t==null)throw new Error("useVaultItemSubscriber must be used within a VaultListenersProvider");return e=>{let r;return new Promise((n,o)=>{let s=t.subscribeItem(e,i=>{try{if(s(),i instanceof ot)throw i;n(i),clearTimeout(r)}catch(a){o(a)}});r=setTimeout(()=>{s(),o(new Rn)},15e3)})}},Rn=class extends Error{constructor(){super("Timed out waiting for item"),this.name="SubscriberTimeoutError"}},ra=Lu;var ua=require("@raycast/api");function oa(t){return t.map(e=>({object:e.object,id:e.id,organizationId:e.organizationId,folderId:e.folderId,type:e.type,name:e.name,revisionDate:e.revisionDate,creationDate:e.creationDate,deletedDate:e.deletedDate,favorite:e.favorite,reprompt:e.reprompt,collectionIds:e.collectionIds,secureNote:e.secureNote?{type:e.secureNote.type}:void 0,fields:Ru(e.fields),login:$u(e.login),identity:Ou(e.identity),card:_u(e.card),passwordHistory:Nu(e.passwordHistory),notes:N(e.notes),sshKey:Du(e.sshKey)}))}function sa(t){return t.map(e=>({object:e.object,id:e.id,name:e.name}))}function Ru(t){return t?.map(e=>({name:e.name,value:N(e.value),type:e.type,linkedId:e.linkedId}))}function $u(t){if(t)return{username:t.username,uris:t.uris,password:N(t.password),passwordRevisionDate:N(t.passwordRevisionDate),totp:N(t.totp)}}function Ou(t){if(t)return{title:N(t.title),firstName:N(t.firstName),middleName:N(t.middleName),lastName:N(t.lastName),address1:N(t.address1),address2:N(t.address2),address3:N(t.address3),city:N(t.city),state:N(t.state),postalCode:N(t.postalCode),country:N(t.country),company:N(t.company),email:N(t.email),phone:N(t.phone),ssn:N(t.ssn),username:N(t.username),passportNumber:N(t.passportNumber),licenseNumber:N(t.licenseNumber)}}function _u(t){if(t)return{brand:t.brand,cardholderName:N(t.cardholderName),number:N(t.number),expMonth:N(t.expMonth),expYear:N(t.expYear),code:N(t.code)}}function Nu(t){return t?.map(e=>({password:N(e.password),lastUsedDate:N(e.lastUsedDate)}))}function Du(t){if(t)return{publicKey:t.publicKey,keyFingerprint:t.keyFingerprint,privateKey:N(t.privateKey)}}function N(t){return t&&Qe}var aa=require("@raycast/api"),He=require("crypto"),ca=require("react"),ia="aes-256-cbc";function la(){let{clientSecret:t}=(0,aa.getPreferenceValues)(),e=(0,ca.useMemo)(()=>Uu(t.trim()),[t]);return{encrypt:o=>{let s=(0,He.randomBytes)(16),i=(0,He.createCipheriv)(ia,e,s),a=Buffer.concat([i.update(o),i.final()]);return{iv:s.toString("hex"),content:a.toString("hex")}},decrypt:(o,s)=>{let i=(0,He.createDecipheriv)(ia,e,Buffer.from(s,"hex"));return Buffer.concat([i.update(Buffer.from(o,"hex")),i.final()]).toString()}}}function Uu(t){return Buffer.from((0,He.createHash)("sha256").update(t).digest("base64").slice(0,32))}function Fu(){let{encrypt:t,decrypt:e}=la(),r=(0,ua.getPreferenceValues)().shouldCacheVaultItems;return Se(()=>{oe.isEmpty||oe.clear()},!r),{getCachedVault:()=>{try{if(!r)throw new ut;let s=oe.get(ae.IV),i=oe.get(ae.VAULT);if(!s||!i)throw new ut;let a=e(i,s);return JSON.parse(a)}catch(s){return s instanceof ut||S("Failed to decrypt cached vault",s),{items:[],folders:[]}}},cacheVault:(s,i)=>{try{if(!r)throw new ut;let a=JSON.stringify({items:oa(s),folders:sa(i)}),c=t(a);oe.set(ae.VAULT,c.content),oe.set(ae.IV,c.iv)}catch(a){a instanceof ut||S("Failed to cache vault",a)}}}}var ut=class extends Error{},fa=Fu;var pa=require("react/jsx-runtime"),da=(0,We.createContext)(null);function Vu(){return{items:[],folders:[],isLoading:!0}}var{syncOnLaunch:Mu}=(0,ke.getPreferenceValues)();function ha(t){let{children:e}=t,r=Or(),n=de(),o=ea(),{getCachedVault:s,cacheVault:i}=fa(),[a,c]=io(ae.CURRENT_FOLDER_ID,null),[l,d]=(0,We.useReducer)((b,E)=>({...b,...E}),{...Vu(),...s()});Se(()=>{Mu?x({isInitial:!0}):y()},r.active&&r.token);async function y(){try{d({isLoading:!0});let b=[],E=[];try{let[P,R]=await Promise.all([n.listItems(),n.listFolders()]);if(P.error)throw P.error;if(R.error)throw R.error;b=P.result,E=R.result,b.sort(zu)}catch(P){throw o(new ot),P}d({items:b,folders:E}),o(b),i(b,E)}catch(b){await(0,ke.showToast)(ke.Toast.Style.Failure,"Failed to load vault items",mn(b)),S("Failed to load vault items",b)}finally{d({isLoading:!1})}}async function x(b){let{isInitial:E=!1}=b??{},P=await(0,ke.showToast)({title:"Syncing Vault...",message:E?"Background Task":void 0,style:ke.Toast.Style.Animated});try{await n.sync(),await y(),await P.hide()}catch(R){await n.logout(),P.style=ke.Toast.Style.Failure,P.title="Failed to sync vault",P.message=mn(R)}}function v(b){c(typeof b=="string"?b:b?.id)}function I(b){let E=typeof b=="function"?b(l):b;d(E),i(E.items,E.folders)}let A=(0,We.useMemo)(()=>({...l,items:Bu(l.items,a),isEmpty:l.items.length==0,isLoading:l.isLoading||r.isLoading,currentFolderId:a,syncItems:x,loadItems:y,setCurrentFolder:v,updateState:I}),[l,r.isLoading,a,x,y,v,I]);return(0,pa.jsx)(da.Provider,{value:A,children:e})}function Bu(t,e){return!e||e===tt.ALL?t:e===tt.NO_FOLDER?t.filter(r=>r.folderId===null):t.filter(r=>r.folderId===e)}function zu(t,e){return t.favorite&&e.favorite?0:t.favorite?-1:1}var Rt=()=>{let t=(0,We.useContext)(da);if(t==null)throw new Error("useVault must be used within a VaultProvider");return t};var $t=require("react/jsx-runtime");function On(){let t=Rt(),e=de(),r=async()=>{let o=await(0,Y.showToast)(Y.Toast.Style.Animated,"Locking Vault...","Please wait");await e.lock({reason:et.MANUAL}),await o.hide()},n=async()=>{let o=await(0,Y.showToast)({title:"Logging Out...",style:Y.Toast.Style.Animated});try{await e.logout(),await o.hide()}catch{o.title="Failed to logout",o.style=Y.Toast.Style.Failure}};return(0,$t.jsxs)(Y.ActionPanel.Section,{title:"Vault Actions",children:[(0,$t.jsx)(Y.Action,{title:"Sync Vault",shortcut:{macOS:{key:"r",modifiers:["opt"]},windows:{key:"r",modifiers:["alt"]}},icon:Y.Icon.ArrowClockwise,onAction:t.syncItems}),(0,$t.jsx)(Y.Action,{icon:{source:"sf_symbols_lock.svg",tintColor:Y.Color.PrimaryText},title:"Lock Vault",shortcut:{macOS:{key:"l",modifiers:["opt","shift"]},windows:{key:"l",modifiers:["alt","shift"]}},onAction:r}),(0,$t.jsx)(Y.Action,{style:Y.Action.Style.Destructive,title:"Logout",icon:Y.Icon.Logout,onAction:n})]})}var je=require("react/jsx-runtime"),Gu=`

`,_n="https://bitwarden.com/help/cli/#download-and-install",Hu=t=>`\`\`\`
${t}
\`\`\``,Wu=({error:t})=>{let e=Sr(t),r=(0,ge.getPreferenceValues)().cliPath,n=t instanceof st,o=r||t instanceof Ne,s=[];if(o&&!n?s.push("# \u26A0\uFE0F Bitwarden CLI not found"):s.push("# \u{1F4A5} Whoops! Something went wrong"),n)s.push(`We couldn't download the [Bitwarden CLI](${_n}), you can always install it on your machine.`);else if(o){let i=r?` (${r})`:"";s.push(`We couldn't find the [Bitwarden CLI](${_n}) installed on your machine${i}.`)}else s.push(`The \`${ge.environment.commandName}\` command crashed when we were not expecting it to.`);if(s.push("> Please read the `Setup` section in the [extension's description](https://www.raycast.com/jomifepe/bitwarden) to ensure that everything is properly configured."),s.push(`**Try restarting the command. If the issue persists, consider [reporting a bug on GitHub](${kn}) to help us fix it.**`),e){let i=/incompatible architecture/gi.test(e);s.push(">## Technical details \u{1F913}",i&&`\u26A0\uFE0F We suspect that your Bitwarden CLI was installed using a version of NodeJS that's incompatible with your system architecture (e.g. x64 NodeJS on a M1/Apple Silicon Mac). Please make sure your have the correct versions of your software installed (e.g., ${X==="macos"?"Homebrew, ":""}NodeJS, and Bitwarden CLI).`,Hu(e))}return(0,je.jsx)(ge.Detail,{markdown:s.filter(Boolean).join(Gu),actions:(0,je.jsxs)(ge.ActionPanel,{children:[(0,je.jsxs)(ge.ActionPanel.Section,{title:"Bug Report",children:[(0,je.jsx)(Yt,{}),(0,je.jsx)(Xt,{})]}),o&&(0,je.jsx)(ge.Action.OpenInBrowser,{title:"Open Installation Guide",url:_n})]})})},Ht=Wu;var Nn=require("react/jsx-runtime"),qt=class extends ma.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}async componentDidCatch(e,r){e instanceof Ee?(this.setState(n=>({...n,hasError:!0,error:e.message})),await(0,Ot.showToast)(Ot.Toast.Style.Failure,e.message)):(Ot.environment.isDevelopment&&this.setState(n=>({...n,hasError:!0,error:e.message})),console.error("Error:",e,r))}render(){try{return this.state.hasError?(0,Nn.jsx)(Ht,{error:this.state.error}):this.props.children}catch{return(0,Nn.jsx)(Ht,{})}}};var Dr=require("@raycast/api"),nc=require("react");var Ng=Object.keys(Ks);var Le="https://vault.bitwarden.com/images",ju={[we.VISA]:`${Le}/visa-light.png`,[we.MASTERCARD]:`${Le}/mastercard-light.png`,[we.AMEX]:`${Le}/amex-light.png`,[we.DISCOVER]:`${Le}/discover-light.png`,[we.DINERS_CLUB]:`${Le}/diners_club-light.png`,[we.JCB]:`${Le}/jcb-light.png`,[we.MAESTRO]:`${Le}/maestro-light.png`,[we.UNION_PAY]:`${Le}/union_pay-light.png`,[we.RU_PAY]:`${Le}/ru_pay-light.png`};function ga(t){return ju[t]}var Qa=require("@raycast/api");var ja=Z(za(),1),Af=t=>t.normalize("NFKD").split(""),Ga=/^\s+$/,Ha=/^[`~!@#$%^&*()\-=_+{}[\]\|\\;':",./<>?]+$/,Zn={insertOrder:"insertOrder",bestMatch:"bestMatch"},Cf={keySelector:t=>t,threshold:.6,ignoreCase:!0,ignoreSymbols:!0,normalizeWhitespace:!0,returnMatchData:!1,useDamerau:!0,useSellers:!0,useSeparatedUnicode:!1,sortBy:Zn.bestMatch},Pf=()=>{},kf=t=>t instanceof Array?t:[t];function Ka(t,e){let r=e.ignoreCase?t.toLocaleLowerCase():t,n=[],o=[],s=!0,i=0,a=e.useSeparatedUnicode?Af(r):(0,ja.default)(r);for(let c of a)Ga.lastIndex=0,Ha.lastIndex=0,e.normalizeWhitespace&&Ga.test(c)?s||(n.push(" "),o.push(i),s=!0):e.ignoreSymbols&&Ha.test(c)||(e.useSeparatedUnicode?n.push(c):n.push(c.normalize()),o.push(i),s=!1),i+=c.length;for(o.push(t.length);n[n.length-1]===" ";)n.pop(),o.pop();return{original:t,normal:n,map:o}}function Lf(t,e){return{index:e[t.start],length:e[t.end+1]-e[t.start]}}function Za(t,e){if(e===0)return{index:0,length:0};let r=e;for(let n=t.length-2;n>0&&r>1;n--){let o=t[n];r=o[r]<o[r-1]?r:r-1}return{start:r-1,end:e-1}}function Rf(){return{start:0,end:0}}var $f=()=>!0,Of=(t,e)=>t<e;function _f(t,e){let r=new Array(t);for(let n=0;n<t;n++)r[n]=new Array(e),r[n][0]=n;for(let n=0;n<e;n++)r[0][n]=n;return r}function Nf(t,e){let r=new Array(t);r[0]=new Array(e).fill(0);for(let n=1;n<t;n++)r[n]=new Array(e),r[n][0]=n;return r}function Xa(t,e,r,n,o){let s=r[n],i=r[n+1],a=t[n]===e[o]?0:1,c,l=i[o]+1;(c=s[o+1]+1)<l&&(l=c),(c=s[o]+a)<l&&(l=c),i[o+1]=l}function Ya(t,e,r,n){for(let o=0;o<t.length;o++)Xa(t,e,r,o,n)}function Df(t,e,r,n){if(n===0){Ya(t,e,r,n);return}t.length>0&&Xa(t,e,r,0,n);for(let o=1;o<t.length;o++){let s=r[o-1],i=r[o],a=r[o+1],c=t[o]===e[n]?0:1,l,d=a[n]+1;(l=i[n+1]+1)<d&&(d=l),(l=i[n]+c)<d&&(d=l),t[o]===e[n-1]&&t[o-1]===e[n]&&(l=s[n-1]+c)<d&&(d=l),a[n+1]=d}}function Uf(t,e,r){let n=t;for(let o=0;o<e.length;o++){let s=e[o];n.children[s]==null&&(n.children[s]={children:{},candidates:[],depth:0}),n.depth=Math.max(n.depth,e.length-o),n=n.children[s]}n.candidates.push(r)}function Wa(t,e,r,n){for(let o of r){let s=kf(n.keySelector(o)).map((i,a)=>({index:e,keyIndex:a,item:o,normalized:Ka(i,n)}));e++;for(let i of s)Uf(t,i.normalized.normal,i)}}function Ff(t,e){let r=e.score-t.score;if(r!==0)return r;let n=t.match.start-e.match.start;if(n!==0)return n;let o=t.keyIndex-e.keyIndex;if(o!==0)return o;let s=t.lengthDiff-e.lengthDiff;return s!==0?s:qa(t,e)}function qa(t,e){return t.index-e.index}function Vf(t){switch(t){case Zn.bestMatch:return Ff;case Zn.insertOrder:return qa;default:throw new Error(`unknown sortBy method ${t}`)}}function Ja(t,e,r,n,o,s,i){let a={item:r.item,normalized:r.normalized,score:n,match:o,index:r.index,keyIndex:r.keyIndex,lengthDiff:s};e[r.index]==null?(e[r.index]=t.length,t.push(a)):i(a,t[e[r.index]])<0&&(t[e[r.index]]=a)}var Mf=Math.max,Bf=t=>t;function zf(t,e,r,n,o){let s=e+o,i=Math.min(r.length,e+t.depth+1),a=Math.ceil((s+i)/2);return 1-(a-i)/a>=n}function Gf(t,e,r,n,o,s){return 1-Math.min(o,s-(t.depth+1))/r.length>=n}function Hf(t,e,r,n,o,s,i){let a=[];for(let l in t.children){let d=t.children[l];a.push([d,1,l,0,e.length])}let c=new Array(t.depth);for(;a.length!==0;){let[l,d,y,x,v]=a.pop();c[d-1]=y,r.score(e,c,n,d-1);let I=d,A=n[n.length-1][I],b=x,E=v;if(r.shouldUpdateScore(A,v)&&(b=I,E=A),l.candidates.length>0){let P=r.getLength(e.length,d),R=1-E/P;if(R>=i.threshold){let U=Za(n,b),D=Math.abs(d-e.length);for(let H of l.candidates)Ja(o,s,H,R,U,D,r.compareItems)}}for(let P in l.children){let R=l.children[P];r.shouldContinue(R,d,e,i.threshold,E,A)&&a.push([R,d+1,P,b,E])}}}function Wf(t,e,r){let n=r.useSellers?Nf:_f,o={score:r.useDamerau?Df:Ya,getLength:r.useSellers?Bf:Mf,shouldUpdateScore:r.useSellers?Of:$f,shouldContinue:r.useSellers?Gf:zf,walkBack:r.useSellers?Za:Rf,compareItems:Vf(r.sortBy)},s={},i=[],a=n(t.length+1,e.depth+1);if(r.threshold<=0||t.length===0)for(let l of e.candidates)Ja(i,s,l,0,{index:0,length:0},t.length,o.compareItems);Hf(e,t,o,a,i,s,r);let c=i.sort(o.compareItems);if(r.returnMatchData){let l=r.useSellers?Lf:Pf;return c.map(d=>({item:d.item,original:d.normalized.original,key:d.normalized.normal.join(""),score:d.score,match:l(d.match,d.normalized.map)}))}return c.map(l=>l.item)}var Nr=class{constructor(e,r){this.options=Object.assign({},Cf,r),this.trie={children:{},candidates:[],depth:0},Wa(this.trie,0,e,this.options),this.count=e.length}add(...e){Wa(this.trie,this.count,e,this.options),this.count+=e.length}search(e,r){return r=Object.assign({},this.options,r),Wf(Ka(e,this.options).normal,this.trie,r)}};var Qt=require("react"),ec=require("url");function tc(t){try{return`https://icons.bitwarden.net/${new ec.URL(t).hostname}/icon.png`}catch{return Qa.Icon.Globe}}function rc(t){let[e,r]=(0,Qt.useState)(""),n=(0,Qt.useMemo)(()=>new Nr(t,{ignoreSymbols:!1,threshold:.7,keySelector:s=>{let{login:i,card:a}=s;return[s.name,Zs[s.type],i?.username,i?.uris?.map(({uri:c})=>c),a?.brand,a?.number].flat().filter(c=>!!c)}}),[t]),o=(0,Qt.useMemo)(()=>e?n.search(e):t,[n,e]);return{setSearchText:r,filteredItems:o}}var{fetchFavicons:jf}=(0,Dr.getPreferenceValues)(),Kf={1:t=>{let e=t.login?.uris?.[0]?.uri;return jf&&e?tc(e):gt[1]},3:t=>{let{brand:e}=t.card??{};if(e){let r=ga(e);if(r)return r}return gt[3]},4:()=>gt[4],2:()=>gt[2],5:()=>gt[5]};function oc(t){return(0,nc.useMemo)(()=>{let e=Kf[t.type]?.(t);return e||Dr.Icon.QuestionMark},[t.type,t.card?.brand,t.login?.uris?.[0]?.uri])}var Ur=require("@raycast/api");function Zf(){let t=de(),e=ta();async function r(o){let s=await t.getItem(o);if(s.error)throw s.error;return s.result}async function n(o,s=(a=>a),i){let a=s(o);if(!Xf(a))return a;let c=i?await(0,Ur.showToast)(Ur.Toast.Style.Animated,i):void 0,l=s(await Promise.race([e(o.id),r(o.id)]));return await c?.hide(),l}return n}function Xf(t){try{return typeof t=="object"?JSON.stringify(t).includes(Qe):typeof t=="string"?t===Qe:!1}catch{return!1}}var sc=Zf;var ye=require("@raycast/api");var ic=(t,e=!1)=>{let r=t.charAt(0).toUpperCase(),n=e?t.slice(1).toLowerCase():t.slice(1);return r+n};async function ac(t,e){let r=(0,ye.getPreferenceValues)().windowActionOnCopy,n=ic(t,!0);r==="keepOpen"?await(0,ye.showToast)({title:n,message:e,style:ye.Toast.Style.Success}):r==="closeAndPopToRoot"?(await(0,ye.showHUD)(n),await(0,ye.popToRoot)()):await(0,ye.showHUD)(n)}var cc=require("@raycast/api"),Fr=require("react");function Xn(){let[t,e]=(0,Fr.useState)(void 0);return(0,Fr.useEffect)(()=>{(0,cc.getFrontmostApplication)().then(r=>e(r.name)).catch(()=>e(void 0))},[]),t}var dt=require("@raycast/api");var er=require("react/jsx-runtime");function Yn(){let{folders:t,currentFolderId:e,setCurrentFolder:r}=Rt();return t.length===0?null:(0,er.jsxs)(dt.List.Dropdown,{tooltip:"Select a folder",placeholder:"Search folders",defaultValue:e??tt.ALL,onChange:r,throttle:!0,children:[(0,er.jsx)(dt.List.Dropdown.Item,{value:tt.ALL,title:"All",icon:dt.Icon.Folder}),t.map(n=>{let o=n.id||tt.NO_FOLDER;return(0,er.jsx)(dt.List.Dropdown.Item,{value:o,title:n.name,icon:dt.Icon.Folder},o)})]})}var lc=require("react"),Vr=require("react/jsx-runtime"),Yf=t=>{let e=lc.Children.toArray(t.children);return t.reverse&&e.reverse(),(0,Vr.jsx)(Vr.Fragment,{children:e})},uc=Yf;var Mr=require("react");function fc(t,e){let[r,n]=(0,Mr.useState)(t);return(0,Mr.useEffect)(()=>{n(t)},e),[r,n]}var k=require("react/jsx-runtime"),qf=()=>(0,k.jsx)(qt,{children:(0,k.jsx)(Ei,{loadingFallback:(0,k.jsx)(L.List,{searchBarPlaceholder:"Search items",isLoading:!0}),children:(0,k.jsx)(An,{unlock:!0,children:(0,k.jsx)(ra,{children:(0,k.jsx)(ha,{children:(0,k.jsx)(Jf,{})})})})})});function Jf(){let t=Rt(),{data:e,isLoading:r}=rd(),n=t.items.filter(l=>l.login?.totp),{setSearchText:o,filteredItems:s}=rc(n),i=(0,Ke.useMemo)(()=>e?s.reduce((l,d)=>(d.login?.uris?.some(({uri:x})=>x?.includes(e.url.hostname))?l.tabItems.push(d):l.items.push(d),l),{items:[],tabItems:[]}):{items:s,tabItems:[]},[s,e]),a=i.items.length===0&&i.tabItems.length===0,c=i.items.map(l=>(0,k.jsx)(dc,{item:l},l.id));return(0,k.jsxs)(L.List,{filtering:!1,onSearchTextChange:o,searchBarPlaceholder:"Search items",isLoading:t.isLoading||r,searchBarAccessory:(0,k.jsx)(Yn,{}),actions:(0,k.jsx)(L.ActionPanel,{children:(0,k.jsx)(pc,{})}),children:[e&&i.tabItems.length>0?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(L.List.Section,{title:`Active Tab (${e.url.hostname})`,children:i.tabItems.map(l=>(0,k.jsx)(dc,{item:l},l.id))}),(0,k.jsx)(L.List.Section,{title:"Others",children:c})]}):c,(0,k.jsx)(L.List.EmptyView,{icon:{source:"bitwarden-64.png"},title:a?"No authenticator keys found":"No matching items found",description:"Hit the sync button to sync your vault"})]})}function dc({item:t}){let e=oc(t),r=(0,L.getPreferenceValues)(),[n,o]=(0,Ke.useState)(!t.reprompt),{code:s,time:i,error:a,isLoading:c}=Br.useCode(t,n);function l(){if(!n)return[{text:{value:"Needs confirmation",color:L.Color.Yellow},tooltip:"Needs master password confirmation"}];if(!c){if(a)return[{text:{value:a.message,color:L.Color.Red}}];if(s&&i)return[{text:s},{tag:{value:String(i),color:i<=7?L.Color.Red:L.Color.Blue},tooltip:`${i} seconds remaining`}]}return[{text:"Loading..."}]}return(0,k.jsx)(co.Provider,{value:t,children:(0,k.jsx)(L.List.Item,{title:t.name,subtitle:t.login?.username??void 0,icon:e,actions:(0,k.jsxs)(L.ActionPanel,{children:[n?(0,k.jsxs)(uc,{reverse:r.primaryAction==="paste",children:[(0,k.jsx)(ed,{}),(0,k.jsx)(td,{})]}):(0,k.jsx)(Qf,{onConfirm:()=>o(!0)}),(0,k.jsx)(pc,{})]}),accessories:l()})})}function pc(){return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(On,{}),(0,k.jsx)(jt,{})]})}function Qf({onConfirm:t}){let e=_t();return(0,k.jsx)(Cn,{title:"Confirm Password",onAction:t,icon:L.Icon.Lock,repromptDescription:`Generating an authentication code for <${e.name}>`})}function ed(){let t=mc("copy");return(0,k.jsx)(L.Action,{title:"Copy Code",onAction:async()=>{let r=await t();r&&(await L.Clipboard.copy(r,{transient:Xs("other")}),await ac("Copied code to clipboard"))},icon:L.Icon.Clipboard})}function td(){let t=Xn(),e=mc("paste"),r=async()=>{let n=await e();n&&await L.Clipboard.paste(n)};return(0,k.jsx)(L.Action,{title:t?`Paste Code into ${t}`:"Paste Code",onAction:r,icon:L.Icon.Window})}function mc(t){let e=_t(),r=sc();return async()=>{try{let n=await r(e,i=>i.login?.totp,"Getting code...");if(!n)throw new Error("Failed to get totp");let[o,s]=Br.getGenerator(n);if(s)throw s;return o.generate()}catch(n){await(0,L.showToast)(L.Toast.Style.Failure,"Failed to get code"),S(`Failed to ${t} code`,n);return}}}function rd(){return ir(async()=>{if(!L.environment.canAccess(L.BrowserExtension))return;let[t,e]=await Gt(L.BrowserExtension.getTabs());if(e)return;let r=t.find(n=>n.active);return r?{...r,url:new URL(r.url)}:void 0})}var Br={parseTotp(t){if(t.includes("otpauth")){let[e,r]=Gt(()=>nr.parse(t));if(r)throw r;if(!(e instanceof Ye))throw new Error("Invalid authenticator key");return{algorithm:e.algorithm,secret:e.secret.base32.toString(),period:e.period,digits:e.digits}}return{secret:t,period:30,algorithm:"SHA1",digits:6}},getGenerator(t){let[e,r]=Gt(()=>Br.parseTotp(t));if(r)return S("Failed to parse key",r),De(new Error("Failed to parse authenticator key"));let[n,o]=Gt(()=>new Ye(e));return o?(S("Failed to initialize authenticator",o),De(new Error("Failed to initialize authenticator"))):Er(n)},useCode(t,e=!0){let[[r,n,o=!1],s]=fc(()=>{let{totp:d}=t.login??{};return e?d===Qe?hc(new Error("Loading...")):d?Br.getGenerator(d):De(new Error("No TOTP found")):hc(new Error("Needs confirmation..."))},[t,e]),[i,a]=(0,Ke.useState)(null),[c,l]=(0,Ke.useState)(null);return(0,Ke.useEffect)(()=>{if(n)return;let d,y,x=()=>{clearTimeout(y),clearInterval(d)},v=()=>{try{let I=Math.ceil(r.remaining()/1e3);l(I),I===r.period&&a(r.generate())}catch(I){s(De(new Error("Failed to regenerate"))),x(),S("Failed to regenerate",I)}};try{y=setTimeout(()=>{v(),d=setInterval(v,1e3)},r.remaining()%1e3),a(r.generate())}catch(I){s(De(new Error("Failed to generate"))),x(),S("Failed to generate",I)}return x},[t,r]),{code:i,time:c,error:n,isLoading:o}}};function hc(t){return[null,t,!0]}var nd=qf;
/*! Bundled license information:

node-stream-zip/node_stream_zip.js:
  (**
   * @license node-stream-zip | (c) 2020 Antelle | https://github.com/antelle/node-stream-zip/blob/master/LICENSE
   * Portions copyright https://github.com/cthackers/adm-zip | https://raw.githubusercontent.com/cthackers/adm-zip/master/LICENSE
   *)

otpauth/dist/otpauth.node.mjs:
  (*! otpauth 9.4.0 | (c) Hctor Molinero Fernndez | MIT | https://github.com/hectorm/otpauth *)
*/
