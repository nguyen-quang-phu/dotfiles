"use strict";var ci=Object.create;var Pt=Object.defineProperty;var li=Object.getOwnPropertyDescriptor;var ui=Object.getOwnPropertyNames;var di=Object.getPrototypeOf,fi=Object.prototype.hasOwnProperty;var H=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),mi=(t,e)=>{for(var r in e)Pt(t,r,{get:e[r],enumerable:!0})},sn=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ui(e))!fi.call(t,o)&&o!==r&&Pt(t,o,{get:()=>e[o],enumerable:!(n=li(e,o))||n.enumerable});return t};var Y=(t,e,r)=>(r=t!=null?ci(di(t)):{},sn(e||!t||!t.__esModule?Pt(r,"default",{value:t,enumerable:!0}):r,t)),pi=t=>sn(Pt({},"__esModule",{value:!0}),t);var Sn=H((Hc,wn)=>{wn.exports=yn;yn.sync=xi;var hn=require("fs");function Ei(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&t.substr(-o.length).toLowerCase()===o)return!0}return!1}function gn(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:Ei(e,r)}function yn(t,e,r){hn.stat(t,function(n,o){r(n,n?!1:gn(o,t,e))})}function xi(t,e){return gn(hn.statSync(t),t,e)}});var In=H((jc,vn)=>{vn.exports=En;En.sync=vi;var bn=require("fs");function En(t,e,r){bn.stat(t,function(n,o){r(n,n?!1:xn(o,e))})}function vi(t,e){return xn(bn.statSync(t),e)}function xn(t,e){return t.isFile()&&Ii(t,e)}function Ii(t,e){var r=t.mode,n=t.uid,o=t.gid,s=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),d=parseInt("001",8),E=a|c,x=r&d||r&c&&o===i||r&a&&n===s||r&E&&s===0;return x}});var Pn=H((Yc,Tn)=>{var Kc=require("fs"),Lt;process.platform==="win32"||global.TESTING_WINDOWS?Lt=Sn():Lt=In();Tn.exports=fr;fr.sync=Ti;function fr(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,o){fr(t,e||{},function(s,i){s?o(s):n(i)})})}Lt(t,e||{},function(n,o){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,o=!1),r(n,o)})}function Ti(t,e){try{return Lt.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var On=H((qc,Rn)=>{var He=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Cn=require("path"),Pi=He?";":":",kn=Pn(),$n=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),An=(t,e)=>{let r=e.colon||Pi,n=t.match(/\//)||He&&t.match(/\\/)?[""]:[...He?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],o=He?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=He?o.split(r):[""];return He&&t.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:n,pathExt:s,pathExtExe:o}},Ln=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:o,pathExtExe:s}=An(t,e),i=[],a=d=>new Promise((E,x)=>{if(d===n.length)return e.all&&i.length?E(i):x($n(t));let w=n[d],S=/^".*"$/.test(w)?w.slice(1,-1):w,I=Cn.join(S,t),P=!S&&/^\.[\\\/]/.test(t)?t.slice(0,2)+I:I;E(c(P,d,0))}),c=(d,E,x)=>new Promise((w,S)=>{if(x===o.length)return w(a(E+1));let I=o[x];kn(d+I,{pathExt:s},(P,T)=>{if(!P&&T)if(e.all)i.push(d+I);else return w(d+I);return w(c(d,E,x+1))})});return r?a(0).then(d=>r(null,d),r):a(0)},Ci=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:o}=An(t,e),s=[];for(let i=0;i<r.length;i++){let a=r[i],c=/^".*"$/.test(a)?a.slice(1,-1):a,d=Cn.join(c,t),E=!c&&/^\.[\\\/]/.test(t)?t.slice(0,2)+d:d;for(let x=0;x<n.length;x++){let w=E+n[x];try{if(kn.sync(w,{pathExt:o}))if(e.all)s.push(w);else return w}catch{}}}if(e.all&&s.length)return s;if(e.nothrow)return null;throw $n(t)};Rn.exports=Ln;Ln.sync=Ci});var _n=H((Zc,mr)=>{"use strict";var Dn=(t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};mr.exports=Dn;mr.exports.default=Dn});var Vn=H((Jc,Un)=>{"use strict";var Nn=require("path"),ki=On(),$i=_n();function Fn(t,e){let r=t.options.env||process.env,n=process.cwd(),o=t.options.cwd!=null,s=o&&process.chdir!==void 0&&!process.chdir.disabled;if(s)try{process.chdir(t.options.cwd)}catch{}let i;try{i=ki.sync(t.command,{path:r[$i({env:r})],pathExt:e?Nn.delimiter:void 0})}catch{}finally{s&&process.chdir(n)}return i&&(i=Nn.resolve(o?t.options.cwd:"",i)),i}function Ai(t){return Fn(t)||Fn(t,!0)}Un.exports=Ai});var Mn=H((Xc,hr)=>{"use strict";var pr=/([()\][%!^"`<>&|;, *?])/g;function Li(t){return t=t.replace(pr,"^$1"),t}function Ri(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(pr,"^$1"),e&&(t=t.replace(pr,"^$1")),t}hr.exports.command=Li;hr.exports.argument=Ri});var Gn=H((Qc,Bn)=>{"use strict";Bn.exports=/^#!(.*)/});var Wn=H((el,zn)=>{"use strict";var Oi=Gn();zn.exports=(t="")=>{let e=t.match(Oi);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),o=r.split("/").pop();return o==="env"?n:n?`${o} ${n}`:o}});var jn=H((tl,Hn)=>{"use strict";var gr=require("fs"),Di=Wn();function _i(t){let r=Buffer.alloc(150),n;try{n=gr.openSync(t,"r"),gr.readSync(n,r,0,150,0),gr.closeSync(n)}catch{}return Di(r.toString())}Hn.exports=_i});var Zn=H((rl,qn)=>{"use strict";var Ni=require("path"),Kn=Vn(),Yn=Mn(),Fi=jn(),Ui=process.platform==="win32",Vi=/\.(?:com|exe)$/i,Mi=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function Bi(t){t.file=Kn(t);let e=t.file&&Fi(t.file);return e?(t.args.unshift(t.file),t.command=e,Kn(t)):t.file}function Gi(t){if(!Ui)return t;let e=Bi(t),r=!Vi.test(e);if(t.options.forceShell||r){let n=Mi.test(e);t.command=Ni.normalize(t.command),t.command=Yn.command(t.command),t.args=t.args.map(s=>Yn.argument(s,n));let o=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${o}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function zi(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:Gi(n)}qn.exports=zi});var Qn=H((nl,Xn)=>{"use strict";var yr=process.platform==="win32";function wr(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function Wi(t,e){if(!yr)return;let r=t.emit;t.emit=function(n,o){if(n==="exit"){let s=Jn(o,e);if(s)return r.call(t,"error",s)}return r.apply(t,arguments)}}function Jn(t,e){return yr&&t===1&&!e.file?wr(e.original,"spawn"):null}function Hi(t,e){return yr&&t===1&&!e.file?wr(e.original,"spawnSync"):null}Xn.exports={hookChildProcess:Wi,verifyENOENT:Jn,verifyENOENTSync:Hi,notFoundError:wr}});var ro=H((ol,je)=>{"use strict";var eo=require("child_process"),Sr=Zn(),br=Qn();function to(t,e,r){let n=Sr(t,e,r),o=eo.spawn(n.command,n.args,n.options);return br.hookChildProcess(o,n),o}function ji(t,e,r){let n=Sr(t,e,r),o=eo.spawnSync(n.command,n.args,n.options);return o.error=o.error||br.verifyENOENTSync(o.status,n),o}je.exports=to;je.exports.spawn=to;je.exports.sync=ji;je.exports._parse=Sr;je.exports._enoent=br});var go=H((vl,_t)=>{_t.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&_t.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&_t.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var Eo=H((Il,Ze)=>{var U=global.process,_e=function(t){return t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function"};_e(U)?(yo=require("assert"),Ye=go(),wo=/^win/i.test(U.platform),ct=require("events"),typeof ct!="function"&&(ct=ct.EventEmitter),U.__signal_exit_emitter__?j=U.__signal_exit_emitter__:(j=U.__signal_exit_emitter__=new ct,j.count=0,j.emitted={}),j.infinite||(j.setMaxListeners(1/0),j.infinite=!0),Ze.exports=function(t,e){if(!_e(global.process))return function(){};yo.equal(typeof t,"function","a callback must be provided for exit handler"),qe===!1&&Tr();var r="exit";e&&e.alwaysLast&&(r="afterexit");var n=function(){j.removeListener(r,t),j.listeners("exit").length===0&&j.listeners("afterexit").length===0&&Nt()};return j.on(r,t),n},Nt=function(){!qe||!_e(global.process)||(qe=!1,Ye.forEach(function(e){try{U.removeListener(e,Ft[e])}catch{}}),U.emit=Ut,U.reallyExit=Pr,j.count-=1)},Ze.exports.unload=Nt,Ne=function(e,r,n){j.emitted[e]||(j.emitted[e]=!0,j.emit(e,r,n))},Ft={},Ye.forEach(function(t){Ft[t]=function(){if(_e(global.process)){var r=U.listeners(t);r.length===j.count&&(Nt(),Ne("exit",null,t),Ne("afterexit",null,t),wo&&t==="SIGHUP"&&(t="SIGINT"),U.kill(U.pid,t))}}}),Ze.exports.signals=function(){return Ye},qe=!1,Tr=function(){qe||!_e(global.process)||(qe=!0,j.count+=1,Ye=Ye.filter(function(e){try{return U.on(e,Ft[e]),!0}catch{return!1}}),U.emit=bo,U.reallyExit=So)},Ze.exports.load=Tr,Pr=U.reallyExit,So=function(e){_e(global.process)&&(U.exitCode=e||0,Ne("exit",U.exitCode,null),Ne("afterexit",U.exitCode,null),Pr.call(U,U.exitCode))},Ut=U.emit,bo=function(e,r){if(e==="exit"&&_e(global.process)){r!==void 0&&(U.exitCode=r);var n=Ut.apply(this,arguments);return Ne("exit",U.exitCode,null),Ne("afterexit",U.exitCode,null),n}else return Ut.apply(this,arguments)}):Ze.exports=function(){return function(){}};var yo,Ye,wo,ct,j,Nt,Ne,Ft,qe,Tr,Pr,So,Ut,bo});var Lo=H((Cl,Ao)=>{"use strict";var{PassThrough:ga}=require("stream");Ao.exports=t=>{t={...t};let{array:e}=t,{encoding:r}=t,n=r==="buffer",o=!1;e?o=!(r||n):r=r||"utf8",n&&(r=null);let s=new ga({objectMode:o});r&&s.setEncoding(r);let i=0,a=[];return s.on("data",c=>{a.push(c),o?i=a.length:i+=c.length}),s.getBufferedValue=()=>e?a:n?Buffer.concat(a,i):a.join(""),s.getBufferedLength=()=>i,s}});var Ro=H((kl,lt)=>{"use strict";var{constants:ya}=require("buffer"),wa=require("stream"),{promisify:Sa}=require("util"),ba=Lo(),Ea=Sa(wa.pipeline),Vt=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function Cr(t,e){if(!t)throw new Error("Expected a stream");e={maxBuffer:1/0,...e};let{maxBuffer:r}=e,n=ba(e);return await new Promise((o,s)=>{let i=a=>{a&&n.getBufferedLength()<=ya.MAX_LENGTH&&(a.bufferedData=n.getBufferedValue()),s(a)};(async()=>{try{await Ea(t,n),o()}catch(a){i(a)}})(),n.on("data",()=>{n.getBufferedLength()>r&&i(new Vt)})}),n.getBufferedValue()}lt.exports=Cr;lt.exports.buffer=(t,e)=>Cr(t,{...e,encoding:"buffer"});lt.exports.array=(t,e)=>Cr(t,{...e,array:!0});lt.exports.MaxBufferError=Vt});var Do=H(($l,Oo)=>{"use strict";var{PassThrough:xa}=require("stream");Oo.exports=function(){var t=[],e=new xa({objectMode:!0});return e.setMaxListeners(0),e.add=r,e.isEmpty=n,e.on("unpipe",o),Array.prototype.slice.call(arguments).forEach(r),e;function r(s){return Array.isArray(s)?(s.forEach(r),this):(t.push(s),s.once("end",o.bind(null,s)),s.once("error",e.emit.bind(e,"error")),s.pipe(e,{end:!1}),this)}function n(){return t.length==0}function o(s){t=t.filter(function(i){return i!==s}),!t.length&&e.readable&&e.end()}}});var ns=H((lu,rs)=>{var se=require("fs"),Oa=require("util"),Xe=require("path"),Gr=require("events"),Xo=require("zlib"),ts=require("stream"),f={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSIGFIRST:80,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,MAXFILECOMMENT:65535,ENDL64HDR:20,ENDL64SIG:117853008,ENDL64SIGFIRST:80,ENDL64OFS:8,END64HDR:56,END64SIG:101075792,END64SIGFIRST:80,END64SUB:24,END64TOT:32,END64SIZ:40,END64OFF:48,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FLG_ENTRY_ENC:1,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535},Ie=function(t){let e,r,n,o,s,i,c=this,d=t.storeEntries!==!1?{}:null,E=t.file,x=t.nameEncoding?new TextDecoder(t.nameEncoding):null;w();function w(){t.fd?(e=t.fd,S()):se.open(E,"r",(u,p)=>{if(u)return c.emit("error",u);e=p,S()})}function S(){se.fstat(e,(u,p)=>{if(u)return c.emit("error",u);r=p.size,n=t.chunkSize||Math.round(r/1e3),n=Math.max(Math.min(n,Math.min(128*1024,r)),Math.min(1024,r)),P()})}function I(u,p){if(u||!p)return c.emit("error",u||new Error("Archive read error"));let m=o.lastPos,h=m-o.win.position,D=o.win.buffer,$=o.minPos;for(;--m>=$&&--h>=0;)if(D.length-h>=4&&D[h]===o.firstByte&&D.readUInt32LE(h)===o.sig){o.lastBufferPosition=h,o.lastBytesRead=p,o.complete();return}if(m===$)return c.emit("error",new Error("Bad archive"));if(o.lastPos=m+1,o.chunkSize*=2,m<=$)return c.emit("error",new Error("Bad archive"));let M=Math.min(o.chunkSize,m-$);o.win.expandLeft(M,I)}function P(){let u=Math.min(f.ENDHDR+f.MAXFILECOMMENT,r);o={win:new zt(e),totalReadLength:u,minPos:r-u,lastPos:r,chunkSize:Math.min(1024,n),firstByte:f.ENDSIGFIRST,sig:f.ENDSIG,complete:T},o.win.read(r-o.chunkSize,o.chunkSize,I)}function T(){let u=o.win.buffer,p=o.lastBufferPosition;try{s=new Nr,s.read(u.slice(p,p+f.ENDHDR)),s.headerOffset=o.win.position+p,s.commentLength?c.comment=u.slice(p+f.ENDHDR,p+f.ENDHDR+s.commentLength).toString():c.comment=null,c.entriesCount=s.volumeEntries,c.centralDirectory=s,s.volumeEntries===f.EF_ZIP64_OR_16&&s.totalEntries===f.EF_ZIP64_OR_16||s.size===f.EF_ZIP64_OR_32||s.offset===f.EF_ZIP64_OR_32?C():(o={},b())}catch(m){c.emit("error",m)}}function C(){let u=f.ENDL64HDR;o.lastBufferPosition>u?(o.lastBufferPosition-=u,l()):(o={win:o.win,totalReadLength:u,minPos:o.win.position-u,lastPos:o.win.position,chunkSize:o.chunkSize,firstByte:f.ENDL64SIGFIRST,sig:f.ENDL64SIG,complete:l},o.win.read(o.lastPos-o.chunkSize,o.chunkSize,I))}function l(){let u=o.win.buffer,p=new Fr;p.read(u.slice(o.lastBufferPosition,o.lastBufferPosition+f.ENDL64HDR));let m=r-p.headerOffset;o={win:o.win,totalReadLength:m,minPos:p.headerOffset,lastPos:o.lastPos,chunkSize:o.chunkSize,firstByte:f.END64SIGFIRST,sig:f.END64SIG,complete:y},o.win.read(r-o.chunkSize,o.chunkSize,I)}function y(){let u=o.win.buffer,p=new Ur;p.read(u.slice(o.lastBufferPosition,o.lastBufferPosition+f.END64HDR)),c.centralDirectory.volumeEntries=p.volumeEntries,c.centralDirectory.totalEntries=p.totalEntries,c.centralDirectory.size=p.size,c.centralDirectory.offset=p.offset,c.entriesCount=p.volumeEntries,o={},b()}function b(){o={win:new zt(e),pos:s.offset,chunkSize:n,entriesLeft:s.volumeEntries},o.win.read(o.pos,Math.min(n,r-o.pos),R)}function R(u,p){if(u||!p)return c.emit("error",u||new Error("Entries read error"));let m=o.pos-o.win.position,h=o.entry,D=o.win.buffer,$=D.length;try{for(;o.entriesLeft>0;){h||(h=new Vr,h.readHeader(D,m),h.headerOffset=o.win.position+m,o.entry=h,o.pos+=f.CENHDR,m+=f.CENHDR);let M=h.fnameLen+h.extraLen+h.comLen,z=M+(o.entriesLeft>1?f.CENHDR:0);if($-m<z){o.win.moveRight(n,R,m),o.move=!0;return}h.read(D,m,x),t.skipEntryNameValidation||h.validateName(),d&&(d[h.name]=h),c.emit("entry",h),o.entry=h=null,o.entriesLeft--,o.pos+=M,m+=M}c.emit("ready")}catch(M){c.emit("error",M)}}function V(){if(!d)throw new Error("storeEntries disabled")}Object.defineProperty(this,"ready",{get(){return!1}}),this.entry=function(u){return V(),d[u]},this.entries=function(){return V(),d},this.stream=function(u,p){return this.openEntry(u,(m,h)=>{if(m)return p(m);let D=ne(h),$=new Mr(e,D,h.compressedSize);if(h.method!==f.STORED)if(h.method===f.DEFLATED)$=$.pipe(Xo.createInflateRaw());else return p(new Error("Unknown compression method: "+h.method));ce(h)&&($=$.pipe(new Br($,h.crc,h.size))),p(null,$)},!1)},this.entryDataSync=function(u){let p=null;if(this.openEntry(u,(h,D)=>{p=h,u=D},!0),p)throw p;let m=Buffer.alloc(u.compressedSize);if(new xe(e,m,0,u.compressedSize,ne(u),h=>{p=h}).read(!0),p)throw p;if(u.method!==f.STORED)if(u.method===f.DEFLATED||u.method===f.ENHANCED_DEFLATED)m=Xo.inflateRawSync(m);else throw new Error("Unknown compression method: "+u.method);if(m.length!==u.size)throw new Error("Invalid size");return ce(u)&&new Wt(u.crc,u.size).data(m),m},this.openEntry=function(u,p,m){if(typeof u=="string"&&(V(),u=d[u],!u))return p(new Error("Entry not found"));if(!u.isFile)return p(new Error("Entry is not file"));if(!e)return p(new Error("Archive closed"));let h=Buffer.alloc(f.LOCHDR);new xe(e,h,0,h.length,u.offset,D=>{if(D)return p(D);let $;try{u.readDataHeader(h),u.encrypted&&($=new Error("Entry encrypted"))}catch(M){$=M}p($,u)}).read(m)};function ne(u){return u.offset+f.LOCHDR+u.fnameLen+u.extraLen}function ce(u){return(u.flags&8)!==8}function Oe(u,p,m){c.stream(u,(h,D)=>{if(h)m(h);else{let $,M;D.on("error",z=>{M=z,$&&(D.unpipe($),$.close(()=>{m(z)}))}),se.open(p,"w",(z,le)=>{if(z)return m(z);if(M){se.close(e,()=>{m(M)});return}$=se.createWriteStream(p,{fd:le}),$.on("finish",()=>{c.emit("extract",u,p),M||m()}),D.pipe($)})}})}function Tt(u,p,m){if(!p.length)return m();let h=p.shift();h=Xe.join(u,Xe.join(...h)),se.mkdir(h,{recursive:!0},D=>{if(D&&D.code!=="EEXIST")return m(D);Tt(u,p,m)})}function oe(u,p,m,h,D){if(!m.length)return h(null,D);let $=m.shift(),M=Xe.join(u,$.name.replace(p,""));Oe($,M,z=>{if(z)return h(z,D);oe(u,p,m,h,D+1)})}this.extract=function(u,p,m){let h=u||"";if(typeof u=="string"&&(u=this.entry(u),u?h=u.name:h.length&&h[h.length-1]!=="/"&&(h+="/")),!u||u.isDirectory){let D=[],$=[],M={};for(let z in d)if(Object.prototype.hasOwnProperty.call(d,z)&&z.lastIndexOf(h,0)===0){let le=z.replace(h,""),on=d[z];if(on.isFile&&(D.push(on),le=Xe.dirname(le)),le&&!M[le]&&le!=="."){M[le]=!0;let we=le.split("/").filter(it=>it);for(we.length&&$.push(we);we.length>1;){we=we.slice(0,we.length-1);let it=we.join("/");if(M[it]||it===".")break;M[it]=!0,$.push(we)}}}$.sort((z,le)=>z.length-le.length),$.length?Tt(p,$,z=>{z?m(z):oe(p,h,D,m,0)}):oe(p,h,D,m,0)}else se.stat(p,(D,$)=>{$&&$.isDirectory()?Oe(u,Xe.join(p,Xe.basename(u.name)),m):Oe(u,p,m)})},this.close=function(u){i||!e?(i=!0,u&&u()):(i=!0,se.close(e,p=>{e=null,u&&u(p)}))};let Z=Gr.EventEmitter.prototype.emit;this.emit=function(...u){if(!i)return Z.call(this,...u)}};Ie.setFs=function(t){se=t};Ie.debugLog=(...t)=>{Ie.debug&&console.log(...t)};Oa.inherits(Ie,Gr.EventEmitter);var Ee=Symbol("zip");Ie.async=class extends Gr.EventEmitter{constructor(e){super();let r=new Ie(e);r.on("entry",n=>this.emit("entry",n)),r.on("extract",(n,o)=>this.emit("extract",n,o)),this[Ee]=new Promise((n,o)=>{r.on("ready",()=>{r.removeListener("error",o),n(r)}),r.on("error",o)})}get entriesCount(){return this[Ee].then(e=>e.entriesCount)}get comment(){return this[Ee].then(e=>e.comment)}async entry(e){return(await this[Ee]).entry(e)}async entries(){return(await this[Ee]).entries()}async stream(e){let r=await this[Ee];return new Promise((n,o)=>{r.stream(e,(s,i)=>{s?o(s):n(i)})})}async entryData(e){let r=await this.stream(e);return new Promise((n,o)=>{let s=[];r.on("data",i=>s.push(i)),r.on("end",()=>{n(Buffer.concat(s))}),r.on("error",i=>{r.removeAllListeners("end"),o(i)})})}async extract(e,r){let n=await this[Ee];return new Promise((o,s)=>{n.extract(e,r,(i,a)=>{i?s(i):o(a)})})}async close(){let e=await this[Ee];return new Promise((r,n)=>{e.close(o=>{o?n(o):r()})})}};var Nr=class{read(e){if(e.length!==f.ENDHDR||e.readUInt32LE(0)!==f.ENDSIG)throw new Error("Invalid central directory");this.volumeEntries=e.readUInt16LE(f.ENDSUB),this.totalEntries=e.readUInt16LE(f.ENDTOT),this.size=e.readUInt32LE(f.ENDSIZ),this.offset=e.readUInt32LE(f.ENDOFF),this.commentLength=e.readUInt16LE(f.ENDCOM)}},Fr=class{read(e){if(e.length!==f.ENDL64HDR||e.readUInt32LE(0)!==f.ENDL64SIG)throw new Error("Invalid zip64 central directory locator");this.headerOffset=ve(e,f.ENDSUB)}},Ur=class{read(e){if(e.length!==f.END64HDR||e.readUInt32LE(0)!==f.END64SIG)throw new Error("Invalid central directory");this.volumeEntries=ve(e,f.END64SUB),this.totalEntries=ve(e,f.END64TOT),this.size=ve(e,f.END64SIZ),this.offset=ve(e,f.END64OFF)}},Vr=class{readHeader(e,r){if(e.length<r+f.CENHDR||e.readUInt32LE(r)!==f.CENSIG)throw new Error("Invalid entry header");this.verMade=e.readUInt16LE(r+f.CENVEM),this.version=e.readUInt16LE(r+f.CENVER),this.flags=e.readUInt16LE(r+f.CENFLG),this.method=e.readUInt16LE(r+f.CENHOW);let n=e.readUInt16LE(r+f.CENTIM),o=e.readUInt16LE(r+f.CENTIM+2);this.time=Qo(n,o),this.crc=e.readUInt32LE(r+f.CENCRC),this.compressedSize=e.readUInt32LE(r+f.CENSIZ),this.size=e.readUInt32LE(r+f.CENLEN),this.fnameLen=e.readUInt16LE(r+f.CENNAM),this.extraLen=e.readUInt16LE(r+f.CENEXT),this.comLen=e.readUInt16LE(r+f.CENCOM),this.diskStart=e.readUInt16LE(r+f.CENDSK),this.inattr=e.readUInt16LE(r+f.CENATT),this.attr=e.readUInt32LE(r+f.CENATX),this.offset=e.readUInt32LE(r+f.CENOFF)}readDataHeader(e){if(e.readUInt32LE(0)!==f.LOCSIG)throw new Error("Invalid local header");this.version=e.readUInt16LE(f.LOCVER),this.flags=e.readUInt16LE(f.LOCFLG),this.method=e.readUInt16LE(f.LOCHOW);let r=e.readUInt16LE(f.LOCTIM),n=e.readUInt16LE(f.LOCTIM+2);this.time=Qo(r,n),this.crc=e.readUInt32LE(f.LOCCRC)||this.crc;let o=e.readUInt32LE(f.LOCSIZ);o&&o!==f.EF_ZIP64_OR_32&&(this.compressedSize=o);let s=e.readUInt32LE(f.LOCLEN);s&&s!==f.EF_ZIP64_OR_32&&(this.size=s),this.fnameLen=e.readUInt16LE(f.LOCNAM),this.extraLen=e.readUInt16LE(f.LOCEXT)}read(e,r,n){let o=e.slice(r,r+=this.fnameLen);this.name=n?n.decode(new Uint8Array(o)):o.toString("utf8");let s=e[r-1];this.isDirectory=s===47||s===92,this.extraLen&&(this.readExtra(e,r),r+=this.extraLen),this.comment=this.comLen?e.slice(r,r+this.comLen).toString():null}validateName(){if(/\\|^\w+:|^\/|(^|\/)\.\.(\/|$)/.test(this.name))throw new Error("Malicious entry: "+this.name)}readExtra(e,r){let n,o,s=r+this.extraLen;for(;r<s;)n=e.readUInt16LE(r),r+=2,o=e.readUInt16LE(r),r+=2,f.ID_ZIP64===n&&this.parseZip64Extra(e,r,o),r+=o}parseZip64Extra(e,r,n){n>=8&&this.size===f.EF_ZIP64_OR_32&&(this.size=ve(e,r),r+=8,n-=8),n>=8&&this.compressedSize===f.EF_ZIP64_OR_32&&(this.compressedSize=ve(e,r),r+=8,n-=8),n>=8&&this.offset===f.EF_ZIP64_OR_32&&(this.offset=ve(e,r),r+=8,n-=8),n>=4&&this.diskStart===f.EF_ZIP64_OR_16&&(this.diskStart=e.readUInt32LE(r))}get encrypted(){return(this.flags&f.FLG_ENTRY_ENC)===f.FLG_ENTRY_ENC}get isFile(){return!this.isDirectory}},xe=class{constructor(e,r,n,o,s,i){this.fd=e,this.buffer=r,this.offset=n,this.length=o,this.position=s,this.callback=i,this.bytesRead=0,this.waiting=!1}read(e){Ie.debugLog("read",this.position,this.bytesRead,this.length,this.offset),this.waiting=!0;let r;if(e){let n=0;try{n=se.readSync(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead)}catch(o){r=o}this.readCallback(e,r,r?n:null)}else se.read(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead,this.readCallback.bind(this,e))}readCallback(e,r,n){if(typeof n=="number"&&(this.bytesRead+=n),r||!n||this.bytesRead===this.length)return this.waiting=!1,this.callback(r,this.bytesRead);this.read(e)}},zt=class{constructor(e){this.position=0,this.buffer=Buffer.alloc(0),this.fd=e,this.fsOp=null}checkOp(){if(this.fsOp&&this.fsOp.waiting)throw new Error("Operation in progress")}read(e,r,n){this.checkOp(),this.buffer.length<r&&(this.buffer=Buffer.alloc(r)),this.position=e,this.fsOp=new xe(this.fd,this.buffer,0,r,this.position,n).read()}expandLeft(e,r){this.checkOp(),this.buffer=Buffer.concat([Buffer.alloc(e),this.buffer]),this.position-=e,this.position<0&&(this.position=0),this.fsOp=new xe(this.fd,this.buffer,0,e,this.position,r).read()}expandRight(e,r){this.checkOp();let n=this.buffer.length;this.buffer=Buffer.concat([this.buffer,Buffer.alloc(e)]),this.fsOp=new xe(this.fd,this.buffer,n,e,this.position+n,r).read()}moveRight(e,r,n){this.checkOp(),n?this.buffer.copy(this.buffer,0,n):n=0,this.position+=n,this.fsOp=new xe(this.fd,this.buffer,this.buffer.length-n,n,this.position+this.buffer.length-n,r).read()}},Mr=class extends ts.Readable{constructor(e,r,n){super(),this.fd=e,this.offset=r,this.length=n,this.pos=0,this.readCallback=this.readCallback.bind(this)}_read(e){let r=Buffer.alloc(Math.min(e,this.length-this.pos));r.length?se.read(this.fd,r,0,r.length,this.offset+this.pos,this.readCallback):this.push(null)}readCallback(e,r,n){this.pos+=r,e?(this.emit("error",e),this.push(null)):r?(r!==n.length&&(n=n.slice(0,r)),this.push(n)):this.push(null)}},Br=class extends ts.Transform{constructor(e,r,n){super(),this.verify=new Wt(r,n),e.on("error",o=>{this.emit("error",o)})}_transform(e,r,n){let o;try{this.verify.data(e)}catch(s){o=s}n(o,e)}},Wt=class t{constructor(e,r){this.crc=e,this.size=r,this.state={crc:-1,size:0}}data(e){let r=t.getCrcTable(),n=this.state.crc,o=0,s=e.length;for(;--s>=0;)n=r[(n^e[o++])&255]^n>>>8;if(this.state.crc=n,this.state.size+=e.length,this.state.size>=this.size){let i=Buffer.alloc(4);if(i.writeInt32LE(~this.state.crc&4294967295,0),n=i.readUInt32LE(0),n!==this.crc)throw new Error("Invalid CRC");if(this.state.size!==this.size)throw new Error("Invalid size")}}static getCrcTable(){let e=t.crcTable;if(!e){t.crcTable=e=[];let r=Buffer.alloc(4);for(let n=0;n<256;n++){let o=n;for(let s=8;--s>=0;)(o&1)!==0?o=3988292384^o>>>1:o=o>>>1;o<0&&(r.writeInt32LE(o,0),o=r.readUInt32LE(0)),e[n]=o}}return e}};function Qo(t,e){let r=es(t,16),n=es(e,16),o={h:parseInt(r.slice(0,5).join(""),2),m:parseInt(r.slice(5,11).join(""),2),s:parseInt(r.slice(11,16).join(""),2)*2,Y:parseInt(n.slice(0,7).join(""),2)+1980,M:parseInt(n.slice(7,11).join(""),2),D:parseInt(n.slice(11,16).join(""),2)},s=[o.Y,o.M,o.D].join("-")+" "+[o.h,o.m,o.s].join(":")+" GMT+0";return new Date(s).getTime()}function es(t,e){let r=(t>>>0).toString(2);for(;r.length<e;)r="0"+r;return r.split("")}function ve(t,e){return t.readUInt32LE(e+4)*4294967296+t.readUInt32LE(e)}rs.exports=Ie});var Rc={};mi(Rc,{default:()=>Lc});module.exports=pi(Rc);var g=require("@raycast/api");var A=Y(require("react")),N=require("@raycast/api");var an=Object.prototype.hasOwnProperty;function Ct(t,e){var r,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&Ct(t[n],e[n]););return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(an.call(t,r)&&++n&&!an.call(e,r)||!(r in e)||!Ct(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}var De=Y(require("node:fs")),kt=Y(require("node:path"));var un=require("react/jsx-runtime");function hi(t){let e=(0,A.useRef)(t),r=(0,A.useRef)(0);return Ct(t,e.current)||(e.current=t,r.current+=1),(0,A.useMemo)(()=>e.current,[r.current])}function ee(t){let e=(0,A.useRef)(t);return e.current=t,e}function gi(t,e){let r=t instanceof Error?t.message:String(t);return(0,N.showToast)({style:N.Toast.Style.Failure,title:e?.title??"Something went wrong",message:e?.message??r,primaryAction:e?.primaryAction??cn(t),secondaryAction:e?.primaryAction?cn(t):void 0})}var cn=t=>{let e=!0,r="[Extension Name]...",n="";try{let i=JSON.parse((0,De.readFileSync)((0,kt.join)(N.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,n=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(e=!1)}catch{}let o=N.environment.isDevelopment||e,s=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:o?"Copy Logs":"Report Error",onAction(i){i.hide(),o?N.Clipboard.copy(s):(0,N.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function $t(t,e,r){let n=(0,A.useRef)(0),[o,s]=(0,A.useState)({isLoading:!0}),i=ee(t),a=ee(r?.abortable),c=ee(e||[]),d=ee(r?.onError),E=ee(r?.onData),x=ee(r?.onWillExecute),w=ee(r?.failureToastOptions),S=ee(o.data),I=(0,A.useRef)(null),P=(0,A.useRef)({page:0}),T=(0,A.useRef)(!1),C=(0,A.useRef)(!0),l=(0,A.useRef)(50),y=(0,A.useCallback)(()=>(a.current&&(a.current.current?.abort(),a.current.current=new AbortController),++n.current),[a]),b=(0,A.useCallback)((...oe)=>{let Z=y();x.current?.(oe),s(m=>({...m,isLoading:!0}));let u=yi(i.current)(...oe);function p(m){return m.name=="AbortError"||Z===n.current&&(d.current?d.current(m):N.environment.launchType!==N.LaunchType.Background&&gi(m,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(h){h.hide(),I.current?.(...c.current||[])}},...w.current}),s({error:m,isLoading:!1})),m}return typeof u=="function"?(T.current=!0,u(P.current).then(({data:m,hasMore:h,cursor:D})=>(Z===n.current&&(P.current&&(P.current.cursor=D,P.current.lastItem=m?.[m.length-1]),E.current&&E.current(m,P.current),h&&(l.current=m.length),C.current=h,s($=>P.current.page===0?{data:m,isLoading:!1}:{data:($.data||[])?.concat(m),isLoading:!1})),m),m=>(C.current=!1,p(m)))):(T.current=!1,u.then(m=>(Z===n.current&&(E.current&&E.current(m),s({data:m,isLoading:!1})),m),p))},[E,d,c,i,s,I,x,P,w,y]);I.current=b;let R=(0,A.useCallback)(()=>{P.current={page:0};let oe=c.current||[];return b(...oe)},[b,c]),V=(0,A.useCallback)(async(oe,Z)=>{let u;try{if(Z?.optimisticUpdate){y(),typeof Z?.rollbackOnError!="function"&&Z?.rollbackOnError!==!1&&(u=structuredClone(S.current?.value));let p=Z.optimisticUpdate;s(m=>({...m,data:p(m.data)}))}return await oe}catch(p){if(typeof Z?.rollbackOnError=="function"){let m=Z.rollbackOnError;s(h=>({...h,data:m(h.data)}))}else Z?.optimisticUpdate&&Z?.rollbackOnError!==!1&&s(m=>({...m,data:u}));throw p}finally{Z?.shouldRevalidateAfter!==!1&&(N.environment.launchType===N.LaunchType.Background||N.environment.commandMode==="menu-bar"?await R():R())}},[R,S,s,y]),ne=(0,A.useCallback)(()=>{P.current.page+=1;let oe=c.current||[];b(...oe)},[P,c,b]);(0,A.useEffect)(()=>{P.current={page:0},r?.execute!==!1?b(...e||[]):y()},[hi([e,r?.execute,b]),a,P]),(0,A.useEffect)(()=>()=>{y()},[y]);let ce=r?.execute!==!1?o.isLoading:!1,Oe={...o,isLoading:ce},Tt=T.current?{pageSize:l.current,hasMore:C.current,onLoadMore:ne}:void 0;return{...Oe,revalidate:R,mutate:V,pagination:Tt}}function yi(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function wi(t,e){let r=this[t];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:e}function Si(t,e){return typeof e=="string"&&e.startsWith("__raycast_cached_date__")?new Date(e.replace("__raycast_cached_date__","")):typeof e=="string"&&e.startsWith("__raycast_cached_buffer__")?Buffer.from(e.replace("__raycast_cached_buffer__",""),"base64"):e}var bi=Symbol("cache without namespace"),ln=new Map;function Ge(t,e,r){let n=r?.cacheNamespace||bi,o=ln.get(n)||ln.set(n,new N.Cache({namespace:r?.cacheNamespace})).get(n);if(!o)throw new Error("Missing cache");let s=ee(t),i=ee(e),a=(0,A.useSyncExternalStore)(o.subscribe,()=>{try{return o.get(s.current)}catch(x){console.error("Could not get Cache data:",x);return}}),c=(0,A.useMemo)(()=>{if(typeof a<"u"){if(a==="undefined")return;try{return JSON.parse(a,Si)}catch(x){return console.warn("The cached data is corrupted",x),i.current}}else return i.current},[a,i]),d=ee(c),E=(0,A.useCallback)(x=>{let w=typeof x=="function"?x(d.current):x;if(typeof w>"u")o.set(s.current,"undefined");else{let S=JSON.stringify(w,wi);o.set(s.current,S)}return w},[o,s,d]);return[c,E]}var At=(function(t){return t.Required="required",t})({});function lr(t,e){if(t){if(typeof t=="function")return t(e);if(t==="required"){let r=typeof e<"u"&&e!==null;if(r)switch(typeof e){case"string":r=e.length>0;break;case"object":Array.isArray(e)?r=e.length>0:e instanceof Date&&(r=e.getTime()>0);break;default:break}if(!r)return"The item is required"}}}function dn(t){let{onSubmit:e,validation:r,initialValues:n={}}=t,[o,s]=(0,A.useState)(n),[i,a]=(0,A.useState)({}),c=(0,A.useRef)({}),d=ee(r||{}),E=ee(e),x=(0,A.useCallback)(C=>{c.current[C]?.focus()},[c]),w=(0,A.useCallback)(async C=>{let l=!1;for(let[b,R]of Object.entries(d.current)){let V=lr(R,C[b]);V&&(l||(l={},x(b)),l[b]=V)}if(l)return a(l),!1;let y=await E.current(C);return typeof y=="boolean"?y:!0},[d,E,x]),S=(0,A.useCallback)((C,l)=>{a(y=>({...y,[C]:l}))},[a]),I=(0,A.useCallback)(function(C,l){s(y=>({...y,[C]:typeof l=="function"?l(y[C]):l}))},[s]),P=(0,A.useMemo)(()=>new Proxy({},{get(C,l){let y=d.current[l],b=o[l];return{onChange(R){i[l]&&(lr(y,R)||S(l,void 0)),I(l,R)},onBlur(R){let V=lr(y,R.target.value);V&&S(l,V)},error:i[l],id:l,value:typeof b>"u"?null:b,ref:R=>{c.current[l]=R}}}}),[i,d,S,o,c,I]),T=(0,A.useCallback)(C=>{a({}),Object.entries(c.current).forEach(([l,y])=>{C?.[l]||y?.reset()}),C&&s(C)},[s,a,c]);return{handleSubmit:w,setValidationError:S,setValue:I,values:o,itemProps:P,focus:x,reset:T}}var It=require("react");var rc=require("@raycast/api");var ur=require("react"),Fc=(0,ur.createContext)(null);var Zr=require("@raycast/api");var dr=require("@raycast/api"),fn=require("react/jsx-runtime");var rt=require("@raycast/api"),Ve=require("react");var O=require("@raycast/api"),wt=require("react");var ze=require("@raycast/api");var pn="https://bitwarden.com";var F={PASSWORD_OPTIONS:"bw-generate-password-options",PASSWORD_ONE_TIME_WARNING:"bw-generate-password-warning-accepted",SESSION_TOKEN:"sessionToken",REPROMPT_HASH:"sessionRepromptHash",SERVER_URL:"cliServer",LAST_ACTIVITY_TIME:"lastActivityTime",VAULT_LOCK_REASON:"vaultLockReason",VAULT_FAVORITE_ORDER:"vaultFavoriteOrder",VAULT_LAST_STATUS:"lastVaultStatus"},We={TIMEOUT:"Vault timed out due to inactivity",MANUAL:"Manually locked by the user",SYSTEM_LOCK:"Screen was locked",SYSTEM_SLEEP:"System went to sleep",CLI_UPDATED:"Bitwarden has been updated. Please login again."};var de={IV:"iv",VAULT:"vault",CURRENT_FOLDER_ID:"currentFolderId",SEND_TYPE_FILTER:"sendTypeFilter",CLI_VERSION:"cliVersion"},zc={1:ze.Icon.Globe,3:ze.Icon.CreditCard,4:ze.Icon.Person,2:ze.Icon.Document,5:ze.Icon.Key};var Ue=require("react");var G=require("@raycast/api");var zo=require("node:buffer"),Wo=Y(require("node:path"),1),Or=Y(require("node:child_process"),1),ut=Y(require("node:process"),1),Ho=Y(ro(),1);function Er(t){let e=typeof t=="string"?`
`:10,r=typeof t=="string"?"\r":13;return t[t.length-1]===e&&(t=t.slice(0,-1)),t[t.length-1]===r&&(t=t.slice(0,-1)),t}var at=Y(require("node:process"),1),Ke=Y(require("node:path"),1),no=Y(require("node:url"),1);function Rt(t={}){let{env:e=process.env,platform:r=process.platform}=t;return r!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}function Ki(t={}){let{cwd:e=at.default.cwd(),path:r=at.default.env[Rt()],execPath:n=at.default.execPath}=t,o,s=e instanceof URL?no.default.fileURLToPath(e):e,i=Ke.default.resolve(s),a=[];for(;o!==i;)a.push(Ke.default.join(i,"node_modules/.bin")),o=i,i=Ke.default.resolve(i,"..");return a.push(Ke.default.resolve(s,n,"..")),[...a,r].join(Ke.default.delimiter)}function oo({env:t=at.default.env,...e}={}){t={...t};let r=Rt({env:t});return e.path=t[r],t[r]=Ki(e),t}var Yi=(t,e,r,n)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let o=Object.getOwnPropertyDescriptor(t,r),s=Object.getOwnPropertyDescriptor(e,r);!qi(o,s)&&n||Object.defineProperty(t,r,s)},qi=function(t,e){return t===void 0||t.configurable||t.writable===e.writable&&t.enumerable===e.enumerable&&t.configurable===e.configurable&&(t.writable||t.value===e.value)},Zi=(t,e)=>{let r=Object.getPrototypeOf(e);r!==Object.getPrototypeOf(t)&&Object.setPrototypeOf(t,r)},Ji=(t,e)=>`/* Wrapped ${t}*/
${e}`,Xi=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Qi=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),ea=(t,e,r)=>{let n=r===""?"":`with ${r.trim()}() `,o=Ji.bind(null,n,e.toString());Object.defineProperty(o,"name",Qi),Object.defineProperty(t,"toString",{...Xi,value:o})};function xr(t,e,{ignoreNonConfigurable:r=!1}={}){let{name:n}=t;for(let o of Reflect.ownKeys(e))Yi(t,e,o,r);return Zi(t,e),ea(t,e,n),t}var Ot=new WeakMap,so=(t,e={})=>{if(typeof t!="function")throw new TypeError("Expected a function");let r,n=0,o=t.displayName||t.name||"<anonymous>",s=function(...i){if(Ot.set(s,++n),n===1)r=t.apply(this,i),t=null;else if(e.throw===!0)throw new Error(`Function \`${o}\` can only be called once`);return r};return xr(s,t),Ot.set(s,n),s};so.callCount=t=>{if(!Ot.has(t))throw new Error(`The given function \`${t.name}\` is not wrapped by the \`onetime\` package`);return Ot.get(t)};var io=so;var mo=require("node:os");var ao=function(){let t=lo-co+1;return Array.from({length:t},ta)},ta=function(t,e){return{name:`SIGRT${e+1}`,number:co+e,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},co=34,lo=64;var fo=require("node:os");var uo=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var vr=function(){let t=ao();return[...uo,...t].map(ra)},ra=function({name:t,number:e,description:r,action:n,forced:o=!1,standard:s}){let{signals:{[t]:i}}=fo.constants,a=i!==void 0;return{name:t,number:a?i:e,description:r,supported:a,action:n,forced:o,standard:s}};var na=function(){let t=vr();return Object.fromEntries(t.map(oa))},oa=function({name:t,number:e,description:r,supported:n,action:o,forced:s,standard:i}){return[t,{name:t,number:e,description:r,supported:n,action:o,forced:s,standard:i}]},po=na(),sa=function(){let t=vr(),e=65,r=Array.from({length:e},(n,o)=>ia(o,t));return Object.assign({},...r)},ia=function(t,e){let r=aa(t,e);if(r===void 0)return{};let{name:n,description:o,supported:s,action:i,forced:a,standard:c}=r;return{[t]:{name:n,number:t,description:o,supported:s,action:i,forced:a,standard:c}}},aa=function(t,e){let r=e.find(({name:n})=>mo.constants.signals[n]===t);return r!==void 0?r:e.find(n=>n.number===t)},wl=sa();var ca=({timedOut:t,timeout:e,errorCode:r,signal:n,signalDescription:o,exitCode:s,isCanceled:i})=>t?`timed out after ${e} milliseconds`:i?"was canceled":r!==void 0?`failed with ${r}`:n!==void 0?`was killed with ${n} (${o})`:s!==void 0?`failed with exit code ${s}`:"failed",Ir=({stdout:t,stderr:e,all:r,error:n,signal:o,exitCode:s,command:i,escapedCommand:a,timedOut:c,isCanceled:d,killed:E,parsed:{options:{timeout:x}}})=>{s=s===null?void 0:s,o=o===null?void 0:o;let w=o===void 0?void 0:po[o].description,S=n&&n.code,P=`Command ${ca({timedOut:c,timeout:x,errorCode:S,signal:o,signalDescription:w,exitCode:s,isCanceled:d})}: ${i}`,T=Object.prototype.toString.call(n)==="[object Error]",C=T?`${P}
${n.message}`:P,l=[C,e,t].filter(Boolean).join(`
`);return T?(n.originalMessage=n.message,n.message=l):n=new Error(l),n.shortMessage=C,n.command=i,n.escapedCommand=a,n.exitCode=s,n.signal=o,n.signalDescription=w,n.stdout=t,n.stderr=e,r!==void 0&&(n.all=r),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!c,n.isCanceled=d,n.killed=E&&!c,n};var Dt=["stdin","stdout","stderr"],la=t=>Dt.some(e=>t[e]!==void 0),ho=t=>{if(!t)return;let{stdio:e}=t;if(e===void 0)return Dt.map(n=>t[n]);if(la(t))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${Dt.map(n=>`\`${n}\``).join(", ")}`);if(typeof e=="string")return e;if(!Array.isArray(e))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof e}\``);let r=Math.max(e.length,Dt.length);return Array.from({length:r},(n,o)=>e[o])};var xo=Y(require("node:os"),1),vo=Y(Eo(),1),ua=1e3*5,Io=(t,e="SIGTERM",r={})=>{let n=t(e);return da(t,e,r,n),n},da=(t,e,r,n)=>{if(!fa(e,r,n))return;let o=pa(r),s=setTimeout(()=>{t("SIGKILL")},o);s.unref&&s.unref()},fa=(t,{forceKillAfterTimeout:e},r)=>ma(t)&&e!==!1&&r,ma=t=>t===xo.default.constants.signals.SIGTERM||typeof t=="string"&&t.toUpperCase()==="SIGTERM",pa=({forceKillAfterTimeout:t=!0})=>{if(t===!0)return ua;if(!Number.isFinite(t)||t<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${t}\` (${typeof t})`);return t},To=(t,e)=>{t.kill()&&(e.isCanceled=!0)},ha=(t,e,r)=>{t.kill(e),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:e}))},Po=(t,{timeout:e,killSignal:r="SIGTERM"},n)=>{if(e===0||e===void 0)return n;let o,s=new Promise((a,c)=>{o=setTimeout(()=>{ha(t,r,c)},e)}),i=n.finally(()=>{clearTimeout(o)});return Promise.race([s,i])},Co=({timeout:t})=>{if(t!==void 0&&(!Number.isFinite(t)||t<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${t}\` (${typeof t})`)},ko=async(t,{cleanup:e,detached:r},n)=>{if(!e||r)return n;let o=(0,vo.default)(()=>{t.kill()});return n.finally(()=>{o()})};function $o(t){return t!==null&&typeof t=="object"&&typeof t.pipe=="function"}var Ar=Y(Ro(),1),_o=Y(Do(),1),No=(t,e)=>{e!==void 0&&($o(e)?e.pipe(t.stdin):t.stdin.end(e))},Fo=(t,{all:e})=>{if(!e||!t.stdout&&!t.stderr)return;let r=(0,_o.default)();return t.stdout&&r.add(t.stdout),t.stderr&&r.add(t.stderr),r},kr=async(t,e)=>{if(!(!t||e===void 0)){t.destroy();try{return await e}catch(r){return r.bufferedData}}},$r=(t,{encoding:e,buffer:r,maxBuffer:n})=>{if(!(!t||!r))return e?(0,Ar.default)(t,{encoding:e,maxBuffer:n}):Ar.default.buffer(t,{maxBuffer:n})},Uo=async({stdout:t,stderr:e,all:r},{encoding:n,buffer:o,maxBuffer:s},i)=>{let a=$r(t,{encoding:n,buffer:o,maxBuffer:s}),c=$r(e,{encoding:n,buffer:o,maxBuffer:s}),d=$r(r,{encoding:n,buffer:o,maxBuffer:s*2});try{return await Promise.all([i,a,c,d])}catch(E){return Promise.all([{error:E,signal:E.signal,timedOut:E.timedOut},kr(t,a),kr(e,c),kr(r,d)])}};var va=(async()=>{})().constructor.prototype,Ia=["then","catch","finally"].map(t=>[t,Reflect.getOwnPropertyDescriptor(va,t)]),Lr=(t,e)=>{for(let[r,n]of Ia){let o=typeof e=="function"?(...s)=>Reflect.apply(n.value,e(),s):n.value.bind(e);Reflect.defineProperty(t,r,{...n,value:o})}return t},Vo=t=>new Promise((e,r)=>{t.on("exit",(n,o)=>{e({exitCode:n,signal:o})}),t.on("error",n=>{r(n)}),t.stdin&&t.stdin.on("error",n=>{r(n)})});var Mo=(t,e=[])=>Array.isArray(e)?[t,...e]:[t],Ta=/^[\w.-]+$/,Pa=/"/g,Ca=t=>typeof t!="string"||Ta.test(t)?t:`"${t.replace(Pa,'\\"')}"`,Bo=(t,e)=>Mo(t,e).join(" "),Go=(t,e)=>Mo(t,e).map(r=>Ca(r)).join(" ");var ka=1e3*1e3*100,$a=({env:t,extendEnv:e,preferLocal:r,localDir:n,execPath:o})=>{let s=e?{...ut.default.env,...t}:t;return r?oo({env:s,cwd:n,execPath:o}):s},Aa=(t,e,r={})=>{let n=Ho.default._parse(t,e,r);return t=n.command,e=n.args,r=n.options,r={maxBuffer:ka,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||ut.default.cwd(),execPath:ut.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...r},r.env=$a(r),r.stdio=ho(r),ut.default.platform==="win32"&&Wo.default.basename(t,".exe")==="cmd"&&e.unshift("/q"),{file:t,args:e,options:r,parsed:n}},Rr=(t,e,r)=>typeof e!="string"&&!zo.Buffer.isBuffer(e)?r===void 0?void 0:"":t.stripFinalNewline?Er(e):e;function jo(t,e,r){let n=Aa(t,e,r),o=Bo(t,e),s=Go(t,e);Co(n.options);let i;try{i=Or.default.spawn(n.file,n.args,n.options)}catch(S){let I=new Or.default.ChildProcess,P=Promise.reject(Ir({error:S,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return Lr(I,P)}let a=Vo(i),c=Po(i,n.options,a),d=ko(i,n.options,c),E={isCanceled:!1};i.kill=Io.bind(null,i.kill.bind(i)),i.cancel=To.bind(null,i,E);let w=io(async()=>{let[{error:S,exitCode:I,signal:P,timedOut:T},C,l,y]=await Uo(i,n.options,d),b=Rr(n.options,C),R=Rr(n.options,l),V=Rr(n.options,y);if(S||I!==0||P!==null){let ne=Ir({error:S,exitCode:I,signal:P,stdout:b,stderr:R,all:V,command:o,escapedCommand:s,parsed:n,timedOut:T,isCanceled:E.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:i.killed});if(!n.options.reject)return ne;throw ne}return{command:o,escapedCommand:s,exitCode:0,stdout:b,stderr:R,all:V,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return No(i,n.options.input),i.all=Fo(i,n.options),Lr(i,w)}var re=require("fs");var La=require("@raycast/api"),Yo=require("crypto");var Ko="foobarbazzybaz";function qo(t){return Object.entries(t).flatMap(([e,r])=>{switch(typeof r){case"boolean":return r?[`--${e}`]:[];case"string":return[`--${e}`,r];default:return[]}})}function Dr(t){return new Promise((e,r)=>{(0,Yo.pbkdf2)(t,Ko,1e5,64,"sha512",(n,o)=>{if(n!=null){r(n);return}e(o.toString("hex"))})})}var _r=require("@raycast/api");var Ra={IMMEDIATELY:"0",ONE_MINUTE:"60000",FIVE_MINUTES:"300000",FIFTEEN_MINUTES:"900000",THIRTY_MINUTES:"1800000",ONE_HOUR:"3600000",FOUR_HOURS:"14400000",EIGHT_HOURS:"28800000",ONE_DAY:"86400000",NEVER:"-1",SYSTEM_LOCK:"-2",SYSTEM_SLEEP:"-3"},J=Object.entries(Ra).reduce((t,[e,r])=>(t[e]=parseInt(r),t),{});var Zo={[J.IMMEDIATELY]:"Immediately",[J.ONE_MINUTE]:"1 Minute",[J.FIVE_MINUTES]:"5 Minutes",[J.FIFTEEN_MINUTES]:"15 Minutes",[J.THIRTY_MINUTES]:"30 Minutes",[J.ONE_HOUR]:"1 Hour",[J.FOUR_HOURS]:"4 Hours",[J.EIGHT_HOURS]:"8 Hours",[J.ONE_DAY]:"1 Day"};var nu={1:"Login",3:"Card",4:"Identity",2:"Secure Note",5:"SSH Key"};function Mt(){let{serverUrl:t}=(0,_r.getPreferenceValues)();return!t||t==="bitwarden.com"||t==="https://bitwarden.com"?void 0:t}function Jo(t){return Zo[t]}var pe=class extends Error{constructor(e,r){super(e),this.stack=r}},dt=class extends pe{constructor(e,r){super(e,r)}};var Se=class extends dt{constructor(e,r){super(e??"Bitwarden CLI not found",r),this.name="InstalledCLINotFoundError",this.stack=r}};var Bt=class extends dt{constructor(e,r){super(e??"Vault is locked",r),this.name="VaultIsLockedError"}},ft=class extends pe{constructor(e,r){super(e??"Not logged in",r),this.name="NotLoggedInError"}},Fe=class extends dt{constructor(e,r){super(e??"Failed do download Bitwarden CLI",r),this.name="EnsureCliBinError"}},Je=class extends pe{constructor(e,r){super(e??"Premium status is required to use this feature",r),this.name="PremiumFeatureError"}},mt=class extends pe{constructor(e,r){super(e??"This Send has a is protected by a password",r),this.name="SendNeedsPasswordError"}},pt=class extends pe{constructor(e,r){super(e??"The password you entered is invalid",r),this.name="SendInvalidPasswordError"}};function be(t,e){try{return t()}catch{return e}}var Gt=t=>{if(t){if(typeof t=="string")return t;if(t instanceof Error){let{message:e,name:r}=t;return t.stack?t.stack:`${r}: ${e}`}return String(t)}};var Pe=require("path"),Ce=require("fs/promises");var he=require("fs"),Ht=require("fs/promises"),os=require("path"),ss=Y(ns());function jt(t){return new Promise((e,r)=>{let n=setInterval(()=>{if(!(0,he.existsSync)(t))return;(0,he.statSync)(t).isFile()&&(clearInterval(n),e())},300);setTimeout(()=>{clearInterval(n),r(new Error(`File ${t} not found.`))},5e3)})}async function is(t,e){let r=new ss.default.async({file:t});(0,he.existsSync)(e)||(0,he.mkdirSync)(e,{recursive:!0}),await r.extract(null,e),await r.close()}async function as(t,e){let r=!1;try{let n=await(0,Ht.readdir)(e);for await(let o of n)o.startsWith(t)&&await be(async()=>{await(0,Ht.unlink)((0,os.join)(e,o)),r=!0})}catch{return!1}return r}function cs(...t){for(let e of t)be(()=>(0,he.unlinkSync)(e))}var et=require("fs"),Hr=Y(require("http")),Kt=Y(require("https"));var zr=require("@raycast/api");var ls=require("@raycast/api"),Da={logs:new Map,set:(t,e)=>{Qe.logs.set(new Date,{message:t,error:e})},clear:()=>Qe.logs.clear(),toString:()=>{let t="";return Qe.logs.forEach((e,r)=>{t.length>0&&(t+=`

`),t+=`[${r.toISOString()}] ${e.message}`,e.error&&(t+=`: ${Gt(e.error)}`)}),t}},Qe=Object.freeze(Da),v=(t,e,r)=>{let{captureToRaycast:n=!1}=r??{},o=Array.isArray(t)?t.filter(Boolean).join(" "):t||"Captured exception";Qe.set(o,e),zr.environment.isDevelopment?console.error(o,e):n&&(0,ls.captureException)(e)},us=(...t)=>{zr.environment.isDevelopment&&console.debug(...t)};var ds=require("fs"),fs=require("crypto");function Wr(t){try{return(0,fs.createHash)("sha256").update((0,ds.readFileSync)(t)).digest("hex")}catch{return null}}function jr(t,e,r){let{onProgress:n,sha256:o}=r??{};return new Promise((s,i)=>{let a=new URL(t),c=a.protocol==="https:"?Kt.default:Hr.default,d=new(c===Kt.default?Kt.default:Hr.default).Agent({keepAlive:!1}),E=0,x=c.get(a.href,{agent:d},w=>{if(w.statusCode&&w.statusCode>=300&&w.statusCode<400){x.destroy(),w.destroy();let l=w.headers.location;if(!l){i(new Error("Redirect response without location header"));return}if(++E>=10){i(new Error("Too many redirects"));return}jr(l,e,r).then(s).catch(i);return}if(w.statusCode!==200){i(new Error(`Response status ${w.statusCode}: ${w.statusMessage}`));return}let S=parseInt(w.headers["content-length"]||"0",10);if(S===0){i(new Error("Invalid file size"));return}let I=(0,et.createWriteStream)(e,{autoClose:!0}),P=0,T=()=>{x.destroy(),w.destroy(),I.close()},C=l=>{T(),i(l)};w.on("data",l=>{P+=l.length;let y=Math.floor(P/S*100);n?.(y)}),I.on("finish",async()=>{try{await jt(e),o&&await _a(e,o),s()}catch(l){i(l)}finally{T()}}),I.on("error",l=>{v(`File stream error while downloading ${t}`,l),(0,et.unlink)(e,()=>C(l))}),w.on("error",l=>{v(`Response error while downloading ${t}`,l),(0,et.unlink)(e,()=>C(l))}),x.on("error",l=>{v(`Request error while downloading ${t}`,l),(0,et.unlink)(e,()=>C(l))}),w.pipe(I)})})}function _a(t,e){return new Promise((r,n)=>{let o=Wr(t);if(!o)return n(new Error(`Could not generate hash for file ${t}.`));if(o===e)return r();let s=setInterval(()=>{Wr(t)===e&&(clearInterval(s),clearTimeout(i),r())},1e3),i=setTimeout(()=>{clearInterval(s),n(new Error(`Hash did not match, expected ${e.substring(0,7)}, got ${o.substring(0,7)}.`))},5e3)})}var tt=(a=>(a.OneHour="1 hour",a.OneDay="1 day",a.TwoDays="2 days",a.ThreeDays="3 days",a.SevenDays="7 days",a.ThirtyDays="30 days",a.Custom="Custom",a))(tt||{});function ms(t,e){return{...t,...e,file:e.file?{...t.file,...e.file}:t.file,text:e.text?{...t.text,...e.text}:t.text}}var ps=require("@raycast/api"),ge=new ps.Cache({namespace:"bw-cache"});var B=process.platform==="darwin"?"macos":"windows";var{supportPath:Te}=G.environment,Na="5",Yt=(()=>{let t=(0,Pe.join)(Te,`bw-bin-download-error-${Na}.log`);return{logError:e=>be(()=>(0,re.writeFileSync)(t,e?.message??"Unexpected error")),clearError:()=>be(()=>(0,re.unlinkSync)(t)),hasError:()=>be(()=>(0,re.existsSync)(t),!1)}})(),te={version:"2025.11.0",get sha256(){return B==="windows"?"0484bae6306762881678097406d6bf00a58e291720dbc7d62f044e5f4d8286ed":process.arch==="arm64"?"59eac955be7b15bfc21c81101a194a9fbba32f48a61154b4f4b6e007efab6fd6":"213108a65eeb7294ffcd7303f8fe5308dc2af970735aefeb4d23fc9753a2ac01"},downloadPage:"https://github.com/bitwarden/clients/releases",path:{get downloadedBin(){return(0,Pe.join)(Te,te.binFilenameVersioned)},get installedBin(){return B==="windows"?"C:\\ProgramData\\chocolatey\\bin\\bw.exe":process.arch==="arm64"?"/opt/homebrew/bin/bw":"/usr/local/bin/bw"},get bin(){return Yt.hasError()?this.installedBin:this.downloadedBin}},get binFilename(){return B==="windows"?"bw.exe":"bw"},get binFilenameVersioned(){let t=`bw-${this.version}`;return B==="windows"?`${t}.exe`:`${t}`},get downloadUrl(){let t="";return B==="macos"&&(t=process.arch==="arm64"?"-arm64":""),`${this.downloadPage}/download/cli-v${this.version}/bw-${B}${t}-${this.version}.zip`}},qt=class{constructor(e){this.actionListeners=new Map;this.preferences=(0,G.getPreferenceValues)();this.wasCliUpdated=!1;this.showToast=async e=>{if(this.toastInstance){let r={message:this.toastInstance.message,title:this.toastInstance.title,primaryAction:this.toastInstance.primaryAction,secondaryAction:this.toastInstance.secondaryAction};return e.style&&(this.toastInstance.style=e.style),this.toastInstance.message=e.message,this.toastInstance.title=e.title,this.toastInstance.primaryAction=e.primaryAction,this.toastInstance.secondaryAction=e.secondaryAction,await this.toastInstance.show(),Object.assign(this.toastInstance,{restore:async()=>{await this.showToast(r)}})}else{let r=await(0,G.showToast)(e);return Object.assign(r,{restore:()=>r.hide()})}};let{cliPath:r,clientId:n,clientSecret:o,serverCertsPath:s}=this.preferences,i=Mt();this.toastInstance=e,this.cliPath=r||te.path.bin,this.env={BITWARDENCLI_APPDATA_DIR:Te,BW_CLIENTSECRET:o.trim(),BW_CLIENTID:n.trim(),PATH:(0,Pe.dirname)(process.execPath),...i&&s?{NODE_EXTRA_CA_CERTS:s}:{}},this.initPromise=(async()=>{await this.ensureCliBinary(),this.retrieveAndCacheCliVersion(),await this.checkServerUrl(i)})()}async ensureCliBinary(){if(this.checkCliBinIsReady(this.cliPath))return;if(this.cliPath===this.preferences.cliPath||this.cliPath===te.path.installedBin)throw new Se(`Bitwarden CLI not found at ${this.cliPath}`);Yt.hasError()&&Yt.clearError();let e=await as("bw-",Te),r=await this.showToast({title:`${e?"Updating":"Initializing"} Bitwarden CLI`,style:G.Toast.Style.Animated,primaryAction:{title:"Open Download Page",onAction:()=>(0,G.open)(te.downloadPage)}}),o=(0,Pe.join)(Te,"bw.zip");try{try{r.message="Downloading...",await jr(te.downloadUrl,o,{onProgress:s=>r.message=`Downloading ${s}%`,sha256:te.sha256})}catch(s){throw r.title="Failed to download Bitwarden CLI",s}try{r.message="Extracting...",await is(o,Te);let s=(0,Pe.join)(Te,te.binFilename);await(0,Ce.rename)(s,this.cliPath).catch(()=>null),await jt(this.cliPath),await(0,Ce.chmod)(this.cliPath,"755"),await(0,Ce.rm)(o,{force:!0}),ge.set(de.CLI_VERSION,te.version),this.wasCliUpdated=!0;let i=(0,Pe.join)(Te,"data.json");await be(()=>(0,Ce.unlink)(i))}catch(s){throw r.title="Failed to extract Bitwarden CLI",s}await r.hide()}catch(s){throw r.message=s instanceof Fe?s.message:"Please try again",r.style=G.Toast.Style.Failure,cs(o,this.cliPath),G.environment.isDevelopment||Yt.logError(s),s instanceof Error?new Fe(s.message,s.stack):s}finally{await r.restore()}}async retrieveAndCacheCliVersion(){try{let{error:e,result:r}=await this.getVersion();e||ge.set(de.CLI_VERSION,r)}catch(e){v("Failed to retrieve and cache cli version",e,{captureToRaycast:!0})}}checkCliBinIsReady(e){try{return(0,re.existsSync)(this.cliPath)?((0,re.accessSync)(e,re.constants.X_OK),!0):!1}catch{return(0,re.chmodSync)(e,"755"),!0}}setSessionToken(e){this.env={...this.env,BW_SESSION:e}}clearSessionToken(){delete this.env.BW_SESSION}withSession(e){return this.tempSessionToken=e,this}async initialize(){return await this.initPromise,this}async checkServerUrl(e){let r=await G.LocalStorage.getItem(F.SERVER_URL);if(!e||r===e)return;let n=await this.showToast({style:G.Toast.Style.Animated,title:"Switching server...",message:"Bitwarden server preference changed"});try{try{await this.logout()}catch{}await this.exec(["config","server",e||pn],{resetVaultTimeout:!1}),await G.LocalStorage.setItem(F.SERVER_URL,e),n.style=G.Toast.Style.Success,n.title="Success",n.message="Bitwarden server changed"}catch(o){n.style=G.Toast.Style.Failure,n.title="Failed to switch server",o instanceof Error?n.message=o.message:n.message="Unknown error occurred"}finally{await n.restore()}}async exec(e,r){let{abortController:n,input:o="",resetVaultTimeout:s,env:i}=r??{},a=this.env;this.tempSessionToken&&(a={...a,BW_SESSION:this.tempSessionToken},this.tempSessionToken=void 0),i&&(a={...a,...i});let c=await jo(this.cliPath,e,{input:o,env:a,signal:n?.signal});if(this.isPromptWaitingForMasterPassword(c))throw await this.lock(),new Bt;return s&&await G.LocalStorage.setItem(F.LAST_ACTIVITY_TIME,new Date().toISOString()),c}async getVersion(){try{let{stdout:e}=await this.exec(["--version"],{resetVaultTimeout:!1});return{result:e}}catch(e){v("Failed to get cli version",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async login(){try{return await this.exec(["login","--apikey"],{resetVaultTimeout:!0}),await this.saveLastVaultStatus("login","unlocked"),await this.callActionListeners("login"),{result:void 0}}catch(e){v("Failed to login",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async logout(e){let{reason:r,immediate:n=!1}=e??{};try{return n&&await this.handlePostLogout(r),await this.exec(["logout"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("logout","unauthenticated"),n||await this.handlePostLogout(r),{result:void 0}}catch(o){v("Failed to logout",o);let{error:s}=await this.handleCommonErrors(o);if(!s)throw o;return{error:s}}}async lock(e){let{reason:r,checkVaultStatus:n=!1,immediate:o=!1}=e??{};try{if(o&&await this.callActionListeners("lock",r),n){let{error:s,result:i}=await this.status();if(s)throw s;if(i.status==="unauthenticated")return{error:new ft("Not logged in")}}return await this.exec(["lock"],{resetVaultTimeout:!1}),this.clearSessionToken(),await this.saveLastVaultStatus("lock","locked"),o||await this.callActionListeners("lock",r),{result:void 0}}catch(s){v("Failed to lock vault",s);let{error:i}=await this.handleCommonErrors(s);if(!i)throw s;return{error:i}}}async unlock(e){try{this.clearSessionToken();let n=(await this.exec(["unlock","--passwordenv","BW_PASSWORD","--raw"],{resetVaultTimeout:!0,env:{BW_PASSWORD:e}})).stdout;if(!n.trim())throw new Error("Invalid session token");return this.setSessionToken(n),await this.saveLastVaultStatus("unlock","unlocked"),await this.callActionListeners("unlock",e,n),{result:n}}catch(r){v("Failed to unlock vault",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async sync(){try{return await this.exec(["sync"],{resetVaultTimeout:!0}),{result:void 0}}catch(e){v("Failed to sync vault",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async getItem(e){try{let{stdout:r}=await this.exec(["get","item",e],{resetVaultTimeout:!0});return{result:JSON.parse(r)}}catch(r){v("Failed to get item",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async listItems(){try{let{stdout:e}=await this.exec(["list","items"],{resetVaultTimeout:!0});return{result:JSON.parse(e).filter(n=>!!n.name)}}catch(e){v("Failed to list items",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createLoginItem(e){try{let{error:r,result:n}=await this.getTemplate("item");if(r)throw r;let{error:o,result:s}=await this.getTemplate("item.login");if(o)throw o;n.name=e.name,n.type=1,n.folderId=e.folderId||null,n.login=s,n.notes=null,s.username=e.username||null,s.password=e.password,s.totp=null,s.fido2Credentials=void 0,e.uri&&(s.uris=[{match:null,uri:e.uri}]);let{result:i,error:a}=await this.encode(JSON.stringify(n));if(a)throw a;let{stdout:c}=await this.exec(["create","item",i],{resetVaultTimeout:!0});return{result:JSON.parse(c)}}catch(r){v("Failed to create login item",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async listFolders(){try{let{stdout:e}=await this.exec(["list","folders"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){v("Failed to list folder",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createFolder(e){try{let{error:r,result:n}=await this.getTemplate("folder");if(r)throw r;n.name=e;let{result:o,error:s}=await this.encode(JSON.stringify(n));if(s)throw s;return await this.exec(["create","folder",o],{resetVaultTimeout:!0}),{result:void 0}}catch(r){v("Failed to create folder",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async getTotp(e){try{let{stdout:r}=await this.exec(["get","totp",e],{resetVaultTimeout:!0});return{result:r}}catch(r){v("Failed to get TOTP",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async status(){try{let{stdout:e}=await this.exec(["status"],{resetVaultTimeout:!1});return{result:JSON.parse(e)}}catch(e){v("Failed to get status",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async checkLockStatus(){try{return await this.exec(["unlock","--check"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("checkLockStatus","unlocked"),"unlocked"}catch(e){return v("Failed to check lock status",e),e.stderr==="Vault is locked."?(await this.saveLastVaultStatus("checkLockStatus","locked"),"locked"):(await this.saveLastVaultStatus("checkLockStatus","unauthenticated"),"unauthenticated")}}async getTemplate(e){try{let{stdout:r}=await this.exec(["get","template",e],{resetVaultTimeout:!0});return{result:JSON.parse(r)}}catch(r){v("Failed to get template",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async encode(e){try{let{stdout:r}=await this.exec(["encode"],{input:e,resetVaultTimeout:!1});return{result:r}}catch(r){v("Failed to encode",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async generatePassword(e,r){let n=e?qo(e):[],{stdout:o}=await this.exec(["generate",...n],{abortController:r,resetVaultTimeout:!1});return o}async listSends(){try{let{stdout:e}=await this.exec(["send","list"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){v("Failed to list sends",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createSend(e){try{let{error:r,result:n}=await this.getTemplate(e.type===0?"send.text":"send.file");if(r)throw r;let o=ms(n,e),{result:s,error:i}=await this.encode(JSON.stringify(o));if(i)throw i;let{stdout:a}=await this.exec(["send","create",s],{resetVaultTimeout:!0});return{result:JSON.parse(a)}}catch(r){v("Failed to create send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async editSend(e){try{let{result:r,error:n}=await this.encode(JSON.stringify(e));if(n)throw n;let{stdout:o}=await this.exec(["send","edit",r],{resetVaultTimeout:!0});return{result:JSON.parse(o)}}catch(r){v("Failed to delete send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async deleteSend(e){try{return await this.exec(["send","delete",e],{resetVaultTimeout:!0}),{result:void 0}}catch(r){v("Failed to delete send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async removeSendPassword(e){try{return await this.exec(["send","remove-password",e],{resetVaultTimeout:!0}),{result:void 0}}catch(r){v("Failed to remove send password",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async receiveSendInfo(e,r){try{let{stdout:n,stderr:o}=await this.exec(["send","receive",e,"--obj"],{resetVaultTimeout:!0,input:r?.password});return!n&&/Invalid password/i.test(o)?{error:new pt}:!n&&/Send password/i.test(o)?{error:new mt}:{result:JSON.parse(n)}}catch(n){let o=n.stderr;if(/Invalid password/gi.test(o))return{error:new pt};if(/Send password/gi.test(o))return{error:new mt};v("Failed to receive send obj",n);let{error:s}=await this.handleCommonErrors(n);if(!s)throw n;return{error:s}}}async receiveSend(e,r){try{let{savePath:n,password:o}=r??{},s=["send","receive",e];n&&s.push("--output",n);let{stdout:i}=await this.exec(s,{resetVaultTimeout:!0,input:o});return{result:i}}catch(n){v("Failed to receive send",n);let{error:o}=await this.handleCommonErrors(n);if(!o)throw n;return{error:o}}}async saveLastVaultStatus(e,r){await G.LocalStorage.setItem(F.VAULT_LAST_STATUS,r)}async getLastSavedVaultStatus(){let e=await G.LocalStorage.getItem(F.VAULT_LAST_STATUS);return e||(await this.status()).result?.status}isPromptWaitingForMasterPassword(e){return!!(e.stderr&&e.stderr.includes("Master password"))}async handlePostLogout(e){this.clearSessionToken(),await this.callActionListeners("logout",e)}async handleCommonErrors(e){let r=e.stderr;return r?/not logged in/i.test(r)?(await this.handlePostLogout(),{error:new ft("Not logged in")}):/Premium status/i.test(r)?{error:new Je}:{}:{}}setActionListener(e,r){let n=this.actionListeners.get(e);return n&&n.size>0?n.add(r):this.actionListeners.set(e,new Set([r])),this}removeActionListener(e,r){let n=this.actionListeners.get(e);return n&&n.size>0&&n.delete(r),this}async callActionListeners(e,...r){let n=this.actionListeners.get(e);if(n&&n.size>0)for(let o of n)try{await o?.(...r)}catch(s){if(v(`Error calling bitwarden action listener for ${e}`,s),e==="unlock")throw s}}};var hs=require("@raycast/api"),ys=require("react/jsx-runtime"),gs=()=>(0,ys.jsx)(hs.Form,{isLoading:!0});var ue=require("@raycast/api");var ws=require("@raycast/api"),Ss=require("react/jsx-runtime"),Yr="https://github.com/raycast/extensions/issues/new?assignees=&labels=extension%2Cbug&template=extension_bug_report.yml&title=%5BBitwarden%5D+...";function Fa(){return(0,Ss.jsx)(ws.Action.OpenInBrowser,{title:"Open Bug Report",url:Yr})}var ht=Fa;var ke=require("react/jsx-runtime"),Ua=`

`,qr="https://bitwarden.com/help/cli/#download-and-install",Va=t=>`\`\`\`
${t}
\`\`\``,Ma=({error:t})=>{let e=Gt(t),r=(0,ue.getPreferenceValues)().cliPath,n=t instanceof Fe,o=r||t instanceof Se,s=[];if(o&&!n?s.push("# \u26A0\uFE0F Bitwarden CLI not found"):s.push("# \u{1F4A5} Whoops! Something went wrong"),n)s.push(`We couldn't download the [Bitwarden CLI](${qr}), you can always install it on your machine.`);else if(o){let i=r?` (${r})`:"";s.push(`We couldn't find the [Bitwarden CLI](${qr}) installed on your machine${i}.`)}else s.push(`The \`${ue.environment.commandName}\` command crashed when we were not expecting it to.`);if(s.push("> Please read the `Setup` section in the [extension's description](https://www.raycast.com/jomifepe/bitwarden) to ensure that everything is properly configured."),s.push(`**Try restarting the command. If the issue persists, consider [reporting a bug on GitHub](${Yr}) to help us fix it.**`),e){let i=/incompatible architecture/gi.test(e);s.push(">## Technical details \u{1F913}",i&&`\u26A0\uFE0F We suspect that your Bitwarden CLI was installed using a version of NodeJS that's incompatible with your system architecture (e.g. x64 NodeJS on a M1/Apple Silicon Mac). Please make sure your have the correct versions of your software installed (e.g., ${B==="macos"?"Homebrew, ":""}NodeJS, and Bitwarden CLI).`,Va(e))}return(0,ke.jsx)(ue.Detail,{markdown:s.filter(Boolean).join(Ua),actions:(0,ke.jsxs)(ue.ActionPanel,{children:[(0,ke.jsxs)(ue.ActionPanel.Section,{title:"Bug Report",children:[(0,ke.jsx)(ht,{}),(0,ke.jsx)(yt,{})]}),o&&(0,ke.jsx)(ue.Action.OpenInBrowser,{title:"Open Installation Guide",url:qr})]})})},gt=Ma;var Zt=require("react");function Ba(t,e){let r=(0,Zt.useRef)(!1);(0,Zt.useEffect)(()=>{r.current||e!==void 0&&!e||(r.current=!0,t())},[e])}var $e=Ba;var Jt=require("react/jsx-runtime"),bs=(0,Ue.createContext)(null),Xt=({children:t,loadingFallback:e=(0,Jt.jsx)(gs,{})})=>{let[r,n]=(0,Ue.useState)(),[o,s]=(0,Ue.useState)();$e(()=>{new qt().initialize().then(n).catch(i)});function i(a){if(a instanceof Se)s(a);else throw a}return o?(0,Jt.jsx)(gt,{error:o}):r?(0,Jt.jsx)(bs.Provider,{value:r,children:t}):e},ie=()=>{let t=(0,Ue.useContext)(bs);if(t==null)throw new Error("useBitwarden must be used within a BitwardenProvider");return t};function Es(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function xs(t,e){try{let r=t,n;return r?.stderr?n=r.stderr:t instanceof Error?n=`${t.name}: ${t.message}`:Es(t)?n=JSON.stringify(t):n=`${t}`,n?e?.omitSensitiveValue?Ga(n,e.omitSensitiveValue):n:""}catch{return""}}function Ga(t,e){return t.replace(new RegExp(e,"i"),"[REDACTED]")}var fe=require("@raycast/api"),Qt=require("react");function za(){let t=ie(),[e,r]=(0,Qt.useState)(null);(0,Qt.useEffect)(()=>{t.status().then(({error:i,result:a})=>{i||r(a)}).catch(()=>{})},[]);let n=!!Mt(),o="...",s="...";if(e){let{status:i,userEmail:a,serverUrl:c}=e;o=i=="unauthenticated"?"\u274C Logged out":`\u{1F512} Locked (${a})`,c?s=c||"":(!c&&n||c&&!n)&&(0,fe.confirmAlert)({icon:fe.Icon.ExclamationMark,title:"Restart Required",message:"Bitwarden server URL preference has been changed since the extension was opened.",primaryAction:{title:"Close Extension"},dismissAction:{title:"Close Raycast",style:fe.Alert.ActionStyle.Cancel}}).then(d=>{d?(0,fe.popToRoot)():(0,fe.closeMainWindow)()})}return{userMessage:o,serverMessage:s,shouldShowServer:n}}var vs=za;var er=require("@raycast/api");function Is(t,e){let{data:r,revalidate:n,isLoading:o}=$t(()=>er.LocalStorage.getItem(t));return[r??e,{isLoading:o,set:async a=>{await er.LocalStorage.setItem(t,a),await n()},remove:async()=>{await er.LocalStorage.removeItem(t),await n()}}]}var W=require("react/jsx-runtime"),Wa=({pendingAction:t=Promise.resolve()})=>{let e=ie(),{userMessage:r,serverMessage:n,shouldShowServer:o}=vs(),[s,i]=(0,wt.useState)(!1),[a,c]=(0,wt.useState)(),[d,E]=(0,wt.useState)(!1),[x,w]=(0,wt.useState)(""),[S,{remove:I}]=Is(F.VAULT_LOCK_REASON);async function P(){if(x.length!==0)try{i(!0),c(void 0),await t;let b=await(0,O.showToast)({title:"Validating...",message:"Please wait",style:O.Toast.Style.Animated}),{error:R,result:V}=await e.status();if(R)throw R;if(V.status==="unauthenticated")try{b.title="Logging in...";let{error:ce}=await e.login();if(ce)throw ce}catch(ce){return T(ce,{title:"Failed to log in",fallbackMessage:`Please check your ${o?"Server URL, ":""}API Key and Secret.`})}b.title="Unlocking vault...";let{error:ne}=await e.unlock(x);if(ne)return T(ne,{title:"Failed to unlock vault",fallbackMessage:"Please check your credentials"});b.title="Vault unlocked",b.style=O.Toast.Style.Success,b.message=void 0,await I()}catch(b){await T(b,{title:"Failed to unlock vault",fallbackMessage:"Please check your credentials"})}finally{i(!1)}}async function T(b,R){let{title:V,fallbackMessage:ne}=R,{displayableError:ce=ne,treatedError:Oe}=ja(b,x);c(Oe),await(0,O.showToast)({title:V,message:ce,style:O.Toast.Style.Failure,primaryAction:{title:"Copy Error",onAction:C}}),v("Failed to unlock vault",b)}let C=async()=>{a&&(await O.Clipboard.copy(a),await(0,O.showToast)(O.Toast.Style.Success,"Error copied to clipboard"))},l=O.Form.PasswordField,y="password";return d&&(l=O.Form.TextField,y="plainPassword"),(0,W.jsxs)(O.Form,{actions:(0,W.jsxs)(O.ActionPanel,{children:[!s&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(O.Action.SubmitForm,{icon:O.Icon.LockUnlocked,title:"Submit",onSubmit:P}),(0,W.jsx)(O.Action,{icon:d?O.Icon.EyeDisabled:O.Icon.Eye,title:d?"Hide Password":"Show Password",onAction:()=>E(b=>!b),shortcut:{macOS:{key:"e",modifiers:["opt"]},Windows:{key:"e",modifiers:["alt"]}}})]}),a&&(0,W.jsx)(O.Action,{onAction:C,title:"Copy Last Error",icon:O.Icon.Bug,style:O.Action.Style.Destructive}),(0,W.jsx)(Ae,{})]}),children:[o&&(0,W.jsx)(O.Form.Description,{title:"Server URL",text:n}),(0,W.jsx)(O.Form.Description,{title:"Vault Status",text:r}),(0,W.jsx)(l,{id:y,title:"Master Password",value:x,onChange:w,ref:b=>b?.focus()}),(0,W.jsx)(O.Form.Description,{title:"",text:`Press ${B==="macos"?"\u2325":"Alt"}+E to ${d?"hide":"show"} password`}),!!S&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(O.Form.Description,{title:"\u2139\uFE0F",text:S}),(0,W.jsx)(Ha,{})]})]})};function Ha(){let t=(0,O.getPreferenceValues)().repromptIgnoreDuration,e=Jo(t);return e?(0,W.jsx)(O.Form.Description,{title:"",text:`Timeout is set to ${e}, this can be configured in the extension settings`}):null}function ja(t,e){let r=xs(t,{omitSensitiveValue:e}),n;return/Invalid master password/i.test(r)?n="Invalid master password":/Invalid API Key/i.test(r)&&(n="Invalid Client ID or Secret"),{displayableError:n,treatedError:r}}var Ts=Wa;var Ps=require("@raycast/api"),ks=require("react/jsx-runtime"),Cs=()=>(0,ks.jsx)(Ps.List,{searchBarPlaceholder:"Search vault",isLoading:!0});var $s=require("react"),Ka={token:void 0,passwordHash:void 0,isLoading:!0,isLocked:!1,isAuthenticated:!1},As=()=>(0,$s.useReducer)((t,e)=>{switch(e.type){case"loadState":{let{type:r,...n}=e;return{...t,...n}}case"lock":return{...t,token:void 0,passwordHash:void 0,isLoading:!1,isLocked:!0};case"unlock":return{...t,token:e.token,passwordHash:e.passwordHash,isLocked:!1,isAuthenticated:!0};case"logout":return{...t,token:void 0,passwordHash:void 0,isLocked:!0,isAuthenticated:!1,isLoading:!1};case"vaultTimeout":return{...t,isLocked:!0};case"finishLoadingSavedState":{if(!t.token||!t.passwordHash)throw new Error("Missing required fields: token, passwordHash");let r=!!t.token;return{...t,isLoading:!1,isLocked:!r,isAuthenticated:r}}case"failLoadingSavedState":return{...t,isLoading:!1,isLocked:!0};default:return t}},Ka);var ae=require("@raycast/api");var Ls=require("child_process"),Rs=require("util");var Ya=(0,Rs.promisify)(Ls.exec),St={getSavedSession:()=>Promise.all([ae.LocalStorage.getItem(F.SESSION_TOKEN),ae.LocalStorage.getItem(F.REPROMPT_HASH),ae.LocalStorage.getItem(F.LAST_ACTIVITY_TIME),ae.LocalStorage.getItem(F.VAULT_LAST_STATUS)]),clearSession:async()=>{await Promise.all([ae.LocalStorage.removeItem(F.SESSION_TOKEN),ae.LocalStorage.removeItem(F.REPROMPT_HASH)])},saveSession:async(t,e)=>{await Promise.all([ae.LocalStorage.setItem(F.SESSION_TOKEN,t),ae.LocalStorage.setItem(F.REPROMPT_HASH,e)])},logoutClearSession:async()=>{await Promise.all([ae.LocalStorage.removeItem(F.SESSION_TOKEN),ae.LocalStorage.removeItem(F.REPROMPT_HASH),ae.LocalStorage.removeItem(F.LAST_ACTIVITY_TIME)])}},Os=t=>Ns(t,e=>_s(e,"handleUnlockResult")),Ds=t=>Ns(t,e=>_s(e,"sleep 0"));function _s(t,e){return Ya(`log show --style syslog --predicate "process == 'loginwindow'" --info --last ${t}h | grep "${e}" | tail -n 1`)}async function Ns(t,e){let r=await Fs(e);return r?new Date(r).getTime()>t.getTime():!0}var qa=2,Za=5;async function Fs(t,e=1,r=0){try{if(r>Za){us("Max retry attempts reached to get last screen lock time");return}let{stdout:n,stderr:o}=await t(e),[s,i]=n?.split(" ")??[];if(o||!s||!i)return Fs(t,e+qa,r+1);let a=new Date(`${s}T${i}`);return!a||a.toString()==="Invalid Date"?void 0:a}catch(n){v("Failed to get last screen lock time",n);return}}var tr=require("react/jsx-runtime"),Ja=(0,Ve.createContext)(null);function Et(t){let{children:e,loadingFallback:r=(0,tr.jsx)(Cs,{}),unlock:n}=t,o=ie(),[s,i]=As(),a=(0,Ve.useRef)(Promise.resolve());$e(c,o);async function c(){try{o.setActionListener("lock",E).setActionListener("unlock",d).setActionListener("logout",x);let[T,C,l,y]=await St.getSavedSession();if(!T||!C)throw new Le;if(i({type:"loadState",token:T,passwordHash:C}),o.setSessionToken(T),o.wasCliUpdated)throw new bt(We.CLI_UPDATED);if(y==="locked")throw new Le;if(y==="unauthenticated")throw new bt;if(l){let b=new Date(l),R=+(0,rt.getPreferenceValues)().repromptIgnoreDuration;if(B==="macos"&&R===J.SYSTEM_LOCK){if(await Os(b))throw new Le(We.SYSTEM_LOCK)}else if(B==="macos"&&R===J.SYSTEM_SLEEP){if(await Ds(b))throw new Le(We.SYSTEM_SLEEP)}else if(R!==J.NEVER){let V=Date.now()-b.getTime();if(R===J.IMMEDIATELY||V>=R)throw new Le(We.TIMEOUT)}}i({type:"finishLoadingSavedState"})}catch(T){T instanceof Le?a.current=o.lock({reason:T.message,immediate:!0,checkVaultStatus:!0}):T instanceof bt?a.current=o.logout({reason:T.message,immediate:!0}):(a.current=o.lock({immediate:!0}),i({type:"failLoadingSavedState"}),v("Failed to bootstrap session state",T))}}async function d(T,C){let l=await Dr(T);await St.saveSession(C,l),await rt.LocalStorage.removeItem(F.VAULT_LOCK_REASON),i({type:"unlock",token:C,passwordHash:l})}async function E(T){await Xa(),T&&await rt.LocalStorage.setItem(F.VAULT_LOCK_REASON,T),i({type:"lock"})}async function x(T){await Qa(),T&&await rt.LocalStorage.setItem(F.VAULT_LOCK_REASON,T),i({type:"logout"})}async function w(T){return await Dr(T)===s.passwordHash}let S=(0,Ve.useMemo)(()=>({token:s.token,isLoading:s.isLoading,isAuthenticated:s.isAuthenticated,isLocked:s.isLocked,active:!s.isLoading&&s.isAuthenticated&&!s.isLocked,confirmMasterPassword:w}),[s,w]);if(s.isLoading)return r;let I=s.isLocked||!s.isAuthenticated,P=s.token?e:null;return(0,tr.jsx)(Ja.Provider,{value:S,children:I&&n?(0,tr.jsx)(Ts,{pendingAction:a.current}):P})}async function Xa(){await St.clearSession()}async function Qa(){await St.logoutClearSession(),ge.clear()}var Le=class extends Error{constructor(e){super(e)}},bt=class extends Error{constructor(e){super(e)}};var tc=require("react/jsx-runtime");var nc=require("react/jsx-runtime");var K=require("@raycast/api");var Us=require("child_process"),Vs=require("util");var Jr=require("fs"),Ms=require("path");var Bs=require("react/jsx-runtime"),oc=(0,Vs.promisify)(Us.exec),{supportPath:sc}=K.environment,ic=()=>{let{clientId:t,clientSecret:e,fetchFavicons:r,generatePasswordQuickAction:n,repromptIgnoreDuration:o,serverCertsPath:s,serverUrl:i,shouldCacheVaultItems:a,transientCopyGeneratePassword:c,transientCopyGeneratePasswordQuick:d,transientCopySearch:E,windowActionOnCopy:x}=(0,K.getPreferenceValues)();return{has_clientId:!!t,has_clientSecret:!!e,fetchFavicons:r,generatePasswordQuickAction:n,repromptIgnoreDuration:o,has_serverCertsPath:!!s,has_serverUrl:!!i,shouldCacheVaultItems:a,transientCopyGeneratePassword:c,transientCopyGeneratePasswordQuick:d,transientCopySearch:E,windowActionOnCopy:x}},Q="N/A",Re=async(t,e=!0)=>{try{let r=t;B==="windows"?r=`powershell -Command "${t}"`:r=`PATH="$PATH:${(0,Ms.dirname)(process.execPath)}" ${t}`;let{stdout:n}=await oc(r,{env:{BITWARDENCLI_APPDATA_DIR:sc}}),o=n.trim();return e?o.replace(/\n|\r/g,""):o}catch(r){return v(`Failed to execute command: ${t}`,r),Q}},ac=()=>{try{let t=(0,K.getPreferenceValues)().cliPath;return t?{type:"custom",path:t}:te.path.bin===te.path.downloadedBin?{type:"downloaded",path:te.path.downloadedBin}:{type:"installed",path:te.path.installedBin}}catch{return{type:Q,path:Q}}},cc=async()=>{try{let t="/opt/homebrew/bin/brew";if((0,Jr.existsSync)(t)||(t="/usr/local/bin/brew"),!(0,Jr.existsSync)(t))return{arch:Q,version:Q};let e=await Re(`${t} config`,!1);if(e===Q)return{arch:Q,version:Q};let r=/HOMEBREW_PREFIX: (.+)/.exec(e)?.[1]||Q,n=/HOMEBREW_VERSION: (.+)/.exec(e)?.[1]||Q;return{arch:r!==Q?r.includes("/opt/homebrew")?"arm64":"x86_64":Q,version:n}}catch{return{arch:Q,version:Q}}};function lc(){let t=async()=>{let e=await(0,K.showToast)(K.Toast.Style.Animated,"Collecting data...");try{let r=ic(),n=ac(),[o,s,i,a]=await Promise.all([...B==="macos"?[Re("uname -m"),Re("sw_vers -productVersion"),Re("sw_vers -buildVersion")]:[Re("(Get-CimInstance Win32_OperatingSystem).OSArchitecture"),Re("(Get-CimInstance Win32_OperatingSystem).Caption"),Re("(Get-CimInstance Win32_OperatingSystem).Version")],Re(`${n.path} --version`)]),c={raycast:{version:K.environment.raycastVersion},system:{arch:o,version:s,buildVersion:i},node:{arch:process.arch,version:process.version},cli:{type:n.type,version:a},preferences:r};if(B==="macos"){let d=await cc();c.homebrew={arch:d.arch,version:d.version}}await K.Clipboard.copy(JSON.stringify(c,null,2)),e.style=K.Toast.Style.Success,e.title="Data copied to clipboard"}catch(r){e.style=K.Toast.Style.Failure,e.title="Failed to collect bug report data",v("Failed to collect bug report data",r)}};return(0,Bs.jsx)(K.Action,{title:"Collect Bug Report Data",icon:K.Icon.Bug,onAction:t})}var yt=lc;var q=require("@raycast/api");var Gs=require("react/jsx-runtime");function uc(){return(0,Gs.jsx)(q.Action,{onAction:async()=>{let e=Qe.toString();if(e.length===0)return(0,q.showToast)(q.Toast.Style.Success,"No errors to copy");await q.Clipboard.copy(e),await(0,q.showToast)(q.Toast.Style.Success,"Errors copied to clipboard"),await(0,q.confirmAlert)({title:"Be careful with this information",message:"Please be mindful of where you share this error log, as it may contain sensitive information. Always analyze it before sharing.",primaryAction:{title:"Got it",style:q.Alert.ActionStyle.Default}})},title:"Copy Last Errors",icon:q.Icon.CopyClipboard,style:q.Action.Style.Regular})}var Xr=uc;var Hs=require("@raycast/api");var zs=require("react");var dc=()=>{let t=ge.get(de.CLI_VERSION);return t?parseFloat(t):-1},Ws=()=>{let[t,e]=(0,zs.useState)(dc);return $e(()=>{ge.subscribe((r,n)=>{n&&r===de.CLI_VERSION&&e(parseFloat(n)||-1)})}),t};var nt=require("react/jsx-runtime");function Ae(){let t=Ws();return(0,nt.jsxs)(Hs.ActionPanel.Section,{title:`Debugging & Bug Reporting (CLI v${t})`,children:[(0,nt.jsx)(Xr,{}),(0,nt.jsx)(ht,{}),(0,nt.jsx)(yt,{})]})}var ot=require("@raycast/api");var rr=require("@raycast/api"),vt=require("react");var xt=require("react");var mc=require("react/jsx-runtime"),If=(0,xt.createContext)(null);var gc=require("@raycast/api");var pc=require("@raycast/api");var hc=require("react");var yc=require("react/jsx-runtime"),em=(0,vt.createContext)(null);var{syncOnLaunch:tm}=(0,rr.getPreferenceValues)();var js=require("react/jsx-runtime");var Me=require("@raycast/api"),nr=require("react"),qs=require("react/jsx-runtime"),Ks=[Me.Icon.CircleProgress25,Me.Icon.CircleProgress50,Me.Icon.CircleProgress75,Me.Icon.CircleProgress100],Ys=t=>{let[e,r]=(0,nr.useState)(0);return(0,nr.useEffect)(()=>{let n,o=()=>{n=setTimeout(()=>{clearTimeout(n),r(s=>++s%Ks.length),o()},500)};return o(),()=>clearTimeout(n)},[]),(0,qs.jsx)(Me.List.EmptyView,{icon:Ks[e],...t})};var st=require("@raycast/api"),Zs=require("react");var Qr=require("react/jsx-runtime"),Be=class extends Zs.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}async componentDidCatch(e,r){e instanceof pe?(this.setState(n=>({...n,hasError:!0,error:e.message})),await(0,st.showToast)(st.Toast.Style.Failure,e.message)):(st.environment.isDevelopment&&this.setState(n=>({...n,hasError:!0,error:e.message})),console.error("Error:",e,r))}render(){try{return this.state.hasError?(0,Qr.jsx)(gt,{error:this.state.error}):this.props.children}catch{return(0,Qr.jsx)(gt,{})}}};var or={0:"Text",1:"File (Premium)"},Js={"1 hour":1,"1 day":24,"2 days":48,"3 days":72,"7 days":168,"30 days":720};var me=require("@raycast/api");var k=require("@raycast/api");var L=require("react/jsx-runtime"),Xs=t=>{if(!t)return;let e=new Date;if(e.setDate(e.getDate()+31),t>e)return"Must be under 31 days from now."},wc=t=>{if(!t)return;let e=parseInt(t);if(isNaN(e)||e<=0)return"Must be a positive number."},X={name:"",text:"",hidden:!1,file:void 0,deletionDate:"7 days",customDeletionDate:null,expirationDate:"",customExpirationDate:null,maxAccessCount:"",accessPassword:"",notes:"",hideEmail:!1,disabled:!1},Qs=({onSave:t,onSuccess:e,initialValues:r=X,mode:n="create"})=>{let[o,s]=Ge("sendType",0),[i,a]=Ge("sendShouldCopyOnSave",!1),c=n==="edit"?r?.file?1:0:o,{itemProps:d,handleSubmit:E}=dn({initialValues:r,onSubmit:x,validation:{name:At.Required,text:c===0?At.Required:void 0,file:c===1&&n==="create"?At.Required:void 0,customDeletionDate:Xs,customExpirationDate:Xs,maxAccessCount:wc}});async function x(S){let I=await(0,k.showToast)({title:n==="edit"?"Updating Send...":"Creating Send...",style:k.Toast.Style.Animated});try{let P=await t(c,S);i?(await k.Clipboard.copy(P.accessUrl),I.message="URL copied to clipboard"):I.primaryAction={title:"Copy URL",onAction:async()=>{await k.Clipboard.copy(P.accessUrl),I.message="URL copied to clipboard"}},I.title=n==="edit"?"Send updated":"Send created",I.style=k.Toast.Style.Success,e?.(P,i)}catch(P){P instanceof Je&&(I.message="This feature is only available to Premium users."),I.style=k.Toast.Style.Failure,I.title=`Failed to ${n==="edit"?"update":"create"} Send`,v(`Failed to ${n==="edit"?"update":"create"} Send`,P)}}let w=S=>s(parseInt(S));return(0,L.jsxs)(k.Form,{actions:(0,L.jsxs)(k.ActionPanel,{children:[(0,L.jsx)(k.Action.SubmitForm,{title:n==="edit"?"Save Send":"Create Send",icon:{source:"send.svg"},onSubmit:E}),(0,L.jsx)(Ae,{})]}),children:[(0,L.jsx)(k.Form.TextField,{...d.name,title:"Name",placeholder:"Enter a name",info:"A friendly name to describe this send."}),n==="create"&&(0,L.jsx)(k.Form.Dropdown,{id:"type",value:String(c),onChange:w,title:"What type of Send is this?",children:Object.entries(or).map(([S,I])=>(0,L.jsx)(k.Form.Dropdown.Item,{value:S,title:I},S))}),c===0&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(k.Form.TextArea,{...d.text,title:"Text",placeholder:"Enter the text you want to send",info:"The text you want to send"}),(0,L.jsx)(k.Form.Checkbox,{...d.hidden,label:"Hide this Send's text by default"})]}),c===1&&(0,L.jsx)(L.Fragment,{children:n==="create"?(0,L.jsx)(k.Form.FilePicker,{...d.file,title:"File",info:"The file you want to send.",allowMultipleSelection:!1}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(k.Form.Description,{text:d.file.value?.[0]??"No file found.",title:"File"}),(0,L.jsx)(k.Form.Description,{text:""})]})}),(0,L.jsx)(k.Form.Checkbox,{title:"Share",id:"copySendOnSave",label:"Copy this Send's to clipboard upon save",value:i,onChange:a}),(0,L.jsx)(k.Form.Description,{text:""}),(0,L.jsx)(k.Form.Separator,{}),(0,L.jsx)(k.Form.Description,{text:"Options"}),(0,L.jsx)(k.Form.Dropdown,{...d.deletionDate,title:"Deletion date",info:"The Send will be permanently deleted on the specified date and time.",children:Object.values(tt).map(S=>(0,L.jsx)(k.Form.Dropdown.Item,{value:S,title:S},S))}),d.deletionDate.value==="Custom"&&(0,L.jsx)(k.Form.DatePicker,{...d.customDeletionDate,title:"Custom deletion date"}),(0,L.jsxs)(k.Form.Dropdown,{...d.expirationDate,title:"Expiration date",info:"If set, access to this Send will expire on the specified date and time.",children:[(0,L.jsx)(k.Form.Dropdown.Item,{value:"",title:"Never"}),Object.values(tt).map(S=>(0,L.jsx)(k.Form.Dropdown.Item,{value:S,title:S},S))]}),d.expirationDate.value==="Custom"&&(0,L.jsx)(k.Form.DatePicker,{...d.customExpirationDate,title:"Custom expiration date"}),(0,L.jsx)(k.Form.TextField,{...d.maxAccessCount,title:"Maximum Access Count",placeholder:"Enter a maximum number of accesses",info:"If set, user will no longer be able to access this Send once the maximum access count is reached."}),(0,L.jsx)(k.Form.PasswordField,{...d.accessPassword,title:"Password",placeholder:"Enter a password",info:"Optionally require a password for users to access this Send."}),(0,L.jsx)(k.Form.TextArea,{...d.notes,title:"Notes",placeholder:"Enter notes",info:"Private notes about this Send."}),(0,L.jsx)(k.Form.Checkbox,{...d.hideEmail,label:"Hide my email address from recipients"}),(0,L.jsx)(k.Form.Checkbox,{...d.disabled,label:"Deactivate this Send so no one can access it"})]})};var ye=require("react/jsx-runtime"),ei=()=>(0,ye.jsx)(me.Form,{isLoading:!0}),Sc=t=>(0,ye.jsx)(Be,{children:(0,ye.jsx)(Xt,{loadingFallback:(0,ye.jsx)(ei,{}),children:(0,ye.jsx)(Et,{loadingFallback:(0,ye.jsx)(ei,{}),unlock:!0,children:(0,ye.jsx)(xc,{...t})})})});function ti(t,e){if(!t)return null;if(t==="Custom")return e?.toISOString()??null;let r=Js[t];if(!r)return null;let n=new Date;return n.setHours(n.getHours()+r),n.toISOString()}var ni=(t,e)=>({type:t,name:e.name,text:e.text?{text:e.text,hidden:e.hidden}:null,file:e.file?.[0]?{fileName:e.file[0]}:null,deletionDate:ti(e.deletionDate,e.customDeletionDate),expirationDate:ti(e.expirationDate,e.customExpirationDate),maxAccessCount:e.maxAccessCount?parseInt(e.maxAccessCount):null,password:e.accessPassword||null,notes:e.notes||null,hideEmail:e.hideEmail,disabled:e.disabled}),bc=(t,e,r)=>({...t,...ni(e,r)}),ri=t=>t?{option:"Custom",customDate:new Date(t)}:{option:void 0,customDate:null},Ec=t=>{if(!t)return X;let e=ri(t.deletionDate),r=ri(t.expirationDate);return{...X,name:t.name,text:t.text?.text||X.text,hidden:t.text?.hidden||X.hidden,file:t.file?[t.file.fileName]:X.file,deletionDate:e.option||X.deletionDate,customDeletionDate:e.customDate||X.customDeletionDate,expirationDate:r.option||X.expirationDate,customExpirationDate:r.customDate||X.customExpirationDate,maxAccessCount:t.maxAccessCount?String(t.maxAccessCount):X.maxAccessCount,accessPassword:"",notes:t.notes||X.notes,hideEmail:t.hideEmail||X.hideEmail,disabled:t.disabled||X.disabled}};function xc({send:t,onSuccess:e}){let r=ie();async function n(s,i){if(!t){let{error:d,result:E}=await r.createSend(ni(s,i));if(d)throw d;return E}let{error:a,result:c}=await r.editSend(bc(t,s,i));if(a)throw a;return c}let o=async(s,i)=>{e?e(s):i?await(0,me.showHUD)("Send URL copied to clipboard",{popToRootType:me.PopToRootType.Immediate}):await(0,me.launchCommand)({type:me.LaunchType.UserInitiated,name:"search-sends"})};return(0,ye.jsx)(Qs,{mode:t?"edit":"create",initialValues:Ec(t),onSave:n,onSuccess:o})}var en=Sc;var tn=(t,e)=>{let{abbreviate:r=!1,...n}=e??{};return t.toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"numeric",year:r&&t.getFullYear()===new Date().getFullYear()?void 0:"numeric",second:r&&t.getSeconds()===0?void 0:"numeric",...n})};var oi=require("@raycast/api"),sr=require("react");function rn(){let[t,e]=(0,sr.useState)(void 0);return(0,sr.useEffect)(()=>{(0,oi.getFrontmostApplication)().then(r=>e(r.name)).catch(()=>e(void 0))},[]),t}var ir=require("react"),si=(t,e)=>{let{interval:r=60*1e3,skip:n=!1}=e??{},o=(0,ir.useRef)(void 0);return(0,ir.useEffect)(()=>n?void 0:((async()=>{await t(),o.current=setInterval(t,r)})(),()=>clearInterval(o.current)),[r,n]),{clearInterval:()=>clearInterval(o.current)}};var _=require("react/jsx-runtime"),cr="Search sends",ii=()=>(0,_.jsx)(g.List,{searchBarPlaceholder:cr,isLoading:!0}),{syncOnLaunch:vc}=(0,g.getPreferenceValues)(),Ic=()=>(0,_.jsx)(Be,{children:(0,_.jsx)(Xt,{loadingFallback:(0,_.jsx)(ii,{}),children:(0,_.jsx)(Et,{loadingFallback:(0,_.jsx)(ii,{}),unlock:!0,children:(0,_.jsx)(Ac,{})})})}),Tc=t=>t.type===1?{source:g.Icon.Document,tintColor:g.Color.Blue}:{source:g.Icon.Text,tintColor:g.Color.SecondaryText},ai=t=>{let e=new Date(t),r=e<new Date;return{date:e,isPastDate:r,color:r?g.Color.Red:void 0,textDate:tn(e,{abbreviate:!0,second:void 0}),tooltipDate:tn(e)}},Pc=t=>{let e=[];t.passwordSet&&e.push({icon:g.Icon.Key,tooltip:"Password protected"}),t.disabled&&e.push({icon:{source:g.Icon.Warning,tintColor:g.Color.Orange},tooltip:"Disabled"});let{accessCount:r,maxAccessCount:n}=t;if(r>0||n){let o=n&&r>=n;e.push({tag:{value:`${r}`,color:o?g.Color.Red:void 0},icon:{source:g.Icon.Person,tintColor:o?g.Color.Red:void 0},tooltip:n?`Max access count reached: ${r}/${n}`:`Access Count: ${r}`})}if(t.expirationDate){let{color:o,textDate:s,tooltipDate:i,isPastDate:a}=ai(t.expirationDate);e.push({text:{value:s,color:o},icon:{source:g.Icon.Clock,tintColor:o},tooltip:a?`Expired on ${i}`:`Will expire on ${i}`})}if(t.deletionDate){let{color:o,textDate:s,tooltipDate:i,isPastDate:a}=ai(t.deletionDate);e.push({text:{value:s,color:o},icon:{source:g.Icon.Trash,tintColor:o},tooltip:a?`Deleted on ${i}`:`Will be deleted on ${i}`})}return e},Cc=()=>{let t=rn();return t?`Paste URL into ${t}`:"Paste URL"},kc=()=>{let t=(0,It.useRef)([]),e=(0,It.useRef)(void 0),r=()=>{let[o]=t.current;o&&(e.current=setTimeout(async()=>{try{await o.execute()}finally{t.current.shift(),clearTimeout(e.current),e.current=void 0,t.current.length>0&&r()}},1))};return(o,s)=>{t.current.some(i=>i.id===o)||(t.current.push({id:o,execute:s}),e.current||r())}},nn=(t,e)=>t.name.localeCompare(e.name),$c=t=>{let e=(0,It.useRef)(!0),[r,n]=Ge(de.SEND_TYPE_FILTER),o=async()=>{let w=e.current?await(0,g.showToast)({title:"Loading Sends...",style:g.Toast.Style.Animated}):void 0;try{let S=await t.listSends();return S.result&&S.result.sort(nn),S}finally{e.current=!1,await w?.hide()}},{data:s,isLoading:i,revalidate:a,mutate:c,error:d}=$t(o),{result:E=[]}=s??{};return{isLoading:i,refresh:w=>w?c(o(),w):a(),error:d,called:!!s,filterByType:n,sends:r!=null?E.filter(w=>w.type===r):E,isFirstLoading:i&&e.current}},ar={title:"Sync Vault",shortcut:B==="windows"?{key:"r",modifiers:["alt"]}:{key:"r",modifiers:["opt"]},shortcutLabel:B==="windows"?"Alt+R":"\u2325+R"};function Ac(){let{pop:t}=(0,g.useNavigation)(),e=ie(),r=kc(),{sends:n,isFirstLoading:o,called:s,refresh:i,filterByType:a}=$c(e),c=Cc(),d=(0,It.useRef)(void 0);si(()=>E(!0),{skip:!s||!vc});function E(l){return r("sync",async()=>{let y=await(0,g.showToast)({title:"Syncing vault...",message:l?"Background task":void 0,style:g.Toast.Style.Animated});try{await e.sync(),await i(),l?await y?.hide():(y.style=g.Toast.Style.Success,y.title="Vault synced")}catch(b){y.style=g.Toast.Style.Failure,y.title="Failed to sync vault",v(["Failed to sync vault",l&&"periodically"],b)}})}let x=l=>r(l,async()=>{let y=await(0,g.showToast)({title:"Deleting Send...",style:g.Toast.Style.Animated});try{await e.deleteSend(l),await i(),y.style=g.Toast.Style.Success,y.title="Send deleted"}catch(b){y.style=g.Toast.Style.Failure,y.title="Failed to delete Send",v("Failed to delete Send",b)}}),w=l=>r(l,async()=>{let y=await(0,g.showToast)({title:"Removing Send password...",style:g.Toast.Style.Animated});try{await e.removeSendPassword(l),await i(),y.style=g.Toast.Style.Success,y.title="Send password removed"}catch(b){y.style=g.Toast.Style.Failure,y.title="Failed to remove Send password",v("Failed to remove Send Password",b)}}),S=l=>(t(),r(l.id,async()=>{d.current=l.id;try{await i({optimisticUpdate:y=>{if(!y?.result)return{result:[l]};let b=[...y.result,l];return b.sort(nn),setTimeout(()=>d.current=void 0,1),{result:b}},rollbackOnError:!0,shouldRevalidateAfter:!0})}catch(y){await(0,g.showToast)({title:"Failed to refresh Sends",style:g.Toast.Style.Failure}),v("Failed to refresh Sends",y)}})),I=l=>(t(),r(l.id,async()=>{try{await i({optimisticUpdate:y=>{if(!y?.result)return{result:[l]};let b=y?.result.findIndex(V=>V.id===l.id),R=[...y.result];return b===-1?R.push(l):R[b]=l,R.sort(nn),{result:R}},rollbackOnError:!0,shouldRevalidateAfter:!0})}catch(y){await(0,g.showToast)({title:"Failed to sync Sends",style:g.Toast.Style.Failure}),v("Failed to sync Sends",y)}})),P=l=>a(l!==""?parseInt(l):void 0),T=(0,_.jsxs)(g.List.Dropdown,{tooltip:"Filter by Send type",onChange:P,children:[(0,_.jsx)(g.List.Dropdown.Item,{title:"All",value:""}),Object.entries(or).map(([l,y])=>(0,_.jsx)(g.List.Dropdown.Item,{value:l,title:y},l))]});if(o)return(0,_.jsx)(g.List,{searchBarPlaceholder:cr,searchBarAccessory:T,children:(0,_.jsx)(Ys,{title:"Loading Sends...",description:"Please wait."})});let C=(0,_.jsxs)(g.ActionPanel.Section,{title:"Send Management",children:[(0,_.jsx)(g.Action.Push,{title:"Create New Send",target:(0,_.jsx)(en,{onSuccess:S}),icon:g.Icon.NewDocument,shortcut:{macOS:{key:"n",modifiers:["opt"]},Windows:{key:"n",modifiers:["alt"]}}}),(0,_.jsx)(g.Action,{title:ar.title,onAction:()=>E(!1),icon:g.Icon.ArrowClockwise,shortcut:ar.shortcut})]});return n.length===0?(0,_.jsx)(g.List,{searchBarPlaceholder:cr,searchBarAccessory:T,children:(0,_.jsx)(g.List.EmptyView,{title:"There are no items to list.",icon:"sends-empty-list.svg",actions:(0,_.jsxs)(g.ActionPanel,{children:[C,(0,_.jsx)(Ae,{})]}),description:`Try syncing your vault with the ${ar.title} (${ar.shortcutLabel}) action.`})}):(0,_.jsx)(g.List,{searchBarPlaceholder:cr,selectedItemId:d.current,searchBarAccessory:T,children:n.map(l=>(0,_.jsx)(g.List.Item,{id:l.id,title:l.name,icon:Tc(l),accessories:Pc(l),actions:(0,_.jsxs)(g.ActionPanel,{children:[(0,_.jsx)(g.Action.CopyToClipboard,{title:"Copy URL",content:l.accessUrl}),(0,_.jsx)(g.Action.Paste,{title:c,content:l.accessUrl}),l.passwordSet&&(0,_.jsx)(g.Action,{title:"Remove Password",onAction:()=>w(l.id),icon:g.Icon.LockUnlocked,shortcut:{macOS:{key:"p",modifiers:["opt"]},Windows:{key:"p",modifiers:["alt"]}}}),(0,_.jsx)(g.Action.Push,{title:"Edit Send",target:(0,_.jsx)(en,{send:l,onSuccess:I}),icon:g.Icon.Pencil,shortcut:{macOS:{key:"e",modifiers:["opt"]},Windows:{key:"e",modifiers:["alt"]}}}),(0,_.jsx)(g.Action,{title:"Delete Send",style:g.Action.Style.Destructive,onAction:()=>x(l.id),icon:g.Icon.Trash,shortcut:{macOS:{key:"d",modifiers:["opt"]},Windows:{key:"d",modifiers:["alt"]}}}),C,(0,_.jsx)(Ae,{})]})},l.id))})}var Lc=Ic;
/*! Bundled license information:

node-stream-zip/node_stream_zip.js:
  (**
   * @license node-stream-zip | (c) 2020 Antelle | https://github.com/antelle/node-stream-zip/blob/master/LICENSE
   * Portions copyright https://github.com/cthackers/adm-zip | https://raw.githubusercontent.com/cthackers/adm-zip/master/LICENSE
   *)
*/
