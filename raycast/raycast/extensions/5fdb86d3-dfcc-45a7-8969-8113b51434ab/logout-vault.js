"use strict";var gs=Object.create;var Ge=Object.defineProperty;var ys=Object.getOwnPropertyDescriptor;var ws=Object.getOwnPropertyNames;var bs=Object.getPrototypeOf,Ss=Object.prototype.hasOwnProperty;var P=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Es=(r,e)=>{for(var t in e)Ge(r,t,{get:e[t],enumerable:!0})},er=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ws(e))!Ss.call(r,s)&&s!==t&&Ge(r,s,{get:()=>e[s],enumerable:!(n=ys(e,s))||n.enumerable});return r};var _=(r,e,t)=>(t=r!=null?gs(bs(r)):{},er(e||!r||!r.__esModule?Ge(t,"default",{value:r,enumerable:!0}):t,r)),xs=r=>er(Ge({},"__esModule",{value:!0}),r);var or=P((bi,sr)=>{sr.exports=nr;nr.sync=Is;var tr=require("fs");function vs(r,e){var t=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!t||(t=t.split(";"),t.indexOf("")!==-1))return!0;for(var n=0;n<t.length;n++){var s=t[n].toLowerCase();if(s&&r.substr(-s.length).toLowerCase()===s)return!0}return!1}function rr(r,e,t){return!r.isSymbolicLink()&&!r.isFile()?!1:vs(e,t)}function nr(r,e,t){tr.stat(r,function(n,s){t(n,n?!1:rr(s,r,e))})}function Is(r,e){return rr(tr.statSync(r),r,e)}});var ur=P((Si,lr)=>{lr.exports=ar;ar.sync=Ts;var ir=require("fs");function ar(r,e,t){ir.stat(r,function(n,s){t(n,n?!1:cr(s,e))})}function Ts(r,e){return cr(ir.statSync(r),e)}function cr(r,e){return r.isFile()&&ks(r,e)}function ks(r,e){var t=r.mode,n=r.uid,s=r.gid,o=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),d=parseInt("100",8),f=parseInt("010",8),g=parseInt("001",8),E=d|f,k=t&g||t&f&&s===i||t&d&&n===o||t&E&&o===0;return k}});var fr=P((xi,dr)=>{var Ei=require("fs"),ze;process.platform==="win32"||global.TESTING_WINDOWS?ze=or():ze=ur();dr.exports=ft;ft.sync=$s;function ft(r,e,t){if(typeof e=="function"&&(t=e,e={}),!t){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,s){ft(r,e||{},function(o,i){o?s(o):n(i)})})}ze(r,e||{},function(n,s){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,s=!1),t(n,s)})}function $s(r,e){try{return ze.sync(r,e||{})}catch(t){if(e&&e.ignoreErrors||t.code==="EACCES")return!1;throw t}}});var br=P((vi,wr)=>{var ue=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",mr=require("path"),Ps=ue?";":":",pr=fr(),hr=r=>Object.assign(new Error(`not found: ${r}`),{code:"ENOENT"}),gr=(r,e)=>{let t=e.colon||Ps,n=r.match(/\//)||ue&&r.match(/\\/)?[""]:[...ue?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(t)],s=ue?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=ue?s.split(t):[""];return ue&&r.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:s}},yr=(r,e,t)=>{typeof e=="function"&&(t=e,e={}),e||(e={});let{pathEnv:n,pathExt:s,pathExtExe:o}=gr(r,e),i=[],d=g=>new Promise((E,k)=>{if(g===n.length)return e.all&&i.length?E(i):k(hr(r));let y=n[g],C=/^".*"$/.test(y)?y.slice(1,-1):y,x=mr.join(C,r),R=!C&&/^\.[\\\/]/.test(r)?r.slice(0,2)+x:x;E(f(R,g,0))}),f=(g,E,k)=>new Promise((y,C)=>{if(k===s.length)return y(d(E+1));let x=s[k];pr(g+x,{pathExt:o},(R,U)=>{if(!R&&U)if(e.all)i.push(g+x);else return y(g+x);return y(f(g,E,k+1))})});return t?d(0).then(g=>t(null,g),t):d(0)},Cs=(r,e)=>{e=e||{};let{pathEnv:t,pathExt:n,pathExtExe:s}=gr(r,e),o=[];for(let i=0;i<t.length;i++){let d=t[i],f=/^".*"$/.test(d)?d.slice(1,-1):d,g=mr.join(f,r),E=!f&&/^\.[\\\/]/.test(r)?r.slice(0,2)+g:g;for(let k=0;k<n.length;k++){let y=E+n[k];try{if(pr.sync(y,{pathExt:s}))if(e.all)o.push(y);else return y}catch{}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw hr(r)};wr.exports=yr;yr.sync=Cs});var Er=P((Ii,mt)=>{"use strict";var Sr=(r={})=>{let e=r.env||process.env;return(r.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};mt.exports=Sr;mt.exports.default=Sr});var Tr=P((Ti,Ir)=>{"use strict";var xr=require("path"),Ls=br(),As=Er();function vr(r,e){let t=r.options.env||process.env,n=process.cwd(),s=r.options.cwd!=null,o=s&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(r.options.cwd)}catch{}let i;try{i=Ls.sync(r.command,{path:t[As({env:t})],pathExt:e?xr.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return i&&(i=xr.resolve(s?r.options.cwd:"",i)),i}function Rs(r){return vr(r)||vr(r,!0)}Ir.exports=Rs});var kr=P((ki,ht)=>{"use strict";var pt=/([()\][%!^"`<>&|;, *?])/g;function Os(r){return r=r.replace(pt,"^$1"),r}function _s(r,e){return r=`${r}`,r=r.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),r=r.replace(/(?=(\\+?)?)\1$/,"$1$1"),r=`"${r}"`,r=r.replace(pt,"^$1"),e&&(r=r.replace(pt,"^$1")),r}ht.exports.command=Os;ht.exports.argument=_s});var Pr=P(($i,$r)=>{"use strict";$r.exports=/^#!(.*)/});var Lr=P((Pi,Cr)=>{"use strict";var Ns=Pr();Cr.exports=(r="")=>{let e=r.match(Ns);if(!e)return null;let[t,n]=e[0].replace(/#! ?/,"").split(" "),s=t.split("/").pop();return s==="env"?n:n?`${s} ${n}`:s}});var Rr=P((Ci,Ar)=>{"use strict";var gt=require("fs"),Ds=Lr();function Fs(r){let t=Buffer.alloc(150),n;try{n=gt.openSync(r,"r"),gt.readSync(n,t,0,150,0),gt.closeSync(n)}catch{}return Ds(t.toString())}Ar.exports=Fs});var Dr=P((Li,Nr)=>{"use strict";var Us=require("path"),Or=Tr(),_r=kr(),Vs=Rr(),Ms=process.platform==="win32",Bs=/\.(?:com|exe)$/i,Gs=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function zs(r){r.file=Or(r);let e=r.file&&Vs(r.file);return e?(r.args.unshift(r.file),r.command=e,Or(r)):r.file}function Ws(r){if(!Ms)return r;let e=zs(r),t=!Bs.test(e);if(r.options.forceShell||t){let n=Gs.test(e);r.command=Us.normalize(r.command),r.command=_r.command(r.command),r.args=r.args.map(o=>_r.argument(o,n));let s=[r.command].concat(r.args).join(" ");r.args=["/d","/s","/c",`"${s}"`],r.command=process.env.comspec||"cmd.exe",r.options.windowsVerbatimArguments=!0}return r}function js(r,e,t){e&&!Array.isArray(e)&&(t=e,e=null),e=e?e.slice(0):[],t=Object.assign({},t);let n={command:r,args:e,options:t,file:void 0,original:{command:r,args:e}};return t.shell?n:Ws(n)}Nr.exports=js});var Vr=P((Ai,Ur)=>{"use strict";var yt=process.platform==="win32";function wt(r,e){return Object.assign(new Error(`${e} ${r.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${r.command}`,path:r.command,spawnargs:r.args})}function Hs(r,e){if(!yt)return;let t=r.emit;r.emit=function(n,s){if(n==="exit"){let o=Fr(s,e);if(o)return t.call(r,"error",o)}return t.apply(r,arguments)}}function Fr(r,e){return yt&&r===1&&!e.file?wt(e.original,"spawn"):null}function Ks(r,e){return yt&&r===1&&!e.file?wt(e.original,"spawnSync"):null}Ur.exports={hookChildProcess:Hs,verifyENOENT:Fr,verifyENOENTSync:Ks,notFoundError:wt}});var Gr=P((Ri,de)=>{"use strict";var Mr=require("child_process"),bt=Dr(),St=Vr();function Br(r,e,t){let n=bt(r,e,t),s=Mr.spawn(n.command,n.args,n.options);return St.hookChildProcess(s,n),s}function Ys(r,e,t){let n=bt(r,e,t),s=Mr.spawnSync(n.command,n.args,n.options);return s.error=s.error||St.verifyENOENTSync(s.status,n),s}de.exports=Br;de.exports.spawn=Br;de.exports.sync=Ys;de.exports._parse=bt;de.exports._enoent=St});var tn=P((Ji,Ke)=>{Ke.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&Ke.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&Ke.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var an=P((Xi,he)=>{var S=global.process,re=function(r){return r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function"};re(S)?(rn=require("assert"),me=tn(),nn=/^win/i.test(S.platform),Ce=require("events"),typeof Ce!="function"&&(Ce=Ce.EventEmitter),S.__signal_exit_emitter__?L=S.__signal_exit_emitter__:(L=S.__signal_exit_emitter__=new Ce,L.count=0,L.emitted={}),L.infinite||(L.setMaxListeners(1/0),L.infinite=!0),he.exports=function(r,e){if(!re(global.process))return function(){};rn.equal(typeof r,"function","a callback must be provided for exit handler"),pe===!1&&Tt();var t="exit";e&&e.alwaysLast&&(t="afterexit");var n=function(){L.removeListener(t,r),L.listeners("exit").length===0&&L.listeners("afterexit").length===0&&Ye()};return L.on(t,r),n},Ye=function(){!pe||!re(global.process)||(pe=!1,me.forEach(function(e){try{S.removeListener(e,Ze[e])}catch{}}),S.emit=qe,S.reallyExit=kt,L.count-=1)},he.exports.unload=Ye,ne=function(e,t,n){L.emitted[e]||(L.emitted[e]=!0,L.emit(e,t,n))},Ze={},me.forEach(function(r){Ze[r]=function(){if(re(global.process)){var t=S.listeners(r);t.length===L.count&&(Ye(),ne("exit",null,r),ne("afterexit",null,r),nn&&r==="SIGHUP"&&(r="SIGINT"),S.kill(S.pid,r))}}}),he.exports.signals=function(){return me},pe=!1,Tt=function(){pe||!re(global.process)||(pe=!0,L.count+=1,me=me.filter(function(e){try{return S.on(e,Ze[e]),!0}catch{return!1}}),S.emit=on,S.reallyExit=sn)},he.exports.load=Tt,kt=S.reallyExit,sn=function(e){re(global.process)&&(S.exitCode=e||0,ne("exit",S.exitCode,null),ne("afterexit",S.exitCode,null),kt.call(S,S.exitCode))},qe=S.emit,on=function(e,t){if(e==="exit"&&re(global.process)){t!==void 0&&(S.exitCode=t);var n=qe.apply(this,arguments);return ne("exit",S.exitCode,null),ne("afterexit",S.exitCode,null),n}else return qe.apply(this,arguments)}):he.exports=function(){return function(){}};var rn,me,nn,Ce,L,Ye,ne,Ze,pe,Tt,kt,sn,qe,on});var yn=P((ta,gn)=>{"use strict";var{PassThrough:bo}=require("stream");gn.exports=r=>{r={...r};let{array:e}=r,{encoding:t}=r,n=t==="buffer",s=!1;e?s=!(t||n):t=t||"utf8",n&&(t=null);let o=new bo({objectMode:s});t&&o.setEncoding(t);let i=0,d=[];return o.on("data",f=>{d.push(f),s?i=d.length:i+=f.length}),o.getBufferedValue=()=>e?d:n?Buffer.concat(d,i):d.join(""),o.getBufferedLength=()=>i,o}});var wn=P((ra,Le)=>{"use strict";var{constants:So}=require("buffer"),Eo=require("stream"),{promisify:xo}=require("util"),vo=yn(),Io=xo(Eo.pipeline),Je=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function $t(r,e){if(!r)throw new Error("Expected a stream");e={maxBuffer:1/0,...e};let{maxBuffer:t}=e,n=vo(e);return await new Promise((s,o)=>{let i=d=>{d&&n.getBufferedLength()<=So.MAX_LENGTH&&(d.bufferedData=n.getBufferedValue()),o(d)};(async()=>{try{await Io(r,n),s()}catch(d){i(d)}})(),n.on("data",()=>{n.getBufferedLength()>t&&i(new Je)})}),n.getBufferedValue()}Le.exports=$t;Le.exports.buffer=(r,e)=>$t(r,{...e,encoding:"buffer"});Le.exports.array=(r,e)=>$t(r,{...e,array:!0});Le.exports.MaxBufferError=Je});var Sn=P((na,bn)=>{"use strict";var{PassThrough:To}=require("stream");bn.exports=function(){var r=[],e=new To({objectMode:!0});return e.setMaxListeners(0),e.add=t,e.isEmpty=n,e.on("unpipe",s),Array.prototype.slice.call(arguments).forEach(t),e;function t(o){return Array.isArray(o)?(o.forEach(t),this):(r.push(o),o.once("end",s.bind(null,o)),o.once("error",e.emit.bind(e,"error")),o.pipe(e,{end:!1}),this)}function n(){return r.length==0}function s(o){r=r.filter(function(i){return i!==o}),!r.length&&e.readable&&e.end()}}});var Bn=P((za,Mn)=>{var D=require("fs"),Fo=require("util"),Se=require("path"),zt=require("events"),Dn=require("zlib"),Vn=require("stream"),c={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSIGFIRST:80,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,MAXFILECOMMENT:65535,ENDL64HDR:20,ENDL64SIG:117853008,ENDL64SIGFIRST:80,ENDL64OFS:8,END64HDR:56,END64SIG:101075792,END64SIGFIRST:80,END64SUB:24,END64TOT:32,END64SIZ:40,END64OFF:48,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FLG_ENTRY_ENC:1,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535},q=function(r){let e,t,n,s,o,i,f=this,g=r.storeEntries!==!1?{}:null,E=r.file,k=r.nameEncoding?new TextDecoder(r.nameEncoding):null;y();function y(){r.fd?(e=r.fd,C()):D.open(E,"r",(a,l)=>{if(a)return f.emit("error",a);e=l,C()})}function C(){D.fstat(e,(a,l)=>{if(a)return f.emit("error",a);t=l.size,n=r.chunkSize||Math.round(t/1e3),n=Math.max(Math.min(n,Math.min(128*1024,t)),Math.min(1024,t)),R()})}function x(a,l){if(a||!l)return f.emit("error",a||new Error("Archive read error"));let m=s.lastPos,u=m-s.win.position,w=s.win.buffer,p=s.minPos;for(;--m>=p&&--u>=0;)if(w.length-u>=4&&w[u]===s.firstByte&&w.readUInt32LE(u)===s.sig){s.lastBufferPosition=u,s.lastBytesRead=l,s.complete();return}if(m===p)return f.emit("error",new Error("Bad archive"));if(s.lastPos=m+1,s.chunkSize*=2,m<=p)return f.emit("error",new Error("Bad archive"));let v=Math.min(s.chunkSize,m-p);s.win.expandLeft(v,x)}function R(){let a=Math.min(c.ENDHDR+c.MAXFILECOMMENT,t);s={win:new et(e),totalReadLength:a,minPos:t-a,lastPos:t,chunkSize:Math.min(1024,n),firstByte:c.ENDSIGFIRST,sig:c.ENDSIG,complete:U},s.win.read(t-s.chunkSize,s.chunkSize,x)}function U(){let a=s.win.buffer,l=s.lastBufferPosition;try{o=new Ft,o.read(a.slice(l,l+c.ENDHDR)),o.headerOffset=s.win.position+l,o.commentLength?f.comment=a.slice(l+c.ENDHDR,l+c.ENDHDR+o.commentLength).toString():f.comment=null,f.entriesCount=o.volumeEntries,f.centralDirectory=o,o.volumeEntries===c.EF_ZIP64_OR_16&&o.totalEntries===c.EF_ZIP64_OR_16||o.size===c.EF_ZIP64_OR_32||o.offset===c.EF_ZIP64_OR_32?G():(s={},Ie())}catch(m){f.emit("error",m)}}function G(){let a=c.ENDL64HDR;s.lastBufferPosition>a?(s.lastBufferPosition-=a,b()):(s={win:s.win,totalReadLength:a,minPos:s.win.position-a,lastPos:s.win.position,chunkSize:s.chunkSize,firstByte:c.ENDL64SIGFIRST,sig:c.ENDL64SIG,complete:b},s.win.read(s.lastPos-s.chunkSize,s.chunkSize,x))}function b(){let a=s.win.buffer,l=new Ut;l.read(a.slice(s.lastBufferPosition,s.lastBufferPosition+c.ENDL64HDR));let m=t-l.headerOffset;s={win:s.win,totalReadLength:m,minPos:l.headerOffset,lastPos:s.lastPos,chunkSize:s.chunkSize,firstByte:c.END64SIGFIRST,sig:c.END64SIG,complete:ve},s.win.read(t-s.chunkSize,s.chunkSize,x)}function ve(){let a=s.win.buffer,l=new Vt;l.read(a.slice(s.lastBufferPosition,s.lastBufferPosition+c.END64HDR)),f.centralDirectory.volumeEntries=l.volumeEntries,f.centralDirectory.totalEntries=l.totalEntries,f.centralDirectory.size=l.size,f.centralDirectory.offset=l.offset,f.entriesCount=l.volumeEntries,s={},Ie()}function Ie(){s={win:new et(e),pos:o.offset,chunkSize:n,entriesLeft:o.volumeEntries},s.win.read(s.pos,Math.min(n,t-s.pos),Te)}function Te(a,l){if(a||!l)return f.emit("error",a||new Error("Entries read error"));let m=s.pos-s.win.position,u=s.entry,w=s.win.buffer,p=w.length;try{for(;s.entriesLeft>0;){u||(u=new Mt,u.readHeader(w,m),u.headerOffset=s.win.position+m,s.entry=u,s.pos+=c.CENHDR,m+=c.CENHDR);let v=u.fnameLen+u.extraLen+u.comLen,$=v+(s.entriesLeft>1?c.CENHDR:0);if(p-m<$){s.win.moveRight(n,Te,m),s.move=!0;return}u.read(w,m,k),r.skipEntryNameValidation||u.validateName(),g&&(g[u.name]=u),f.emit("entry",u),s.entry=u=null,s.entriesLeft--,s.pos+=v,m+=v}f.emit("ready")}catch(v){f.emit("error",v)}}function le(){if(!g)throw new Error("storeEntries disabled")}Object.defineProperty(this,"ready",{get(){return!1}}),this.entry=function(a){return le(),g[a]},this.entries=function(){return le(),g},this.stream=function(a,l){return this.openEntry(a,(m,u)=>{if(m)return l(m);let w=ke(u),p=new Bt(e,w,u.compressedSize);if(u.method!==c.STORED)if(u.method===c.DEFLATED)p=p.pipe(Dn.createInflateRaw());else return l(new Error("Unknown compression method: "+u.method));Jt(u)&&(p=p.pipe(new Gt(p,u.crc,u.size))),l(null,p)},!1)},this.entryDataSync=function(a){let l=null;if(this.openEntry(a,(u,w)=>{l=u,a=w},!0),l)throw l;let m=Buffer.alloc(a.compressedSize);if(new Y(e,m,0,a.compressedSize,ke(a),u=>{l=u}).read(!0),l)throw l;if(a.method!==c.STORED)if(a.method===c.DEFLATED||a.method===c.ENHANCED_DEFLATED)m=Dn.inflateRawSync(m);else throw new Error("Unknown compression method: "+a.method);if(m.length!==a.size)throw new Error("Invalid size");return Jt(a)&&new tt(a.crc,a.size).data(m),m},this.openEntry=function(a,l,m){if(typeof a=="string"&&(le(),a=g[a],!a))return l(new Error("Entry not found"));if(!a.isFile)return l(new Error("Entry is not file"));if(!e)return l(new Error("Archive closed"));let u=Buffer.alloc(c.LOCHDR);new Y(e,u,0,u.length,a.offset,w=>{if(w)return l(w);let p;try{a.readDataHeader(u),a.encrypted&&(p=new Error("Entry encrypted"))}catch(v){p=v}l(p,a)}).read(m)};function ke(a){return a.offset+c.LOCHDR+a.fnameLen+a.extraLen}function Jt(a){return(a.flags&8)!==8}function ut(a,l,m){f.stream(a,(u,w)=>{if(u)m(u);else{let p,v;w.on("error",$=>{v=$,p&&(w.unpipe(p),p.close(()=>{m($)}))}),D.open(l,"w",($,V)=>{if($)return m($);if(v){D.close(e,()=>{m(v)});return}p=D.createWriteStream(l,{fd:V}),p.on("finish",()=>{f.emit("extract",a,l),v||m()}),w.pipe(p)})}})}function Xt(a,l,m){if(!l.length)return m();let u=l.shift();u=Se.join(a,Se.join(...u)),D.mkdir(u,{recursive:!0},w=>{if(w&&w.code!=="EEXIST")return m(w);Xt(a,l,m)})}function dt(a,l,m,u,w){if(!m.length)return u(null,w);let p=m.shift(),v=Se.join(a,p.name.replace(l,""));ut(p,v,$=>{if($)return u($,w);dt(a,l,m,u,w+1)})}this.extract=function(a,l,m){let u=a||"";if(typeof a=="string"&&(a=this.entry(a),a?u=a.name:u.length&&u[u.length-1]!=="/"&&(u+="/")),!a||a.isDirectory){let w=[],p=[],v={};for(let $ in g)if(Object.prototype.hasOwnProperty.call(g,$)&&$.lastIndexOf(u,0)===0){let V=$.replace(u,""),Qt=g[$];if(Qt.isFile&&(w.push(Qt),V=Se.dirname(V)),V&&!v[V]&&V!=="."){v[V]=!0;let j=V.split("/").filter($e=>$e);for(j.length&&p.push(j);j.length>1;){j=j.slice(0,j.length-1);let $e=j.join("/");if(v[$e]||$e===".")break;v[$e]=!0,p.push(j)}}}p.sort(($,V)=>$.length-V.length),p.length?Xt(l,p,$=>{$?m($):dt(l,u,w,m,0)}):dt(l,u,w,m,0)}else D.stat(l,(w,p)=>{p&&p.isDirectory()?ut(a,Se.join(l,Se.basename(a.name)),m):ut(a,l,m)})},this.close=function(a){i||!e?(i=!0,a&&a()):(i=!0,D.close(e,l=>{e=null,a&&a(l)}))};let hs=zt.EventEmitter.prototype.emit;this.emit=function(...a){if(!i)return hs.call(this,...a)}};q.setFs=function(r){D=r};q.debugLog=(...r)=>{q.debug&&console.log(...r)};Fo.inherits(q,zt.EventEmitter);var K=Symbol("zip");q.async=class extends zt.EventEmitter{constructor(e){super();let t=new q(e);t.on("entry",n=>this.emit("entry",n)),t.on("extract",(n,s)=>this.emit("extract",n,s)),this[K]=new Promise((n,s)=>{t.on("ready",()=>{t.removeListener("error",s),n(t)}),t.on("error",s)})}get entriesCount(){return this[K].then(e=>e.entriesCount)}get comment(){return this[K].then(e=>e.comment)}async entry(e){return(await this[K]).entry(e)}async entries(){return(await this[K]).entries()}async stream(e){let t=await this[K];return new Promise((n,s)=>{t.stream(e,(o,i)=>{o?s(o):n(i)})})}async entryData(e){let t=await this.stream(e);return new Promise((n,s)=>{let o=[];t.on("data",i=>o.push(i)),t.on("end",()=>{n(Buffer.concat(o))}),t.on("error",i=>{t.removeAllListeners("end"),s(i)})})}async extract(e,t){let n=await this[K];return new Promise((s,o)=>{n.extract(e,t,(i,d)=>{i?o(i):s(d)})})}async close(){let e=await this[K];return new Promise((t,n)=>{e.close(s=>{s?n(s):t()})})}};var Ft=class{read(e){if(e.length!==c.ENDHDR||e.readUInt32LE(0)!==c.ENDSIG)throw new Error("Invalid central directory");this.volumeEntries=e.readUInt16LE(c.ENDSUB),this.totalEntries=e.readUInt16LE(c.ENDTOT),this.size=e.readUInt32LE(c.ENDSIZ),this.offset=e.readUInt32LE(c.ENDOFF),this.commentLength=e.readUInt16LE(c.ENDCOM)}},Ut=class{read(e){if(e.length!==c.ENDL64HDR||e.readUInt32LE(0)!==c.ENDL64SIG)throw new Error("Invalid zip64 central directory locator");this.headerOffset=Z(e,c.ENDSUB)}},Vt=class{read(e){if(e.length!==c.END64HDR||e.readUInt32LE(0)!==c.END64SIG)throw new Error("Invalid central directory");this.volumeEntries=Z(e,c.END64SUB),this.totalEntries=Z(e,c.END64TOT),this.size=Z(e,c.END64SIZ),this.offset=Z(e,c.END64OFF)}},Mt=class{readHeader(e,t){if(e.length<t+c.CENHDR||e.readUInt32LE(t)!==c.CENSIG)throw new Error("Invalid entry header");this.verMade=e.readUInt16LE(t+c.CENVEM),this.version=e.readUInt16LE(t+c.CENVER),this.flags=e.readUInt16LE(t+c.CENFLG),this.method=e.readUInt16LE(t+c.CENHOW);let n=e.readUInt16LE(t+c.CENTIM),s=e.readUInt16LE(t+c.CENTIM+2);this.time=Fn(n,s),this.crc=e.readUInt32LE(t+c.CENCRC),this.compressedSize=e.readUInt32LE(t+c.CENSIZ),this.size=e.readUInt32LE(t+c.CENLEN),this.fnameLen=e.readUInt16LE(t+c.CENNAM),this.extraLen=e.readUInt16LE(t+c.CENEXT),this.comLen=e.readUInt16LE(t+c.CENCOM),this.diskStart=e.readUInt16LE(t+c.CENDSK),this.inattr=e.readUInt16LE(t+c.CENATT),this.attr=e.readUInt32LE(t+c.CENATX),this.offset=e.readUInt32LE(t+c.CENOFF)}readDataHeader(e){if(e.readUInt32LE(0)!==c.LOCSIG)throw new Error("Invalid local header");this.version=e.readUInt16LE(c.LOCVER),this.flags=e.readUInt16LE(c.LOCFLG),this.method=e.readUInt16LE(c.LOCHOW);let t=e.readUInt16LE(c.LOCTIM),n=e.readUInt16LE(c.LOCTIM+2);this.time=Fn(t,n),this.crc=e.readUInt32LE(c.LOCCRC)||this.crc;let s=e.readUInt32LE(c.LOCSIZ);s&&s!==c.EF_ZIP64_OR_32&&(this.compressedSize=s);let o=e.readUInt32LE(c.LOCLEN);o&&o!==c.EF_ZIP64_OR_32&&(this.size=o),this.fnameLen=e.readUInt16LE(c.LOCNAM),this.extraLen=e.readUInt16LE(c.LOCEXT)}read(e,t,n){let s=e.slice(t,t+=this.fnameLen);this.name=n?n.decode(new Uint8Array(s)):s.toString("utf8");let o=e[t-1];this.isDirectory=o===47||o===92,this.extraLen&&(this.readExtra(e,t),t+=this.extraLen),this.comment=this.comLen?e.slice(t,t+this.comLen).toString():null}validateName(){if(/\\|^\w+:|^\/|(^|\/)\.\.(\/|$)/.test(this.name))throw new Error("Malicious entry: "+this.name)}readExtra(e,t){let n,s,o=t+this.extraLen;for(;t<o;)n=e.readUInt16LE(t),t+=2,s=e.readUInt16LE(t),t+=2,c.ID_ZIP64===n&&this.parseZip64Extra(e,t,s),t+=s}parseZip64Extra(e,t,n){n>=8&&this.size===c.EF_ZIP64_OR_32&&(this.size=Z(e,t),t+=8,n-=8),n>=8&&this.compressedSize===c.EF_ZIP64_OR_32&&(this.compressedSize=Z(e,t),t+=8,n-=8),n>=8&&this.offset===c.EF_ZIP64_OR_32&&(this.offset=Z(e,t),t+=8,n-=8),n>=4&&this.diskStart===c.EF_ZIP64_OR_16&&(this.diskStart=e.readUInt32LE(t))}get encrypted(){return(this.flags&c.FLG_ENTRY_ENC)===c.FLG_ENTRY_ENC}get isFile(){return!this.isDirectory}},Y=class{constructor(e,t,n,s,o,i){this.fd=e,this.buffer=t,this.offset=n,this.length=s,this.position=o,this.callback=i,this.bytesRead=0,this.waiting=!1}read(e){q.debugLog("read",this.position,this.bytesRead,this.length,this.offset),this.waiting=!0;let t;if(e){let n=0;try{n=D.readSync(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead)}catch(s){t=s}this.readCallback(e,t,t?n:null)}else D.read(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead,this.readCallback.bind(this,e))}readCallback(e,t,n){if(typeof n=="number"&&(this.bytesRead+=n),t||!n||this.bytesRead===this.length)return this.waiting=!1,this.callback(t,this.bytesRead);this.read(e)}},et=class{constructor(e){this.position=0,this.buffer=Buffer.alloc(0),this.fd=e,this.fsOp=null}checkOp(){if(this.fsOp&&this.fsOp.waiting)throw new Error("Operation in progress")}read(e,t,n){this.checkOp(),this.buffer.length<t&&(this.buffer=Buffer.alloc(t)),this.position=e,this.fsOp=new Y(this.fd,this.buffer,0,t,this.position,n).read()}expandLeft(e,t){this.checkOp(),this.buffer=Buffer.concat([Buffer.alloc(e),this.buffer]),this.position-=e,this.position<0&&(this.position=0),this.fsOp=new Y(this.fd,this.buffer,0,e,this.position,t).read()}expandRight(e,t){this.checkOp();let n=this.buffer.length;this.buffer=Buffer.concat([this.buffer,Buffer.alloc(e)]),this.fsOp=new Y(this.fd,this.buffer,n,e,this.position+n,t).read()}moveRight(e,t,n){this.checkOp(),n?this.buffer.copy(this.buffer,0,n):n=0,this.position+=n,this.fsOp=new Y(this.fd,this.buffer,this.buffer.length-n,n,this.position+this.buffer.length-n,t).read()}},Bt=class extends Vn.Readable{constructor(e,t,n){super(),this.fd=e,this.offset=t,this.length=n,this.pos=0,this.readCallback=this.readCallback.bind(this)}_read(e){let t=Buffer.alloc(Math.min(e,this.length-this.pos));t.length?D.read(this.fd,t,0,t.length,this.offset+this.pos,this.readCallback):this.push(null)}readCallback(e,t,n){this.pos+=t,e?(this.emit("error",e),this.push(null)):t?(t!==n.length&&(n=n.slice(0,t)),this.push(n)):this.push(null)}},Gt=class extends Vn.Transform{constructor(e,t,n){super(),this.verify=new tt(t,n),e.on("error",s=>{this.emit("error",s)})}_transform(e,t,n){let s;try{this.verify.data(e)}catch(o){s=o}n(s,e)}},tt=class r{constructor(e,t){this.crc=e,this.size=t,this.state={crc:-1,size:0}}data(e){let t=r.getCrcTable(),n=this.state.crc,s=0,o=e.length;for(;--o>=0;)n=t[(n^e[s++])&255]^n>>>8;if(this.state.crc=n,this.state.size+=e.length,this.state.size>=this.size){let i=Buffer.alloc(4);if(i.writeInt32LE(~this.state.crc&4294967295,0),n=i.readUInt32LE(0),n!==this.crc)throw new Error("Invalid CRC");if(this.state.size!==this.size)throw new Error("Invalid size")}}static getCrcTable(){let e=r.crcTable;if(!e){r.crcTable=e=[];let t=Buffer.alloc(4);for(let n=0;n<256;n++){let s=n;for(let o=8;--o>=0;)(s&1)!==0?s=3988292384^s>>>1:s=s>>>1;s<0&&(t.writeInt32LE(s,0),s=t.readUInt32LE(0)),e[n]=s}}return e}};function Fn(r,e){let t=Un(r,16),n=Un(e,16),s={h:parseInt(t.slice(0,5).join(""),2),m:parseInt(t.slice(5,11).join(""),2),s:parseInt(t.slice(11,16).join(""),2)*2,Y:parseInt(n.slice(0,7).join(""),2)+1980,M:parseInt(n.slice(7,11).join(""),2),D:parseInt(n.slice(11,16).join(""),2)},o=[s.Y,s.M,s.D].join("-")+" "+[s.h,s.m,s.s].join(":")+" GMT+0";return new Date(o).getTime()}function Un(r,e){let t=(r>>>0).toString(2);for(;t.length<e;)t="0"+t;return t.split("")}function Z(r,e){return r.readUInt32LE(e+4)*4294967296+r.readUInt32LE(e)}Mn.exports=q});var yi={};Es(yi,{default:()=>gi});module.exports=xs(yi);var A=require("@raycast/api");var T=require("@raycast/api");var Cn=require("node:buffer"),Ln=_(require("node:path"),1),Ot=_(require("node:child_process"),1),Ae=_(require("node:process"),1),An=_(Gr(),1);function Et(r){let e=typeof r=="string"?`
`:10,t=typeof r=="string"?"\r":13;return r[r.length-1]===e&&(r=r.slice(0,-1)),r[r.length-1]===t&&(r=r.slice(0,-1)),r}var Pe=_(require("node:process"),1),fe=_(require("node:path"),1),zr=_(require("node:url"),1);function We(r={}){let{env:e=process.env,platform:t=process.platform}=r;return t!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}function Zs(r={}){let{cwd:e=Pe.default.cwd(),path:t=Pe.default.env[We()],execPath:n=Pe.default.execPath}=r,s,o=e instanceof URL?zr.default.fileURLToPath(e):e,i=fe.default.resolve(o),d=[];for(;s!==i;)d.push(fe.default.join(i,"node_modules/.bin")),s=i,i=fe.default.resolve(i,"..");return d.push(fe.default.resolve(o,n,"..")),[...d,t].join(fe.default.delimiter)}function Wr({env:r=Pe.default.env,...e}={}){r={...r};let t=We({env:r});return e.path=r[t],r[t]=Zs(e),r}var qs=(r,e,t,n)=>{if(t==="length"||t==="prototype"||t==="arguments"||t==="caller")return;let s=Object.getOwnPropertyDescriptor(r,t),o=Object.getOwnPropertyDescriptor(e,t);!Js(s,o)&&n||Object.defineProperty(r,t,o)},Js=function(r,e){return r===void 0||r.configurable||r.writable===e.writable&&r.enumerable===e.enumerable&&r.configurable===e.configurable&&(r.writable||r.value===e.value)},Xs=(r,e)=>{let t=Object.getPrototypeOf(e);t!==Object.getPrototypeOf(r)&&Object.setPrototypeOf(r,t)},Qs=(r,e)=>`/* Wrapped ${r}*/
${e}`,eo=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),to=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),ro=(r,e,t)=>{let n=t===""?"":`with ${t.trim()}() `,s=Qs.bind(null,n,e.toString());Object.defineProperty(s,"name",to),Object.defineProperty(r,"toString",{...eo,value:s})};function xt(r,e,{ignoreNonConfigurable:t=!1}={}){let{name:n}=r;for(let s of Reflect.ownKeys(e))qs(r,e,s,t);return Xs(r,e),ro(r,e,n),r}var je=new WeakMap,jr=(r,e={})=>{if(typeof r!="function")throw new TypeError("Expected a function");let t,n=0,s=r.displayName||r.name||"<anonymous>",o=function(...i){if(je.set(o,++n),n===1)t=r.apply(this,i),r=null;else if(e.throw===!0)throw new Error(`Function \`${s}\` can only be called once`);return t};return xt(o,r),je.set(o,n),o};jr.callCount=r=>{if(!je.has(r))throw new Error(`The given function \`${r.name}\` is not wrapped by the \`onetime\` package`);return je.get(r)};var Hr=jr;var Xr=require("node:os");var Kr=function(){let r=Zr-Yr+1;return Array.from({length:r},no)},no=function(r,e){return{name:`SIGRT${e+1}`,number:Yr+e,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},Yr=34,Zr=64;var Jr=require("node:os");var qr=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var vt=function(){let r=Kr();return[...qr,...r].map(so)},so=function({name:r,number:e,description:t,action:n,forced:s=!1,standard:o}){let{signals:{[r]:i}}=Jr.constants,d=i!==void 0;return{name:r,number:d?i:e,description:t,supported:d,action:n,forced:s,standard:o}};var oo=function(){let r=vt();return Object.fromEntries(r.map(io))},io=function({name:r,number:e,description:t,supported:n,action:s,forced:o,standard:i}){return[r,{name:r,number:e,description:t,supported:n,action:s,forced:o,standard:i}]},Qr=oo(),ao=function(){let r=vt(),e=65,t=Array.from({length:e},(n,s)=>co(s,r));return Object.assign({},...t)},co=function(r,e){let t=lo(r,e);if(t===void 0)return{};let{name:n,description:s,supported:o,action:i,forced:d,standard:f}=t;return{[r]:{name:n,number:r,description:s,supported:o,action:i,forced:d,standard:f}}},lo=function(r,e){let t=e.find(({name:n})=>Xr.constants.signals[n]===r);return t!==void 0?t:e.find(n=>n.number===r)},Hi=ao();var uo=({timedOut:r,timeout:e,errorCode:t,signal:n,signalDescription:s,exitCode:o,isCanceled:i})=>r?`timed out after ${e} milliseconds`:i?"was canceled":t!==void 0?`failed with ${t}`:n!==void 0?`was killed with ${n} (${s})`:o!==void 0?`failed with exit code ${o}`:"failed",It=({stdout:r,stderr:e,all:t,error:n,signal:s,exitCode:o,command:i,escapedCommand:d,timedOut:f,isCanceled:g,killed:E,parsed:{options:{timeout:k}}})=>{o=o===null?void 0:o,s=s===null?void 0:s;let y=s===void 0?void 0:Qr[s].description,C=n&&n.code,R=`Command ${uo({timedOut:f,timeout:k,errorCode:C,signal:s,signalDescription:y,exitCode:o,isCanceled:g})}: ${i}`,U=Object.prototype.toString.call(n)==="[object Error]",G=U?`${R}
${n.message}`:R,b=[G,e,r].filter(Boolean).join(`
`);return U?(n.originalMessage=n.message,n.message=b):n=new Error(b),n.shortMessage=G,n.command=i,n.escapedCommand=d,n.exitCode=o,n.signal=s,n.signalDescription=y,n.stdout=r,n.stderr=e,t!==void 0&&(n.all=t),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!f,n.isCanceled=g,n.killed=E&&!f,n};var He=["stdin","stdout","stderr"],fo=r=>He.some(e=>r[e]!==void 0),en=r=>{if(!r)return;let{stdio:e}=r;if(e===void 0)return He.map(n=>r[n]);if(fo(r))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${He.map(n=>`\`${n}\``).join(", ")}`);if(typeof e=="string")return e;if(!Array.isArray(e))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof e}\``);let t=Math.max(e.length,He.length);return Array.from({length:t},(n,s)=>e[s])};var cn=_(require("node:os"),1),ln=_(an(),1),mo=1e3*5,un=(r,e="SIGTERM",t={})=>{let n=r(e);return po(r,e,t,n),n},po=(r,e,t,n)=>{if(!ho(e,t,n))return;let s=yo(t),o=setTimeout(()=>{r("SIGKILL")},s);o.unref&&o.unref()},ho=(r,{forceKillAfterTimeout:e},t)=>go(r)&&e!==!1&&t,go=r=>r===cn.default.constants.signals.SIGTERM||typeof r=="string"&&r.toUpperCase()==="SIGTERM",yo=({forceKillAfterTimeout:r=!0})=>{if(r===!0)return mo;if(!Number.isFinite(r)||r<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${r}\` (${typeof r})`);return r},dn=(r,e)=>{r.kill()&&(e.isCanceled=!0)},wo=(r,e,t)=>{r.kill(e),t(Object.assign(new Error("Timed out"),{timedOut:!0,signal:e}))},fn=(r,{timeout:e,killSignal:t="SIGTERM"},n)=>{if(e===0||e===void 0)return n;let s,o=new Promise((d,f)=>{s=setTimeout(()=>{wo(r,t,f)},e)}),i=n.finally(()=>{clearTimeout(s)});return Promise.race([o,i])},mn=({timeout:r})=>{if(r!==void 0&&(!Number.isFinite(r)||r<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${r}\` (${typeof r})`)},pn=async(r,{cleanup:e,detached:t},n)=>{if(!e||t)return n;let s=(0,ln.default)(()=>{r.kill()});return n.finally(()=>{s()})};function hn(r){return r!==null&&typeof r=="object"&&typeof r.pipe=="function"}var Lt=_(wn(),1),En=_(Sn(),1),xn=(r,e)=>{e!==void 0&&(hn(e)?e.pipe(r.stdin):r.stdin.end(e))},vn=(r,{all:e})=>{if(!e||!r.stdout&&!r.stderr)return;let t=(0,En.default)();return r.stdout&&t.add(r.stdout),r.stderr&&t.add(r.stderr),t},Pt=async(r,e)=>{if(!(!r||e===void 0)){r.destroy();try{return await e}catch(t){return t.bufferedData}}},Ct=(r,{encoding:e,buffer:t,maxBuffer:n})=>{if(!(!r||!t))return e?(0,Lt.default)(r,{encoding:e,maxBuffer:n}):Lt.default.buffer(r,{maxBuffer:n})},In=async({stdout:r,stderr:e,all:t},{encoding:n,buffer:s,maxBuffer:o},i)=>{let d=Ct(r,{encoding:n,buffer:s,maxBuffer:o}),f=Ct(e,{encoding:n,buffer:s,maxBuffer:o}),g=Ct(t,{encoding:n,buffer:s,maxBuffer:o*2});try{return await Promise.all([i,d,f,g])}catch(E){return Promise.all([{error:E,signal:E.signal,timedOut:E.timedOut},Pt(r,d),Pt(e,f),Pt(t,g)])}};var ko=(async()=>{})().constructor.prototype,$o=["then","catch","finally"].map(r=>[r,Reflect.getOwnPropertyDescriptor(ko,r)]),At=(r,e)=>{for(let[t,n]of $o){let s=typeof e=="function"?(...o)=>Reflect.apply(n.value,e(),o):n.value.bind(e);Reflect.defineProperty(r,t,{...n,value:s})}return r},Tn=r=>new Promise((e,t)=>{r.on("exit",(n,s)=>{e({exitCode:n,signal:s})}),r.on("error",n=>{t(n)}),r.stdin&&r.stdin.on("error",n=>{t(n)})});var kn=(r,e=[])=>Array.isArray(e)?[r,...e]:[r],Po=/^[\w.-]+$/,Co=/"/g,Lo=r=>typeof r!="string"||Po.test(r)?r:`"${r.replace(Co,'\\"')}"`,$n=(r,e)=>kn(r,e).join(" "),Pn=(r,e)=>kn(r,e).map(t=>Lo(t)).join(" ");var Ao=1e3*1e3*100,Ro=({env:r,extendEnv:e,preferLocal:t,localDir:n,execPath:s})=>{let o=e?{...Ae.default.env,...r}:r;return t?Wr({env:o,cwd:n,execPath:s}):o},Oo=(r,e,t={})=>{let n=An.default._parse(r,e,t);return r=n.command,e=n.args,t=n.options,t={maxBuffer:Ao,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:t.cwd||Ae.default.cwd(),execPath:Ae.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...t},t.env=Ro(t),t.stdio=en(t),Ae.default.platform==="win32"&&Ln.default.basename(r,".exe")==="cmd"&&e.unshift("/q"),{file:r,args:e,options:t,parsed:n}},Rt=(r,e,t)=>typeof e!="string"&&!Cn.Buffer.isBuffer(e)?t===void 0?void 0:"":r.stripFinalNewline?Et(e):e;function Rn(r,e,t){let n=Oo(r,e,t),s=$n(r,e),o=Pn(r,e);mn(n.options);let i;try{i=Ot.default.spawn(n.file,n.args,n.options)}catch(C){let x=new Ot.default.ChildProcess,R=Promise.reject(It({error:C,stdout:"",stderr:"",all:"",command:s,escapedCommand:o,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return At(x,R)}let d=Tn(i),f=fn(i,n.options,d),g=pn(i,n.options,f),E={isCanceled:!1};i.kill=un.bind(null,i.kill.bind(i)),i.cancel=dn.bind(null,i,E);let y=Hr(async()=>{let[{error:C,exitCode:x,signal:R,timedOut:U},G,b,ve]=await In(i,n.options,g),Ie=Rt(n.options,G),Te=Rt(n.options,b),le=Rt(n.options,ve);if(C||x!==0||R!==null){let ke=It({error:C,exitCode:x,signal:R,stdout:Ie,stderr:Te,all:le,command:s,escapedCommand:o,parsed:n,timedOut:U,isCanceled:E.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:i.killed});if(!n.options.reject)return ke;throw ke}return{command:s,escapedCommand:o,exitCode:0,stdout:Ie,stderr:Te,all:le,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return xn(i,n.options.input),i.all=vn(i,n.options),At(i,y)}var N=require("fs");var ge=require("@raycast/api");var _n="https://bitwarden.com";var I={PASSWORD_OPTIONS:"bw-generate-password-options",PASSWORD_ONE_TIME_WARNING:"bw-generate-password-warning-accepted",SESSION_TOKEN:"sessionToken",REPROMPT_HASH:"sessionRepromptHash",SERVER_URL:"cliServer",LAST_ACTIVITY_TIME:"lastActivityTime",VAULT_LOCK_REASON:"vaultLockReason",VAULT_FAVORITE_ORDER:"vaultFavoriteOrder",VAULT_LAST_STATUS:"lastVaultStatus"};var ye={IV:"iv",VAULT:"vault",CURRENT_FOLDER_ID:"currentFolderId",SEND_TYPE_FILTER:"sendTypeFilter",CLI_VERSION:"cliVersion"},Ia={1:ge.Icon.Globe,3:ge.Icon.CreditCard,4:ge.Icon.Person,2:ge.Icon.Document,5:ge.Icon.Key};var _o=require("@raycast/api");function Nn(r){return Object.entries(r).flatMap(([e,t])=>{switch(typeof t){case"boolean":return t?[`--${e}`]:[];case"string":return[`--${e}`,t];default:return[]}})}var _t=require("@raycast/api");var No={IMMEDIATELY:"0",ONE_MINUTE:"60000",FIVE_MINUTES:"300000",FIFTEEN_MINUTES:"900000",THIRTY_MINUTES:"1800000",ONE_HOUR:"3600000",FOUR_HOURS:"14400000",EIGHT_HOURS:"28800000",ONE_DAY:"86400000",NEVER:"-1",SYSTEM_LOCK:"-2",SYSTEM_SLEEP:"-3"},M=Object.entries(No).reduce((r,[e,t])=>(r[e]=parseInt(t),r),{});var Do={[M.IMMEDIATELY]:"Immediately",[M.ONE_MINUTE]:"1 Minute",[M.FIVE_MINUTES]:"5 Minutes",[M.FIFTEEN_MINUTES]:"15 Minutes",[M.THIRTY_MINUTES]:"30 Minutes",[M.ONE_HOUR]:"1 Hour",[M.FOUR_HOURS]:"4 Hours",[M.EIGHT_HOURS]:"8 Hours",[M.ONE_DAY]:"1 Day"};var Fa={1:"Login",3:"Card",4:"Identity",2:"Secure Note",5:"SSH Key"};function Nt(){let{serverUrl:r}=(0,_t.getPreferenceValues)();return!r||r==="bitwarden.com"||r==="https://bitwarden.com"?void 0:r}var se=class extends Error{constructor(e,t){super(e),this.stack=t}},Re=class extends se{constructor(e,t){super(e,t)}};var we=class extends Re{constructor(e,t){super(e??"Bitwarden CLI not found",t),this.name="InstalledCLINotFoundError",this.stack=t}};var Xe=class extends Re{constructor(e,t){super(e??"Vault is locked",t),this.name="VaultIsLockedError"}},oe=class extends se{constructor(e,t){super(e??"Not logged in",t),this.name="NotLoggedInError"}},be=class extends Re{constructor(e,t){super(e??"Failed do download Bitwarden CLI",t),this.name="EnsureCliBinError"}},Qe=class extends se{constructor(e,t){super(e??"Premium status is required to use this feature",t),this.name="PremiumFeatureError"}},Oe=class extends se{constructor(e,t){super(e??"This Send has a is protected by a password",t),this.name="SendNeedsPasswordError"}},_e=class extends se{constructor(e,t){super(e??"The password you entered is invalid",t),this.name="SendInvalidPasswordError"}};function H(r,e){try{return r()}catch{return e}}var Dt=r=>{if(r){if(typeof r=="string")return r;if(r instanceof Error){let{message:e,name:t}=r;return r.stack?r.stack:`${t}: ${e}`}return String(r)}};var X=require("path"),Q=require("fs/promises");var z=require("fs"),rt=require("fs/promises"),Gn=require("path"),zn=_(Bn());function nt(r){return new Promise((e,t)=>{let n=setInterval(()=>{if(!(0,z.existsSync)(r))return;(0,z.statSync)(r).isFile()&&(clearInterval(n),e())},300);setTimeout(()=>{clearInterval(n),t(new Error(`File ${r} not found.`))},5e3)})}async function Wn(r,e){let t=new zn.default.async({file:r});(0,z.existsSync)(e)||(0,z.mkdirSync)(e,{recursive:!0}),await t.extract(null,e),await t.close()}async function jn(r,e){let t=!1;try{let n=await(0,rt.readdir)(e);for await(let s of n)s.startsWith(r)&&await H(async()=>{await(0,rt.unlink)((0,Gn.join)(e,s)),t=!0})}catch{return!1}return t}function Hn(...r){for(let e of r)H(()=>(0,z.unlinkSync)(e))}var Ee=require("fs"),jt=_(require("http")),st=_(require("https"));var Kn=require("@raycast/api");var Yn=require("@raycast/api"),Uo={logs:new Map,set:(r,e)=>{Ne.logs.set(new Date,{message:r,error:e})},clear:()=>Ne.logs.clear(),toString:()=>{let r="";return Ne.logs.forEach((e,t)=>{r.length>0&&(r+=`

`),r+=`[${t.toISOString()}] ${e.message}`,e.error&&(r+=`: ${Dt(e.error)}`)}),r}},Ne=Object.freeze(Uo),h=(r,e,t)=>{let{captureToRaycast:n=!1}=t??{},s=Array.isArray(r)?r.filter(Boolean).join(" "):r||"Captured exception";Ne.set(s,e),Kn.environment.isDevelopment?console.error(s,e):n&&(0,Yn.captureException)(e)};var Zn=require("fs"),qn=require("crypto");function Wt(r){try{return(0,qn.createHash)("sha256").update((0,Zn.readFileSync)(r)).digest("hex")}catch{return null}}function Ht(r,e,t){let{onProgress:n,sha256:s}=t??{};return new Promise((o,i)=>{let d=new URL(r),f=d.protocol==="https:"?st.default:jt.default,g=new(f===st.default?st.default:jt.default).Agent({keepAlive:!1}),E=0,k=f.get(d.href,{agent:g},y=>{if(y.statusCode&&y.statusCode>=300&&y.statusCode<400){k.destroy(),y.destroy();let b=y.headers.location;if(!b){i(new Error("Redirect response without location header"));return}if(++E>=10){i(new Error("Too many redirects"));return}Ht(b,e,t).then(o).catch(i);return}if(y.statusCode!==200){i(new Error(`Response status ${y.statusCode}: ${y.statusMessage}`));return}let C=parseInt(y.headers["content-length"]||"0",10);if(C===0){i(new Error("Invalid file size"));return}let x=(0,Ee.createWriteStream)(e,{autoClose:!0}),R=0,U=()=>{k.destroy(),y.destroy(),x.close()},G=b=>{U(),i(b)};y.on("data",b=>{R+=b.length;let ve=Math.floor(R/C*100);n?.(ve)}),x.on("finish",async()=>{try{await nt(e),s&&await Vo(e,s),o()}catch(b){i(b)}finally{U()}}),x.on("error",b=>{h(`File stream error while downloading ${r}`,b),(0,Ee.unlink)(e,()=>G(b))}),y.on("error",b=>{h(`Response error while downloading ${r}`,b),(0,Ee.unlink)(e,()=>G(b))}),k.on("error",b=>{h(`Request error while downloading ${r}`,b),(0,Ee.unlink)(e,()=>G(b))}),y.pipe(x)})})}function Vo(r,e){return new Promise((t,n)=>{let s=Wt(r);if(!s)return n(new Error(`Could not generate hash for file ${r}.`));if(s===e)return t();let o=setInterval(()=>{Wt(r)===e&&(clearInterval(o),clearTimeout(i),t())},1e3),i=setTimeout(()=>{clearInterval(o),n(new Error(`Hash did not match, expected ${e.substring(0,7)}, got ${s.substring(0,7)}.`))},5e3)})}function Jn(r,e){return{...r,...e,file:e.file?{...r.file,...e.file}:r.file,text:e.text?{...r.text,...e.text}:r.text}}var Xn=require("@raycast/api"),ie=new Xn.Cache({namespace:"bw-cache"});var B=process.platform==="darwin"?"macos":"windows";var{supportPath:J}=T.environment,Mo="5",ot=(()=>{let r=(0,X.join)(J,`bw-bin-download-error-${Mo}.log`);return{logError:e=>H(()=>(0,N.writeFileSync)(r,e?.message??"Unexpected error")),clearError:()=>H(()=>(0,N.unlinkSync)(r)),hasError:()=>H(()=>(0,N.existsSync)(r),!1)}})(),W={version:"2025.11.0",get sha256(){return B==="windows"?"0484bae6306762881678097406d6bf00a58e291720dbc7d62f044e5f4d8286ed":process.arch==="arm64"?"59eac955be7b15bfc21c81101a194a9fbba32f48a61154b4f4b6e007efab6fd6":"213108a65eeb7294ffcd7303f8fe5308dc2af970735aefeb4d23fc9753a2ac01"},downloadPage:"https://github.com/bitwarden/clients/releases",path:{get downloadedBin(){return(0,X.join)(J,W.binFilenameVersioned)},get installedBin(){return B==="windows"?"C:\\ProgramData\\chocolatey\\bin\\bw.exe":process.arch==="arm64"?"/opt/homebrew/bin/bw":"/usr/local/bin/bw"},get bin(){return ot.hasError()?this.installedBin:this.downloadedBin}},get binFilename(){return B==="windows"?"bw.exe":"bw"},get binFilenameVersioned(){let r=`bw-${this.version}`;return B==="windows"?`${r}.exe`:`${r}`},get downloadUrl(){let r="";return B==="macos"&&(r=process.arch==="arm64"?"-arm64":""),`${this.downloadPage}/download/cli-v${this.version}/bw-${B}${r}-${this.version}.zip`}},De=class{constructor(e){this.actionListeners=new Map;this.preferences=(0,T.getPreferenceValues)();this.wasCliUpdated=!1;this.showToast=async e=>{if(this.toastInstance){let t={message:this.toastInstance.message,title:this.toastInstance.title,primaryAction:this.toastInstance.primaryAction,secondaryAction:this.toastInstance.secondaryAction};return e.style&&(this.toastInstance.style=e.style),this.toastInstance.message=e.message,this.toastInstance.title=e.title,this.toastInstance.primaryAction=e.primaryAction,this.toastInstance.secondaryAction=e.secondaryAction,await this.toastInstance.show(),Object.assign(this.toastInstance,{restore:async()=>{await this.showToast(t)}})}else{let t=await(0,T.showToast)(e);return Object.assign(t,{restore:()=>t.hide()})}};let{cliPath:t,clientId:n,clientSecret:s,serverCertsPath:o}=this.preferences,i=Nt();this.toastInstance=e,this.cliPath=t||W.path.bin,this.env={BITWARDENCLI_APPDATA_DIR:J,BW_CLIENTSECRET:s.trim(),BW_CLIENTID:n.trim(),PATH:(0,X.dirname)(process.execPath),...i&&o?{NODE_EXTRA_CA_CERTS:o}:{}},this.initPromise=(async()=>{await this.ensureCliBinary(),this.retrieveAndCacheCliVersion(),await this.checkServerUrl(i)})()}async ensureCliBinary(){if(this.checkCliBinIsReady(this.cliPath))return;if(this.cliPath===this.preferences.cliPath||this.cliPath===W.path.installedBin)throw new we(`Bitwarden CLI not found at ${this.cliPath}`);ot.hasError()&&ot.clearError();let e=await jn("bw-",J),t=await this.showToast({title:`${e?"Updating":"Initializing"} Bitwarden CLI`,style:T.Toast.Style.Animated,primaryAction:{title:"Open Download Page",onAction:()=>(0,T.open)(W.downloadPage)}}),s=(0,X.join)(J,"bw.zip");try{try{t.message="Downloading...",await Ht(W.downloadUrl,s,{onProgress:o=>t.message=`Downloading ${o}%`,sha256:W.sha256})}catch(o){throw t.title="Failed to download Bitwarden CLI",o}try{t.message="Extracting...",await Wn(s,J);let o=(0,X.join)(J,W.binFilename);await(0,Q.rename)(o,this.cliPath).catch(()=>null),await nt(this.cliPath),await(0,Q.chmod)(this.cliPath,"755"),await(0,Q.rm)(s,{force:!0}),ie.set(ye.CLI_VERSION,W.version),this.wasCliUpdated=!0;let i=(0,X.join)(J,"data.json");await H(()=>(0,Q.unlink)(i))}catch(o){throw t.title="Failed to extract Bitwarden CLI",o}await t.hide()}catch(o){throw t.message=o instanceof be?o.message:"Please try again",t.style=T.Toast.Style.Failure,Hn(s,this.cliPath),T.environment.isDevelopment||ot.logError(o),o instanceof Error?new be(o.message,o.stack):o}finally{await t.restore()}}async retrieveAndCacheCliVersion(){try{let{error:e,result:t}=await this.getVersion();e||ie.set(ye.CLI_VERSION,t)}catch(e){h("Failed to retrieve and cache cli version",e,{captureToRaycast:!0})}}checkCliBinIsReady(e){try{return(0,N.existsSync)(this.cliPath)?((0,N.accessSync)(e,N.constants.X_OK),!0):!1}catch{return(0,N.chmodSync)(e,"755"),!0}}setSessionToken(e){this.env={...this.env,BW_SESSION:e}}clearSessionToken(){delete this.env.BW_SESSION}withSession(e){return this.tempSessionToken=e,this}async initialize(){return await this.initPromise,this}async checkServerUrl(e){let t=await T.LocalStorage.getItem(I.SERVER_URL);if(!e||t===e)return;let n=await this.showToast({style:T.Toast.Style.Animated,title:"Switching server...",message:"Bitwarden server preference changed"});try{try{await this.logout()}catch{}await this.exec(["config","server",e||_n],{resetVaultTimeout:!1}),await T.LocalStorage.setItem(I.SERVER_URL,e),n.style=T.Toast.Style.Success,n.title="Success",n.message="Bitwarden server changed"}catch(s){n.style=T.Toast.Style.Failure,n.title="Failed to switch server",s instanceof Error?n.message=s.message:n.message="Unknown error occurred"}finally{await n.restore()}}async exec(e,t){let{abortController:n,input:s="",resetVaultTimeout:o,env:i}=t??{},d=this.env;this.tempSessionToken&&(d={...d,BW_SESSION:this.tempSessionToken},this.tempSessionToken=void 0),i&&(d={...d,...i});let f=await Rn(this.cliPath,e,{input:s,env:d,signal:n?.signal});if(this.isPromptWaitingForMasterPassword(f))throw await this.lock(),new Xe;return o&&await T.LocalStorage.setItem(I.LAST_ACTIVITY_TIME,new Date().toISOString()),f}async getVersion(){try{let{stdout:e}=await this.exec(["--version"],{resetVaultTimeout:!1});return{result:e}}catch(e){h("Failed to get cli version",e);let{error:t}=await this.handleCommonErrors(e);if(!t)throw e;return{error:t}}}async login(){try{return await this.exec(["login","--apikey"],{resetVaultTimeout:!0}),await this.saveLastVaultStatus("login","unlocked"),await this.callActionListeners("login"),{result:void 0}}catch(e){h("Failed to login",e);let{error:t}=await this.handleCommonErrors(e);if(!t)throw e;return{error:t}}}async logout(e){let{reason:t,immediate:n=!1}=e??{};try{return n&&await this.handlePostLogout(t),await this.exec(["logout"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("logout","unauthenticated"),n||await this.handlePostLogout(t),{result:void 0}}catch(s){h("Failed to logout",s);let{error:o}=await this.handleCommonErrors(s);if(!o)throw s;return{error:o}}}async lock(e){let{reason:t,checkVaultStatus:n=!1,immediate:s=!1}=e??{};try{if(s&&await this.callActionListeners("lock",t),n){let{error:o,result:i}=await this.status();if(o)throw o;if(i.status==="unauthenticated")return{error:new oe("Not logged in")}}return await this.exec(["lock"],{resetVaultTimeout:!1}),this.clearSessionToken(),await this.saveLastVaultStatus("lock","locked"),s||await this.callActionListeners("lock",t),{result:void 0}}catch(o){h("Failed to lock vault",o);let{error:i}=await this.handleCommonErrors(o);if(!i)throw o;return{error:i}}}async unlock(e){try{this.clearSessionToken();let n=(await this.exec(["unlock","--passwordenv","BW_PASSWORD","--raw"],{resetVaultTimeout:!0,env:{BW_PASSWORD:e}})).stdout;if(!n.trim())throw new Error("Invalid session token");return this.setSessionToken(n),await this.saveLastVaultStatus("unlock","unlocked"),await this.callActionListeners("unlock",e,n),{result:n}}catch(t){h("Failed to unlock vault",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async sync(){try{return await this.exec(["sync"],{resetVaultTimeout:!0}),{result:void 0}}catch(e){h("Failed to sync vault",e);let{error:t}=await this.handleCommonErrors(e);if(!t)throw e;return{error:t}}}async getItem(e){try{let{stdout:t}=await this.exec(["get","item",e],{resetVaultTimeout:!0});return{result:JSON.parse(t)}}catch(t){h("Failed to get item",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async listItems(){try{let{stdout:e}=await this.exec(["list","items"],{resetVaultTimeout:!0});return{result:JSON.parse(e).filter(n=>!!n.name)}}catch(e){h("Failed to list items",e);let{error:t}=await this.handleCommonErrors(e);if(!t)throw e;return{error:t}}}async createLoginItem(e){try{let{error:t,result:n}=await this.getTemplate("item");if(t)throw t;let{error:s,result:o}=await this.getTemplate("item.login");if(s)throw s;n.name=e.name,n.type=1,n.folderId=e.folderId||null,n.login=o,n.notes=null,o.username=e.username||null,o.password=e.password,o.totp=null,o.fido2Credentials=void 0,e.uri&&(o.uris=[{match:null,uri:e.uri}]);let{result:i,error:d}=await this.encode(JSON.stringify(n));if(d)throw d;let{stdout:f}=await this.exec(["create","item",i],{resetVaultTimeout:!0});return{result:JSON.parse(f)}}catch(t){h("Failed to create login item",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async listFolders(){try{let{stdout:e}=await this.exec(["list","folders"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){h("Failed to list folder",e);let{error:t}=await this.handleCommonErrors(e);if(!t)throw e;return{error:t}}}async createFolder(e){try{let{error:t,result:n}=await this.getTemplate("folder");if(t)throw t;n.name=e;let{result:s,error:o}=await this.encode(JSON.stringify(n));if(o)throw o;return await this.exec(["create","folder",s],{resetVaultTimeout:!0}),{result:void 0}}catch(t){h("Failed to create folder",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async getTotp(e){try{let{stdout:t}=await this.exec(["get","totp",e],{resetVaultTimeout:!0});return{result:t}}catch(t){h("Failed to get TOTP",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async status(){try{let{stdout:e}=await this.exec(["status"],{resetVaultTimeout:!1});return{result:JSON.parse(e)}}catch(e){h("Failed to get status",e);let{error:t}=await this.handleCommonErrors(e);if(!t)throw e;return{error:t}}}async checkLockStatus(){try{return await this.exec(["unlock","--check"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("checkLockStatus","unlocked"),"unlocked"}catch(e){return h("Failed to check lock status",e),e.stderr==="Vault is locked."?(await this.saveLastVaultStatus("checkLockStatus","locked"),"locked"):(await this.saveLastVaultStatus("checkLockStatus","unauthenticated"),"unauthenticated")}}async getTemplate(e){try{let{stdout:t}=await this.exec(["get","template",e],{resetVaultTimeout:!0});return{result:JSON.parse(t)}}catch(t){h("Failed to get template",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async encode(e){try{let{stdout:t}=await this.exec(["encode"],{input:e,resetVaultTimeout:!1});return{result:t}}catch(t){h("Failed to encode",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async generatePassword(e,t){let n=e?Nn(e):[],{stdout:s}=await this.exec(["generate",...n],{abortController:t,resetVaultTimeout:!1});return s}async listSends(){try{let{stdout:e}=await this.exec(["send","list"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){h("Failed to list sends",e);let{error:t}=await this.handleCommonErrors(e);if(!t)throw e;return{error:t}}}async createSend(e){try{let{error:t,result:n}=await this.getTemplate(e.type===0?"send.text":"send.file");if(t)throw t;let s=Jn(n,e),{result:o,error:i}=await this.encode(JSON.stringify(s));if(i)throw i;let{stdout:d}=await this.exec(["send","create",o],{resetVaultTimeout:!0});return{result:JSON.parse(d)}}catch(t){h("Failed to create send",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async editSend(e){try{let{result:t,error:n}=await this.encode(JSON.stringify(e));if(n)throw n;let{stdout:s}=await this.exec(["send","edit",t],{resetVaultTimeout:!0});return{result:JSON.parse(s)}}catch(t){h("Failed to delete send",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async deleteSend(e){try{return await this.exec(["send","delete",e],{resetVaultTimeout:!0}),{result:void 0}}catch(t){h("Failed to delete send",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async removeSendPassword(e){try{return await this.exec(["send","remove-password",e],{resetVaultTimeout:!0}),{result:void 0}}catch(t){h("Failed to remove send password",t);let{error:n}=await this.handleCommonErrors(t);if(!n)throw t;return{error:n}}}async receiveSendInfo(e,t){try{let{stdout:n,stderr:s}=await this.exec(["send","receive",e,"--obj"],{resetVaultTimeout:!0,input:t?.password});return!n&&/Invalid password/i.test(s)?{error:new _e}:!n&&/Send password/i.test(s)?{error:new Oe}:{result:JSON.parse(n)}}catch(n){let s=n.stderr;if(/Invalid password/gi.test(s))return{error:new _e};if(/Send password/gi.test(s))return{error:new Oe};h("Failed to receive send obj",n);let{error:o}=await this.handleCommonErrors(n);if(!o)throw n;return{error:o}}}async receiveSend(e,t){try{let{savePath:n,password:s}=t??{},o=["send","receive",e];n&&o.push("--output",n);let{stdout:i}=await this.exec(o,{resetVaultTimeout:!0,input:s});return{result:i}}catch(n){h("Failed to receive send",n);let{error:s}=await this.handleCommonErrors(n);if(!s)throw n;return{error:s}}}async saveLastVaultStatus(e,t){await T.LocalStorage.setItem(I.VAULT_LAST_STATUS,t)}async getLastSavedVaultStatus(){let e=await T.LocalStorage.getItem(I.VAULT_LAST_STATUS);return e||(await this.status()).result?.status}isPromptWaitingForMasterPassword(e){return!!(e.stderr&&e.stderr.includes("Master password"))}async handlePostLogout(e){this.clearSessionToken(),await this.callActionListeners("logout",e)}async handleCommonErrors(e){let t=e.stderr;return t?/not logged in/i.test(t)?(await this.handlePostLogout(),{error:new oe("Not logged in")}):/Premium status/i.test(t)?{error:new Qe}:{}:{}}setActionListener(e,t){let n=this.actionListeners.get(e);return n&&n.size>0?n.add(t):this.actionListeners.set(e,new Set([t])),this}removeActionListener(e,t){let n=this.actionListeners.get(e);return n&&n.size>0&&n.delete(t),this}async callActionListeners(e,...t){let n=this.actionListeners.get(e);if(n&&n.size>0)for(let s of n)try{await s?.(...t)}catch(o){if(h(`Error calling bitwarden action listener for ${e}`,o),e==="unlock")throw o}}};var ms=require("@raycast/api"),Be=require("react");var te=require("@raycast/api"),ui=require("react");var zo=require("@raycast/api");var Kt=require("react"),Pc=(0,Kt.createContext)(null);var Zt=require("@raycast/api");var Yt=require("@raycast/api"),Qn=require("react/jsx-runtime");var Bo=require("react/jsx-runtime");var Wo=require("react/jsx-runtime");var ee=require("@raycast/api");var es=require("child_process"),ts=require("util");var jo=require("react/jsx-runtime"),zc=(0,ts.promisify)(es.exec),{supportPath:Wc}=ee.environment;var Ho=require("@raycast/api"),Ko=require("react/jsx-runtime");var ae=require("@raycast/api");var Yo=require("react/jsx-runtime");var Jo=require("@raycast/api");var Zo=require("react");var rs=require("react");var os=require("react/jsx-runtime");var xe=require("@raycast/api");var at=require("react");var Xo=require("@raycast/api"),Qo=require("react/jsx-runtime");var Fe=require("@raycast/api");var is=require("react/jsx-runtime");var ei=require("react/jsx-runtime"),El=(0,at.createContext)(null);var lt=require("@raycast/api"),Ve=require("react");var Ue=require("react");var ri=require("react/jsx-runtime"),kl=(0,Ue.createContext)(null);var oi=require("@raycast/api");var ni=require("@raycast/api");var si=require("react");var ce=_(require("react")),O=require("@raycast/api");var as=require("react/jsx-runtime");var ii=require("react/jsx-runtime"),au=(0,Ve.createContext)(null);var{syncOnLaunch:cu}=(0,lt.getPreferenceValues)();var cs=require("react/jsx-runtime");var Me=require("@raycast/api"),ls=require("react");var li=require("@raycast/api");var qt=require("react/jsx-runtime");var di=require("@raycast/api"),fi=require("react/jsx-runtime");var mi=require("react");var F=require("@raycast/api");var us=require("child_process"),ds=require("util");var ed=(0,ds.promisify)(us.exec),fs={getSavedSession:()=>Promise.all([F.LocalStorage.getItem(I.SESSION_TOKEN),F.LocalStorage.getItem(I.REPROMPT_HASH),F.LocalStorage.getItem(I.LAST_ACTIVITY_TIME),F.LocalStorage.getItem(I.VAULT_LAST_STATUS)]),clearSession:async()=>{await Promise.all([F.LocalStorage.removeItem(I.SESSION_TOKEN),F.LocalStorage.removeItem(I.REPROMPT_HASH)])},saveSession:async(r,e)=>{await Promise.all([F.LocalStorage.setItem(I.SESSION_TOKEN,r),F.LocalStorage.setItem(I.REPROMPT_HASH,e)])},logoutClearSession:async()=>{await Promise.all([F.LocalStorage.removeItem(I.SESSION_TOKEN),F.LocalStorage.removeItem(I.REPROMPT_HASH),F.LocalStorage.removeItem(I.LAST_ACTIVITY_TIME)])}};var pi=require("react/jsx-runtime"),xd=(0,Be.createContext)(null);async function ps(){await fs.logoutClearSession(),ie.clear()}async function hi(){try{if(!await(0,A.confirmAlert)({title:"Logout From Bitwarden Vault",message:"Are you sure you want to logout from your current vault account?",icon:A.Icon.Logout,primaryAction:{title:"Confirm",style:A.Alert.ActionStyle.Destructive}}))return;let e=await(0,A.showToast)(A.Toast.Style.Animated,"Logging out..."),t=await new De(e).initialize(),{error:n}=await t.logout();if(n instanceof oe){e.style=A.Toast.Style.Failure,e.title="No session found",e.message="You are not logged in";return}}catch{await(0,A.showToast)(A.Toast.Style.Failure,"Failed to logout from vault")}try{await ps(),await(0,A.showToast)(A.Toast.Style.Success,"Successfully logged out")}catch{await(0,A.showToast)(A.Toast.Style.Failure,"Failed to logout from vault")}}var gi=hi;
/*! Bundled license information:

node-stream-zip/node_stream_zip.js:
  (**
   * @license node-stream-zip | (c) 2020 Antelle | https://github.com/antelle/node-stream-zip/blob/master/LICENSE
   * Portions copyright https://github.com/cthackers/adm-zip | https://raw.githubusercontent.com/cthackers/adm-zip/master/LICENSE
   *)
*/
