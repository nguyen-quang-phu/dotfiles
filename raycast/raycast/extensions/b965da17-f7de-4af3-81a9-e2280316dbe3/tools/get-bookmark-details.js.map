{
  "version": 3,
  "sources": ["../../src/tools/get-bookmark-details.ts"],
  "sourcesContent": ["import { getPreferenceValues } from \"@raycast/api\";\n\nimport { BookmarkDetailResponse, CollectionResponse } from \"../types\";\n\ntype Input = {\n  /**\n   * The bookmark id returned by the search-bookmarks tool or Raindrop UI.\n   */\n  bookmarkId: string;\n};\n\nexport default async function getBookmarkDetails(input: Input) {\n  if (!input.bookmarkId?.trim()) {\n    throw new Error(\"bookmarkId is required\");\n  }\n\n  const preferences = getPreferenceValues<Preferences>();\n  const response = await fetch(`https://api.raindrop.io/rest/v1/raindrop/${input.bookmarkId}`, {\n    headers: {\n      Authorization: `Bearer ${preferences.token}`,\n    },\n  });\n\n  if (!response.ok) {\n    throw new Error(`Failed to load bookmark: ${response.statusText}`);\n  }\n\n  const data = (await response.json()) as BookmarkDetailResponse;\n  const bookmark = data.item;\n  const collectionId = bookmark.collection?.$id ?? -1;\n  const collectionTitle =\n    bookmark.collection?.title ??\n    (collectionId === -1 ? \"Unsorted\" : await fetchCollectionTitle(collectionId, preferences.token)) ??\n    \"Unknown\";\n\n  return {\n    id: bookmark._id,\n    title: bookmark.title,\n    url: bookmark.link,\n    note: bookmark.note ?? \"\",\n    excerpt: bookmark.excerpt ?? \"\",\n    html: bookmark.html ?? \"\",\n    tags: bookmark.tags ?? [],\n    collectionId,\n    collectionTitle,\n    highlights: bookmark.highlights?.map((highlight) => ({ text: highlight.text, note: highlight.note })) ?? [],\n    created: bookmark.created,\n    lastUpdate: bookmark.lastUpdate,\n  };\n}\n\nasync function fetchCollectionTitle(collectionId: number, token: string) {\n  if (collectionId < 0) {\n    return undefined;\n  }\n\n  try {\n    const response = await fetch(`https://api.raindrop.io/rest/v1/collection/${collectionId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      return undefined;\n    }\n\n    const data = (await response.json()) as CollectionResponse;\n    return data.item?.title;\n  } catch {\n    return undefined;\n  }\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAoC,wBAWpC,eAAOF,EAA0CG,EAAc,CAC7D,GAAI,CAACA,EAAM,YAAY,KAAK,EAC1B,MAAM,IAAI,MAAM,wBAAwB,EAG1C,IAAMC,KAAc,uBAAiC,EAC/CC,EAAW,MAAM,MAAM,4CAA4CF,EAAM,UAAU,GAAI,CAC3F,QAAS,CACP,cAAe,UAAUC,EAAY,KAAK,EAC5C,CACF,CAAC,EAED,GAAI,CAACC,EAAS,GACZ,MAAM,IAAI,MAAM,4BAA4BA,EAAS,UAAU,EAAE,EAInE,IAAMC,GADQ,MAAMD,EAAS,KAAK,GACZ,KAChBE,EAAeD,EAAS,YAAY,KAAO,GAC3CE,EACJF,EAAS,YAAY,QACpBC,IAAiB,GAAK,WAAa,MAAME,EAAqBF,EAAcH,EAAY,KAAK,IAC9F,UAEF,MAAO,CACL,GAAIE,EAAS,IACb,MAAOA,EAAS,MAChB,IAAKA,EAAS,KACd,KAAMA,EAAS,MAAQ,GACvB,QAASA,EAAS,SAAW,GAC7B,KAAMA,EAAS,MAAQ,GACvB,KAAMA,EAAS,MAAQ,CAAC,EACxB,aAAAC,EACA,gBAAAC,EACA,WAAYF,EAAS,YAAY,IAAKI,IAAe,CAAE,KAAMA,EAAU,KAAM,KAAMA,EAAU,IAAK,EAAE,GAAK,CAAC,EAC1G,QAASJ,EAAS,QAClB,WAAYA,EAAS,UACvB,CACF,CAEA,eAAeG,EAAqBF,EAAsBI,EAAe,CACvE,GAAI,EAAAJ,EAAe,GAInB,GAAI,CACF,IAAMF,EAAW,MAAM,MAAM,8CAA8CE,CAAY,GAAI,CACzF,QAAS,CACP,cAAe,UAAUI,CAAK,EAChC,CACF,CAAC,EAED,OAAKN,EAAS,IAIA,MAAMA,EAAS,KAAK,GACtB,MAAM,MAJhB,MAKJ,MAAQ,CACN,MACF,CACF",
  "names": ["get_bookmark_details_exports", "__export", "getBookmarkDetails", "__toCommonJS", "import_api", "input", "preferences", "response", "bookmark", "collectionId", "collectionTitle", "fetchCollectionTitle", "highlight", "token"]
}
