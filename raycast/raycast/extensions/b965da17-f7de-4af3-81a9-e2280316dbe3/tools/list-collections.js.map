{
  "version": 3,
  "sources": ["../../src/tools/list-collections.ts"],
  "sourcesContent": ["import { getPreferenceValues } from \"@raycast/api\";\n\nimport { Collection, CollectionsResponse } from \"../types\";\n\ntype Input = {\n  /**\n   * Optional filter applied to the collection title or path.\n   */\n  filter?: string;\n};\n\ntype CollectionSummary = {\n  id: number;\n  title: string;\n  parentId: number | null;\n  path: string;\n};\n\nexport default async function listCollections(input: Input = {}) {\n  const preferences = getPreferenceValues<Preferences>();\n  const response = await fetch(\"https://api.raindrop.io/rest/v1/collections/all\", {\n    headers: {\n      Authorization: `Bearer ${preferences.token}`,\n    },\n  });\n\n  if (!response.ok) {\n    throw new Error(`Failed to load collections: ${response.statusText}`);\n  }\n\n  const data = (await response.json()) as CollectionsResponse;\n  const flattened = flattenCollections(data.items);\n  const filter = input.filter?.trim().toLowerCase();\n\n  if (filter) {\n    return flattened.filter(\n      (collection) => collection.title.toLowerCase().includes(filter) || collection.path.toLowerCase().includes(filter),\n    );\n  }\n\n  return flattened;\n}\n\nfunction flattenCollections(collections: Collection[] = [], parentPath?: string): CollectionSummary[] {\n  return collections.flatMap((collection) => {\n    const path = parentPath ? `${parentPath} / ${collection.title}` : collection.title;\n    const current: CollectionSummary = {\n      id: collection._id,\n      title: collection.title,\n      parentId: collection.parent?.$id ?? null,\n      path,\n    };\n\n    if (!collection.children?.length) {\n      return [current];\n    }\n\n    return [current, ...flattenCollections(collection.children, path)];\n  });\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAoC,wBAkBpC,eAAOF,EAAuCG,EAAe,CAAC,EAAG,CAC/D,IAAMC,KAAc,uBAAiC,EAC/CC,EAAW,MAAM,MAAM,kDAAmD,CAC9E,QAAS,CACP,cAAe,UAAUD,EAAY,KAAK,EAC5C,CACF,CAAC,EAED,GAAI,CAACC,EAAS,GACZ,MAAM,IAAI,MAAM,+BAA+BA,EAAS,UAAU,EAAE,EAGtE,IAAMC,EAAQ,MAAMD,EAAS,KAAK,EAC5BE,EAAYC,EAAmBF,EAAK,KAAK,EACzCG,EAASN,EAAM,QAAQ,KAAK,EAAE,YAAY,EAEhD,OAAIM,EACKF,EAAU,OACdG,GAAeA,EAAW,MAAM,YAAY,EAAE,SAASD,CAAM,GAAKC,EAAW,KAAK,YAAY,EAAE,SAASD,CAAM,CAClH,EAGKF,CACT,CAEA,SAASC,EAAmBG,EAA4B,CAAC,EAAGC,EAA0C,CACpG,OAAOD,EAAY,QAASD,GAAe,CACzC,IAAMG,EAAOD,EAAa,GAAGA,CAAU,MAAMF,EAAW,KAAK,GAAKA,EAAW,MACvEI,EAA6B,CACjC,GAAIJ,EAAW,IACf,MAAOA,EAAW,MAClB,SAAUA,EAAW,QAAQ,KAAO,KACpC,KAAAG,CACF,EAEA,OAAKH,EAAW,UAAU,OAInB,CAACI,EAAS,GAAGN,EAAmBE,EAAW,SAAUG,CAAI,CAAC,EAHxD,CAACC,CAAO,CAInB,CAAC,CACH",
  "names": ["list_collections_exports", "__export", "listCollections", "__toCommonJS", "import_api", "input", "preferences", "response", "data", "flattened", "flattenCollections", "filter", "collection", "collections", "parentPath", "path", "current"]
}
