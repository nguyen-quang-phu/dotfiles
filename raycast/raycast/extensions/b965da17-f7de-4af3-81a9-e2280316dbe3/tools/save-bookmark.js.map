{
  "version": 3,
  "sources": ["../../src/tools/save-bookmark.ts"],
  "sourcesContent": ["import { getPreferenceValues, Tool } from \"@raycast/api\";\n\nimport { CreateBookmarksResponse } from \"../types\";\n\ntype Input = {\n  /**\n   * The URL to save.\n   */\n  url: string;\n  /**\n   * Optional title override. Defaults to the URL.\n   */\n  title?: string;\n  /**\n   * Optional note that will be stored alongside the bookmark.\n   */\n  note?: string;\n  /**\n   * Raindrop collection id (string). Defaults to Unsorted (-1).\n   */\n  collectionId?: string;\n  /**\n   * Tags to assign to the bookmark.\n   */\n  tags?: string[];\n};\n\ntype SaveBookmarkResult = {\n  id: number | undefined;\n  title: string;\n  url: string;\n  collectionId: number;\n  tags: string[];\n};\n\nexport default async function saveBookmark(input: Input): Promise<SaveBookmarkResult> {\n  if (!input.url?.trim()) {\n    throw new Error(\"A URL is required to save a bookmark.\");\n  }\n\n  const preferences = getPreferenceValues<Preferences>();\n  const collectionId = parseCollectionId(input.collectionId);\n\n  const response = await fetch(\"https://api.raindrop.io/rest/v1/raindrops\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${preferences.token}`,\n    },\n    body: JSON.stringify({\n      items: [\n        {\n          link: input.url.trim(),\n          title: input.title?.trim(),\n          note: input.note?.trim(),\n          collectionId,\n          tags: input.tags?.filter(Boolean) ?? [],\n          pleaseParse: {},\n        },\n      ],\n    }),\n  });\n\n  if (!response.ok) {\n    throw new Error(`Failed to save bookmark: ${response.statusText}`);\n  }\n\n  const data = (await response.json()) as CreateBookmarksResponse;\n  const created = data.items?.[0];\n\n  return {\n    id: created?._id,\n    title: created?.title ?? input.title ?? input.url,\n    url: created?.link ?? input.url,\n    collectionId: created?.collection?.$id ?? collectionId,\n    tags: created?.tags ?? input.tags ?? [],\n  };\n}\n\nexport const confirmation: Tool.Confirmation<Input> = async (input) => {\n  const info = [{ name: \"URL\", value: input.url }];\n\n  if (input.title) {\n    info.push({ name: \"Title\", value: input.title });\n  }\n\n  if (input.collectionId !== undefined) {\n    info.push({ name: \"Collection\", value: String(input.collectionId) });\n  }\n\n  if (input.tags?.length) {\n    info.push({ name: \"Tags\", value: input.tags.join(\", \") });\n  }\n\n  if (input.note) {\n    info.push({ name: \"Note\", value: input.note });\n  }\n\n  return { info };\n};\n\nfunction parseCollectionId(value?: string) {\n  if (!value) {\n    return -1;\n  }\n\n  const numeric = Number.parseInt(value, 10);\n  if (!Number.isNaN(numeric)) {\n    return numeric;\n  }\n\n  return -1;\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,kBAAAE,EAAA,YAAAC,IAAA,eAAAC,EAAAJ,GAAA,IAAAK,EAA0C,wBAmC1C,eAAOF,EAAoCG,EAA2C,CACpF,GAAI,CAACA,EAAM,KAAK,KAAK,EACnB,MAAM,IAAI,MAAM,uCAAuC,EAGzD,IAAMC,KAAc,uBAAiC,EAC/CC,EAAeC,EAAkBH,EAAM,YAAY,EAEnDI,EAAW,MAAM,MAAM,4CAA6C,CACxE,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,cAAe,UAAUH,EAAY,KAAK,EAC5C,EACA,KAAM,KAAK,UAAU,CACnB,MAAO,CACL,CACE,KAAMD,EAAM,IAAI,KAAK,EACrB,MAAOA,EAAM,OAAO,KAAK,EACzB,KAAMA,EAAM,MAAM,KAAK,EACvB,aAAAE,EACA,KAAMF,EAAM,MAAM,OAAO,OAAO,GAAK,CAAC,EACtC,YAAa,CAAC,CAChB,CACF,CACF,CAAC,CACH,CAAC,EAED,GAAI,CAACI,EAAS,GACZ,MAAM,IAAI,MAAM,4BAA4BA,EAAS,UAAU,EAAE,EAInE,IAAMC,GADQ,MAAMD,EAAS,KAAK,GACb,QAAQ,CAAC,EAE9B,MAAO,CACL,GAAIC,GAAS,IACb,MAAOA,GAAS,OAASL,EAAM,OAASA,EAAM,IAC9C,IAAKK,GAAS,MAAQL,EAAM,IAC5B,aAAcK,GAAS,YAAY,KAAOH,EAC1C,KAAMG,GAAS,MAAQL,EAAM,MAAQ,CAAC,CACxC,CACF,CAEO,IAAMJ,EAAyC,MAAOI,GAAU,CACrE,IAAMM,EAAO,CAAC,CAAE,KAAM,MAAO,MAAON,EAAM,GAAI,CAAC,EAE/C,OAAIA,EAAM,OACRM,EAAK,KAAK,CAAE,KAAM,QAAS,MAAON,EAAM,KAAM,CAAC,EAG7CA,EAAM,eAAiB,QACzBM,EAAK,KAAK,CAAE,KAAM,aAAc,MAAO,OAAON,EAAM,YAAY,CAAE,CAAC,EAGjEA,EAAM,MAAM,QACdM,EAAK,KAAK,CAAE,KAAM,OAAQ,MAAON,EAAM,KAAK,KAAK,IAAI,CAAE,CAAC,EAGtDA,EAAM,MACRM,EAAK,KAAK,CAAE,KAAM,OAAQ,MAAON,EAAM,IAAK,CAAC,EAGxC,CAAE,KAAAM,CAAK,CAChB,EAEA,SAASH,EAAkBI,EAAgB,CACzC,GAAI,CAACA,EACH,MAAO,GAGT,IAAMC,EAAU,OAAO,SAASD,EAAO,EAAE,EACzC,OAAK,OAAO,MAAMC,CAAO,EAIlB,GAHEA,CAIX",
  "names": ["save_bookmark_exports", "__export", "confirmation", "saveBookmark", "__toCommonJS", "import_api", "input", "preferences", "collectionId", "parseCollectionId", "response", "created", "info", "value", "numeric"]
}
